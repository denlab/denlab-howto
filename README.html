<h1 id="unixes">Unixes</h1>
<h2 id="linux">Linux</h2>
<h3 id="package-managers">Package managers</h3>
<table style="width:95%;">
<colgroup>
<col style="width: 0%" />
<col style="width: 17%" />
<col style="width: 0%" />
<col style="width: 17%" />
<col style="width: 0%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 17%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="header">
<th>distrib</th>
<th>pkg manager</th>
<th>no sudo</th>
<th>inst</th>
<th>inst ver</th>
<th>list all installed</th>
<th>list all installed w ver</th>
<th>list avail vers of pkg</th>
<th>rm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>alpine</code></td>
<td><code>apk</code></td>
<td></td>
<td><code>add</code></td>
<td><code>add &lt;pkg&gt;=&lt;ver&gt;</code></td>
<td><code>info</code></td>
<td><code>apk info &lt;pipe&gt; xargs apk info</code></td>
<td><code>apk info &lt;pkg&gt;</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>python</code></td>
<td><code>pip</code></td>
<td><code>--user</code></td>
<td><code>install</code></td>
<td></td>
<td><code>ls</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="odd">
<td><code>node</code></td>
<td><code>npm</code></td>
<td><code>--global</code></td>
<td><code>install</code></td>
<td></td>
<td><code>ls</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="even">
<td><code>perl</code></td>
<td><code>cpan</code></td>
<td><code>?</code></td>
<td><code>install</code></td>
<td></td>
<td><code>cpan -a</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="odd">
<td><code>debian</code></td>
<td><code>aptitude</code></td>
<td><code>?</code></td>
<td><code>install</code></td>
<td></td>
<td><code>dpkg -l</code></td>
<td></td>
<td></td>
<td><code>purge</code></td>
</tr>
<tr class="even">
<td><code>debian</code></td>
<td><code>apt</code></td>
<td><code>?</code></td>
<td><code>install</code></td>
<td></td>
<td><code>dpkg -l</code></td>
<td></td>
<td><code>apt-cache policy $pkg</code></td>
<td><code>purge</code></td>
</tr>
<tr class="odd">
<td><code>rhel</code></td>
<td><code>yum</code></td>
<td><code>?</code></td>
<td><code>install</code></td>
<td></td>
<td><code>rpm -qa</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="even">
<td><code>groovy</code></td>
<td><code>sdk</code></td>
<td><code>?</code></td>
<td><code>install</code></td>
<td></td>
<td><code>?</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="odd">
<td><code>ruby</code></td>
<td><code>gem</code></td>
<td><code>--user-install</code></td>
<td><code>install</code></td>
<td></td>
<td><code>?</code></td>
<td></td>
<td></td>
<td><code>?</code></td>
</tr>
<tr class="even">
<td><code>nix=</code></td>
<td></td>
<td></td>
<td><code>nix-env -i -v "${pkg}"</code></td>
<td></td>
<td><code>nix-env -qa --description</code></td>
<td></td>
<td></td>
<td><code>nix-env --uninstall "$pkg"</code></td>
</tr>
</tbody>
</table>
<ol class="incremental">
<li><p>find which package manager is used on this machine?</p>
<div class="sourceCode" id="cb1" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#!/usr/bin/env bash</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">while</span> <span class="bu">read</span> <span class="va">p</span>; <span class="kw">do</span> <span class="va">$p</span> <span class="ex">--version</span> <span class="op">&amp;&gt;</span> /dev/null <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> <span class="va">$p</span> <span class="kw">;</span> <span class="kw">done</span> <span class="op">&lt;&lt;&lt;</span> <span class="st">$&#39;yum</span><span class="dt">\n</span><span class="st">apt</span><span class="dt">\n</span><span class="st">apk&#39;</span></a></code></pre></div></li>
<li><p>apk</p>
<ol class="incremental">
<li><p>equivalent of apt-file search?</p></li>
</ol></li>
</ol>
<h3 id="packages">Packages</h3>
<p>Top level sections as per the 'Section' attribute of <code>aptitude show &lt;pkg&gt;</code>.</p>
<ol class="incremental">
<li><p>Admin</p>
<ol class="incremental">
<li><p>Tmux</p>
<ol class="incremental">
<li><p>how do i detach other client when reattach to session?</p>
<div class="sourceCode" id="cb2" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="ex">tmux</span> -2 a -dt 0</a></code></pre></div></li>
<li><p>create a new session specifying the name?</p>
<div class="sourceCode" id="cb3" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># create a session named &quot;net&#39;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="ex">tmux</span> -2 new-session -s net</a></code></pre></div></li>
<li><p>reload .tmux.conf?</p>
<div class="sourceCode" id="cb4" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">tmux</span> source-file ~/.tmux.conf</a></code></pre></div></li>
<li><p>bindings to install plugins?</p>
<div class="sourceCode" id="cb5" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="op">&lt;</span><span class="ex">prefix</span><span class="op">&gt;</span> + I</a></code></pre></div>
<p>Note: After an tmux you may need to upgrade plugins too <em>see upgrading</em>.</p></li>
<li><p>bindings to upgrade plugins?</p>
<ul class="incremental">
<li>update plugins: ~&lt;prefix&gt; + U</li>
<li>remove plugins not on the list: <code>&lt;prefix&gt; + alt + u</code></li>
</ul></li>
<li><p>use another shell as the default (ex: zsh instead of bash)</p>
<p>In the tmux config file (example: <code>$HOME/.tmux.conf</code>)</p>
<div class="sourceCode" id="cb6" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">set</span> <span class="ex">-g</span> default-command /usr/local/bin/zsh</a></code></pre></div></li>
</ol></li>
<li><p>Zip</p>
<ol class="incremental">
<li><p>list content of a zip file from stdin?</p>
<div class="sourceCode" id="cb7" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="ex">curl</span> file://<span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/dir.zip <span class="kw">|</span> <span class="ex">bsdtar</span> -xvf-</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; Dload  Upload   Total   Spent    Left  Speed</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; 100  1964  100  1964    0     0  43.5M      0 --:--:-- --:--:-- --:--:-- 43.5M</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; x dir/</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; x dir/2/</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; x dir/2/5/</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; x dir/2/5/data</span></a></code></pre></div></li>
</ol></li>
<li><p>Apt-get</p>
<ol class="incremental">
<li><p>dpkg show all installed files of a .deb?</p>
<div class="sourceCode" id="cb8" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="ex">dpkg</span> -L jenkins</a></code></pre></div></li>
<li><p>apt-get: what package provide this file?</p>
<div class="sourceCode" id="cb9" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="ex">apt-get</span> install apt-file</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="ex">apt-file</span> update</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="ex">apt-file</span> find <span class="op">&lt;</span>file<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>fix a broken state ?</p>
<div class="sourceCode" id="cb10" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" title="1"><span class="fu">sudo</span> apt-get install --fix-broken</a></code></pre></div></li>
<li><p>install a specific version?</p>
<div class="sourceCode" id="cb11" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1"><span class="ex">apt-get</span> install my-lib-java=2016.03.30-79 my-lib=2016.03.30-79</a></code></pre></div></li>
<li><p>show version that a package can be upgraded to?</p>
<div class="sourceCode" id="cb12" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1"><span class="ex">apt-cache</span> policy google-chrome-stable</a></code></pre></div></li>
<li><p>customize output of dpkg -l?</p>
<div class="sourceCode" id="cb13" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1"><span class="ex">dpkg-query</span> --show --showformat=<span class="st">&#39;${Package}\n&#39;</span></a></code></pre></div></li>
<li><p>Alternative</p>
<ol class="incremental">
<li><p>rebuild alternative for a particular package?</p>
<p>Note: there's problably a better way :) But this had worked:</p>
<div class="sourceCode" id="cb14" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" title="1"><span class="fu">sudo</span> aptitude purge openjdk-8-jdk</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="fu">sudo</span> aptitude install openjdk-8-jdk</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Rpm</p>
<ol class="incremental">
<li><p>list files installed by a package?</p>
<div class="sourceCode" id="cb15" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" title="1"><span class="ex">rpm</span> -ql [packageName]</a></code></pre></div></li>
<li><p>list only names of packages?</p>
<div class="sourceCode" id="cb16" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="ex">rpm</span> -qa --qf <span class="st">&quot;%{NAME}\n&quot;</span></a></code></pre></div></li>
</ol></li>
<li><p>Ps</p>
<ol class="incremental">
<li><p>list all processes, show only pids?</p>
<div class="sourceCode" id="cb17" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" title="1"><span class="fu">ps</span> ax -o pid=</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">#&gt; 3409</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt; 3413</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt; 3417</span></a></code></pre></div></li>
</ol></li>
<li><p>SeLinux</p>
<ol class="incremental">
<li><p>status/enable/disable selinux?</p>
<div class="sourceCode" id="cb18" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># with the selinux-utils pkg:</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co"># for example on debian like systems:</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="ex">aptitude</span> install selinux-utils</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co"># get selinux status</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="ex">getenforce</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co"># enable</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="ex">setenforce</span> 1</a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co"># disable</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="ex">setenforce</span> 0</a></code></pre></div></li>
</ol></li>
<li><p>Dd</p>
<p>Show progress with dd?</p>
<div class="sourceCode" id="cb19" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" title="1"><span class="fu">dd</span> if=/dev/sda of=/dev/sdb status=progress</a></code></pre></div></li>
<li><p>Systrace</p>
<ol class="incremental">
<li><p>How to cp with a progress bar using strace?</p>
<p>Adapted from: <a href="https://chris-lamb.co.uk/posts/can-you-get-cp-to-give-a-progress-bar-like-wget">https://chris-lamb.co.uk/posts/can-you-get-cp-to-give-a-progress-bar-like-wget</a></p>
<div class="sourceCode" id="cb20" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" title="1"><span class="bu">:</span>                                        <span class="dt">\ </span>                                                                                                                                                                15:23:48</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">&amp;&amp;</span> <span class="va">size=$(</span><span class="fu">stat</span> --format=<span class="st">&#39;%s&#39;</span> big<span class="va">)</span>        <span class="kw">\</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">&amp;&amp;</span> <span class="va">size=$((</span>size / (1024 * 1024) <span class="va">))</span>       <span class="kw">\</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">&amp;&amp;</span> <span class="kw">{</span> <span class="ex">strace</span> -ewrite cp big big2 <span class="op">2&gt;&amp;1</span> <span class="kw">;</span> <span class="kw">}</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb20-5" title="5">   <span class="kw">|</span> <span class="fu">tee</span> ~/tmp/cp.out                    \</a>
<a class="sourceLine" id="cb20-6" title="6">   <span class="kw">|</span> <span class="ex">pv</span> -l -s <span class="va">$size</span>                      \</a>
<a class="sourceLine" id="cb20-7" title="7">   <span class="op">&gt;</span> /dev/null  \</a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw">;</span></a></code></pre></div></li>
</ol></li>
<li><p>User/groups management</p>
<ol class="incremental">
<li><p>Users's group management command</p>
<table>
<thead>
<tr class="header">
<th>Subject</th>
<th>Action</th>
<th>Object</th>
<th>Command</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>list</td>
<td>groups</td>
<td><code>group $u</code></td>
<td></td>
</tr>
<tr class="even">
<td>user</td>
<td>add to</td>
<td>group</td>
<td><code>sudo usermod -aG $g $u</code></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>rm from</td>
<td>group</td>
<td><code>sudo gpasswd -d  $u $g</code></td>
<td><strong><strong>beware the reversed args from the previous cmd!</strong></strong></td>
</tr>
<tr class="even">
<td>user's group</td>
<td>refresh without logout</td>
<td></td>
<td><code>#TODO</code></td>
<td></td>
</tr>
<tr class="odd">
<td>group</td>
<td>add</td>
<td></td>
<td><code>sudo groupadd $g</code></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>rm</td>
<td></td>
<td><code>groupdel $g</code></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>add with uid</td>
<td></td>
<td><code>sudo groupadd -g $gid $g</code></td>
<td></td>
</tr>
</tbody>
</table>
<p>sudo groupadd $g</p>
<p>sudo groupadd -g $gid $g</p></li>
</ol></li>
</ol></li>
<li><p>Graphics</p>
<ol class="incremental">
<li><p>Imagemagick</p>
<ol class="incremental">
<li><p>how to change the quality of a jpeg image?</p>
<div class="sourceCode" id="cb21" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" title="1"><span class="ex">convert</span> input.png -quality 75 output.jpg</a></code></pre></div></li>
</ol></li>
<li><p>Ffmpeg</p>
<ol class="incremental">
<li><p>How to get only the 1st n minutes of videos?</p>
<div class="sourceCode" id="cb22" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">set</span> <span class="ex">--</span> i.mp4</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="ex">ffmpeg</span> -i <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span> -ss 0 -t 60 -c copy <span class="st">&quot;</span><span class="va">${1/</span>.<span class="va">/</span>.prev.<span class="va">}</span><span class="st">&quot;</span></a></code></pre></div></li>
<li><p>Record desktop?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode dot"><code class="sourceCode dot"><a class="sourceLine" id="cb23-1" title="1"><span class="va">ffmpeg</span> -<span class="va">i</span> <span class="va">output2</span>.<span class="va">m4v</span> -<span class="va">vf</span> <span class="st">&quot;scale=(trunc(iw/4)*4)/4:(trunc(ih/4)*4)/4&quot;</span> <span class="va">video</span>.<span class="va">mp4</span></a>
<a class="sourceLine" id="cb23-2" title="2">**** <span class="va">Math</span></a>
<a class="sourceLine" id="cb23-3" title="3">***** <span class="va">Bc</span></a>
<a class="sourceLine" id="cb23-4" title="4">****** <span class="va">float</span> <span class="va">precision</span>?</a>
<a class="sourceLine" id="cb23-5" title="5">       #+<span class="va">begin_src</span> <span class="va">sh</span></a>
<a class="sourceLine" id="cb23-6" title="6">       <span class="va">echo</span> &#39;<span class="va">scale</span><span class="ot">=</span><span class="dv">2</span> <span class="ot">;</span> <span class="dv">1</span>/<span class="dv">3</span>&#39; | <span class="va">bc</span> -<span class="va">l</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Net</p>
<ol class="incremental">
<li><p>General</p>
<ol class="incremental">
<li><p>Count all current tcp connection on linux host?</p>
<div class="sourceCode" id="cb24" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="fu">wc</span> -l /proc/net/tcp</a></code></pre></div></li>
<li><p>List all tcp connections on a linux host?</p>
<div class="sourceCode" id="cb25" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb25-1" title="1"><span class="ex">ss</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># or</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="fu">netstat</span></a></code></pre></div></li>
<li><p>List all ssh connections on a linux host?</p>
<div class="sourceCode" id="cb26" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb26-1" title="1"><span class="ex">ss</span> <span class="kw">|</span> <span class="fu">grep</span> ssh</a></code></pre></div></li>
</ol></li>
<li><p>Netcat</p>
<ol class="incremental">
<li><p>simple web server with netcat?</p>
<div class="sourceCode" id="cb27" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">while</span> <span class="fu">true</span><span class="kw">;</span> <span class="kw">do</span> <span class="ex">nc</span> -l 8989 <span class="op">&lt;&lt;&lt;</span> <span class="st">&quot;Hi! the time is now </span><span class="va">$(</span><span class="fu">date</span><span class="va">)</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">done</span></a></code></pre></div></li>
</ol></li>
<li><p>Ssh</p>
<ol class="incremental">
<li><p>How to check the <strong>actual</strong> configuration of a sshd server?</p>
<p>check the <strong>actual</strong> configuration of the dst server with: <code>ssh sshd -T</code></p></li>
<li><p>Ssh Tunnels</p>
<ol class="incremental">
<li><p>ssh tunnels explained</p>
<p><a href="https://unix.stackexchange.com/questions/115897/whats-ssh-port-forwarding-and-whats-the-difference-between-ssh-local-and-remot">https://unix.stackexchange.com/questions/115897/whats-ssh-port-forwarding-and-whats-the-difference-between-ssh-local-and-remot</a> <img src="file://img/ssh-tunnels-explained.png" /> <img src="file://img/ssh-tunnels-explained2.png" /></p></li>
<li><p>ssh reverse tunnel ?</p>
<div class="sourceCode" id="cb28" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># from the target machine:</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="fu">ssh</span> -R 2210:localhost:22 bserver.outside.com</a></code></pre></div>
<p>from: <a href="https://toic.org/blog/2009/reverse-ssh-port-forwarding/">https://toic.org/blog/2009/reverse-ssh-port-forwarding/</a></p></li>
<li><p>ssh tunnel example?</p>
<div class="sourceCode" id="cb29" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb29-1" title="1"><span class="va">localPort=</span>5555                              <span class="kw">\</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="va">remotePort=</span>5555                             <span class="kw">\</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="va">sshStr=</span>jenkins<span class="ex">@jenkins-deploy.fircosoft.net</span> \</a>
<a class="sourceLine" id="cb29-4" title="4">  bash -c <span class="st">&#39;ssh -N  -f -L ${localPort}:localhost:${remotePort} ${sshStr}&#39;</span></a></code></pre></div></li>
<li><p>ssh tunnel socks "channel 2: open failed: administratively prohibited: open failed"</p>
<ul class="incremental">
<li>make sure the destination ssh server has config in <code>/etc/ssh/sshd_config</code>:</li>
</ul>
<p><code>AllowTcpForwarding all=q
        =PermitOpen any</code></p>
<ul class="incremental">
<li>check the <strong>actual</strong> configuration of the dst server with: <code>ssh sshd -T</code></li>
</ul></li>
</ol></li>
<li><p>Passwordless and keyless ssh login</p>
<ol class="incremental">
<li><p>ssh without password or key?</p>
<div class="sourceCode" id="cb30" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># remove password for user</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="fu">passwd</span> -d user</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co"># sshd: allow empty password</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="fu">sed</span> -r <span class="st">&#39;s/#(PermitEmptyPasswords) no/\1 yes/&#39;</span> -i.bak /etc/ssh/sshd_config</a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co"># allow login with passwords</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="fu">sed</span> -r                                       \</a>
<a class="sourceLine" id="cb30-7" title="7">    -e <span class="st">&#39;s/#(PasswordAuthentication yes)/\1/&#39;</span> \</a>
<a class="sourceLine" id="cb30-8" title="8">    -i /etc/ssh/sshd_config                                                                          \</a></code></pre></div></li>
<li><p>ssh root without password or key?</p>
<div class="sourceCode" id="cb31" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb31-1" title="1"><span class="fu">passwd</span> -d root                               \</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">&amp;&amp;</span> <span class="fu">sed</span> -r                                    \</a>
<a class="sourceLine" id="cb31-3" title="3">   -e <span class="st">&#39;s/#(PermitEmptyPasswords) no/\1 yes/&#39;</span> \</a>
<a class="sourceLine" id="cb31-4" title="4">   -e <span class="st">&#39;s/#(PasswordAuthentication yes)/\1/&#39;</span>  \</a>
<a class="sourceLine" id="cb31-5" title="5">   -e <span class="st">&#39;s/#(PermitRootLogin).*$/\1 yes/&#39;</span>      \</a>
<a class="sourceLine" id="cb31-6" title="6">   -i /etc/ssh/sshd_config                   \</a></code></pre></div>
<ul class="incremental">
<li><p>dockerfile:</p>
#+BEGIN<sub>SRC</sub> sh</li>
</ul>
<p>FROM alpine RUN apk update &amp;&amp; apk add openssh-server openssh-keygen RUN ssh-keygen -A CMD passwd -d root \ &amp;&amp; sed -r \ -e 's/#(PermitEmptyPasswords) no/\1 yes/' \ -e 's/#(PasswordAuthentication yes)/\1/' \ -e 's/#(PermitRootLogin).*$/\1 yes/' \ -i /etc/ssh/sshd<sub>config</sub> \ &amp;&amp; egrep 'AllowUsers|PermitRootLogin|PermitEmptyPasswords|PasswordAuthentication' \ /etc/ssh/sshd<sub>config</sub> \ &amp;&amp; /usr/sbin/sshd -D</p>
<p>#+END<sub>SRC</sub></p></li>
<li><p>working conf for openssh 7.1 on alpine?</p>
<div class="sourceCode" id="cb32" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb32-1" title="1"><span class="ex">HostKey</span> /etc/ssh/ssh_host_rsa_key</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="ex">HostKey</span> /etc/ssh/ssh_host_ecdsa_key</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="ex">HostKey</span> /etc/ssh/ssh_host_ed25519_key</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="ex">SyslogFacility</span> AUTHPRIV</a>
<a class="sourceLine" id="cb32-5" title="5"><span class="ex">PermitRootLogin</span> yes</a>
<a class="sourceLine" id="cb32-6" title="6"><span class="ex">AuthorizedKeysFile</span>      .ssh/authorized_keys</a>
<a class="sourceLine" id="cb32-7" title="7"><span class="ex">PermitEmptyPasswords</span> yes</a>
<a class="sourceLine" id="cb32-8" title="8"><span class="ex">PasswordAuthentication</span> yes</a>
<a class="sourceLine" id="cb32-9" title="9"><span class="ex">ChallengeResponseAuthentication</span> no</a>
<a class="sourceLine" id="cb32-10" title="10"><span class="ex">GSSAPIAuthentication</span> yes</a>
<a class="sourceLine" id="cb32-11" title="11"><span class="ex">GSSAPICleanupCredentials</span> no</a>
<a class="sourceLine" id="cb32-12" title="12"><span class="ex">UsePAM</span> yes</a>
<a class="sourceLine" id="cb32-13" title="13"><span class="ex">X11Forwarding</span> yes</a>
<a class="sourceLine" id="cb32-14" title="14"><span class="ex">UsePrivilegeSeparation</span> sandbox          <span class="co"># Default for new installations.</span></a>
<a class="sourceLine" id="cb32-15" title="15"><span class="ex">AcceptEnv</span> LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES</a>
<a class="sourceLine" id="cb32-16" title="16"><span class="ex">AcceptEnv</span> LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT</a>
<a class="sourceLine" id="cb32-17" title="17"><span class="ex">AcceptEnv</span> LC_IDENTIFICATION LC_ALL LANGUAGE</a>
<a class="sourceLine" id="cb32-18" title="18"><span class="ex">AcceptEnv</span> XMODIFIERS</a>
<a class="sourceLine" id="cb32-19" title="19"><span class="ex">Subsystem</span>       sftp    /usr/libexec/openssh/sftp-server</a></code></pre></div></li>
</ol></li>
<li><p>generate public private key pair</p>
<div class="sourceCode" id="cb33" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="fu">ssh-keygen</span> -t rsa -b 4096 -C <span class="st">&quot;your_email@example.com&quot;</span></a></code></pre></div></li>
<li><p>ssh or scp in a script without entering password ?</p>
<div class="sourceCode" id="cb34" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="ex">expect</span> -c <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">   spawn scp login@somehost.com:/somefile .</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">   expect yes/no { send yes\r ; exp_continue }</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">   expect password: { send password\r }</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">   expect 100%</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="st">   exit</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="st">&quot;</span></a></code></pre></div></li>
<li><p>get public key from private key ?</p>
<div class="sourceCode" id="cb35" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb35-1" title="1"><span class="fu">ssh-keygen</span> -y -f ~/.ssh/id_rsa</a></code></pre></div></li>
<li><p>Disable host verification?</p>
<ol class="incremental">
<li><p>for one session</p>
<div class="sourceCode" id="cb36" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb36-1" title="1"><span class="fu">ssh</span> -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no peter@192.168.0.100</a></code></pre></div>
<p><a href="http://linuxcommando.blogspot.co.uk/2008/10/how-to-disable-ssh-host-key-checking.html">http://linuxcommando.blogspot.co.uk/2008/10/how-to-disable-ssh-host-key-checking.html</a></p></li>
<li><p>for all sessions:</p>
<p>in <code>~/.ssh/config</code>:</p>
<div class="sourceCode" id="cb37" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb37-1" title="1"><span class="ex">Host</span> 192.168.0.*</a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="ex">StrictHostKeyChecking</span> no</a>
<a class="sourceLine" id="cb37-3" title="3">  <span class="va">UserKnownHostsFile=</span>/dev/null</a></code></pre></div></li>
<li><p>for all sessions and all hosts:</p>
<p>in <code>~/.ssh/config</code>:</p>
<div class="sourceCode" id="cb38" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb38-1" title="1"><span class="ex">StrictHostKeyChecking</span> no</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="va">UserKnownHostsFile=</span>/dev/null</a></code></pre></div></li>
</ol></li>
<li><p>copy pub key to remote authorized<sub>keys</sub>?</p>
<div class="sourceCode" id="cb39" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb39-1" title="1"><span class="ex">ssh-copy-id</span> <span class="op">&lt;</span>user<span class="op">&gt;</span>@<span class="op">&lt;</span>host<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb39-2" title="2"></a></code></pre></div></li>
<li><p>workaround for a ssh slow login on a particular server?</p>
<p>Use port forwarding to keep the connection open</p>
<div class="sourceCode" id="cb40" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb40-1" title="1"><span class="va">remoteUser=</span>user</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="va">remoteHost=</span>server.com</a>
<a class="sourceLine" id="cb40-3" title="3"><span class="va">remoteSshPort=</span>22</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co"># choose a free port on the client</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="va">localPort=</span>5555</a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co"># port forward the remote host ssh</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="fu">ssh</span> -N  -f -L <span class="va">${localPort}</span>:localhost:<span class="va">${remoteSshPort}</span> <span class="va">${remoteUser}</span>@<span class="va">${remoteHost}</span></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co"># use the local port forward</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="fu">ssh</span> -p <span class="va">${localPort}</span> <span class="va">${remoteUser}</span>@<span class="va">${remoteHost}</span></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="co"># close the port forwarding</span></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="fu">fuser</span> -k -n tcp 5555</a></code></pre></div></li>
<li><p>copy between two ssh hosts without intermediary copy?</p>
<div class="sourceCode" id="cb41" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb41-1" title="1"><span class="bu">:</span>                                         \</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">&amp;&amp;</span> <span class="va">srcDir=</span>srcdir                          <span class="kw">\</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">&amp;&amp;</span> <span class="va">dstSsh=</span>user<span class="ex">@host</span>                       \</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw">&amp;&amp;</span> <span class="va">dstParentDir=</span>/tmp                      <span class="kw">\</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="kw">&amp;&amp;</span> <span class="fu">tar</span> cav <span class="st">&quot;</span><span class="va">$srcDir</span><span class="st">&quot;</span>                      \</a>
<a class="sourceLine" id="cb41-6" title="6">   <span class="kw">|</span> <span class="fu">gzip</span>                                 \</a>
<a class="sourceLine" id="cb41-7" title="7">   <span class="kw">|</span> <span class="fu">ssh</span> <span class="st">&quot;</span><span class="va">$dstSsh</span><span class="st">&quot;</span>                        \</a>
<a class="sourceLine" id="cb41-8" title="8">       <span class="st">&quot;                                  \</span></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="st">         bash -euo pipefail -xvc &#39;        \</span></a>
<a class="sourceLine" id="cb41-10" title="10"><span class="st">           gunzip                         \</span></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="st">           | tar -xvf- -C </span><span class="va">${dstParentDir}</span><span class="st"> \</span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="st">         &#39;                                \</span></a>
<a class="sourceLine" id="cb41-13" title="13"><span class="st">       &quot;</span>                                  \</a>
<a class="sourceLine" id="cb41-14" title="14"><span class="kw">&amp;&amp;</span>                                        <span class="kw">\</span></a>
<a class="sourceLine" id="cb41-15" title="15"><span class="bu">:</span></a></code></pre></div></li>
<li><p>disable host has in known<sub>hosts</sub>?</p>
<div class="sourceCode" id="cb42" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb42-1" title="1"><span class="va">HashKnownHosts=</span>false</a></code></pre></div></li>
<li><p>Non interactive sftp session with non pubkey password?</p>
<div class="sourceCode" id="cb43" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb43-1" title="1"><span class="ex">sshpass</span> -e -- sftp -oBatchMode=no -b - user@host <span class="op">&lt;&lt; !</span></a>
<a class="sourceLine" id="cb43-2" title="2">      get /path/to/file</a>
<a class="sourceLine" id="cb43-3" title="3">      bye</a>
<a class="sourceLine" id="cb43-4" title="4">  !</a></code></pre></div></li>
<li><p>How to view actual ssh config (system wide + user config + cmdline/env)?</p>
<div class="sourceCode" id="cb44" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb44-1" title="1"><span class="fu">ssh</span> -G localhost</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co">#&gt; hostname localhost</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#&gt; port 22</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="co">#&gt; addressfamily any</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="co">#&gt; batchmode no</span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="co">#&gt; (...)</span></a></code></pre></div></li>
<li><p>Sshfs</p>
<ol class="incremental">
<li><p>how to mount remote fs with sshfs?</p>
<ul class="incremental">
<li>mount:</li>
</ul>
<div class="sourceCode" id="cb45" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># usage</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="ex">sshfs</span> USERNAME@HOSTNAME_OR_IP:/REMOTE_PATH LOCAL_MOUNT_POINT SSH_OPTIONS</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co"># example</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="ex">sshfs</span> sessy@mycomputer:/remote/path /local/path -C -p 9876 -o allow_other</a></code></pre></div>
<p><a href="https://wiki.archlinux.org/index.php/SSHFS">https://wiki.archlinux.org/index.php/SSHFS</a></p>
<ul class="incremental">
<li>umount: <em>how to umount a mounted sshfs?</em></li>
</ul></li>
<li><p>how to umount a mounted sshfs?</p>
<div class="sourceCode" id="cb46" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb46-1" title="1"><span class="ex">fusermount</span> -u  /path/to</a></code></pre></div></li>
<li><p>sshfs with autossh?</p>
<p>From: <a href="https://wiki.gentoo.org/wiki/Autossh">https://wiki.gentoo.org/wiki/Autossh</a></p>
<div class="sourceCode" id="cb47" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb47-1" title="1">         <span class="ex">sshfs</span> -o reconnect,compression=yes,transform_symlinks,ServerAliveInterval=45,ServerAliveCountMax=2,ssh_command=<span class="st">&#39;autossh -M 0&#39;</span> username@server:/ /mnt/remote<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">Removal</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Openssl</p>
<ol class="incremental">
<li><p>SslCerts</p>
<ol class="incremental">
<li><p>generate a self certificate for localhost (without prompt)?</p>
<p>from: <a href="https://letsencrypt.org/docs/certificates-for-localhost/">https://letsencrypt.org/docs/certificates-for-localhost/</a></p>
<div class="sourceCode" id="cb48" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb48-1" title="1">     <span class="ex">openssl</span> req -x509 -out localhost.crt -keyout localhost.key \</a>
<a class="sourceLine" id="cb48-2" title="2">-newkey rsa:2048 -nodes -sha256 \</a>
<a class="sourceLine" id="cb48-3" title="3">-subj <span class="st">&#39;/CN=localhost&#39;</span> -extensions EXT -config <span class="op">&lt;(</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb48-4" title="4"> <span class="bu">printf</span> <span class="st">&quot;[dn]\nCN=localhost\n[req]\ndistinguished_name = dn\n[EXT]\nsubjectAltName=DNS:localhost\nkeyUsage=digitalSignature\nextendedKeyUsage=serverAuth&quot;</span><span class="op">)</span></a></code></pre></div></li>
<li><p>How to add root cert to an Ubuntu install?</p>
<div class="sourceCode" id="cb49" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb49-1" title="1"><span class="fu">cat</span> <span class="op">&lt;&lt;EOF&#39;&#39;</span></a>
<a class="sourceLine" id="cb49-2" title="2">:                                            \</a>
<a class="sourceLine" id="cb49-3" title="3">&amp;&amp; set -xveuo pipefail                       \</a>
<a class="sourceLine" id="cb49-4" title="4">&amp;&amp; certFile=&lt;pathToCertFile&gt;.crt             \</a>
<a class="sourceLine" id="cb49-5" title="5">&amp;&amp; d=/usr/local/share/ca-certificates        \</a>
<a class="sourceLine" id="cb49-6" title="6">&amp;&amp; sudo cp <span class="va">$certFile</span> <span class="va">$d</span>                      \</a>
<a class="sourceLine" id="cb49-7" title="7">&amp;&amp; sudo update-ca-certificates               \</a>
<a class="sourceLine" id="cb49-8" title="8">&amp;&amp; sudo systemctl daemon-reload              \</a>
<a class="sourceLine" id="cb49-9" title="9">&amp;&amp; sudo systemctl restart docker             \</a>
<a class="sourceLine" id="cb49-10" title="10">&amp;&amp;                                           \</a>
<a class="sourceLine" id="cb49-11" title="11">:</a>
<a class="sourceLine" id="cb49-12" title="12">EOF</a>
<a class="sourceLine" id="cb49-13" title="13">) \</a>
<a class="sourceLine" id="cb49-14" title="14">| bash</a></code></pre></div></li>
<li><p>best explaination of "everything derive from the root ca key"?</p>
<p><a href="https://serverfault.com/questions/306345/certification-authority-root-certificate-expiry-and-renewal">https://serverfault.com/questions/306345/certification-authority-root-certificate-expiry-and-renewal</a></p></li>
<li><p>Generate a self signed ca cert and key, and a cert and key for a how that works on the command line and chrome?</p>
<p>from: <a href="https://stackoverflow.com/questions/7580508/getting-chrome-to-accept-self-signed-localhost-certificate">https://stackoverflow.com/questions/7580508/getting-chrome-to-accept-self-signed-localhost-certificate</a> Response: With only 5 openssl commands, you can accomplish this.</p>
<div class="sourceCode" id="cb50" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb50-1" title="1">       <span class="co">######################</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="co"># Become a Certificate Authority</span></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="co">######################</span></a>
<a class="sourceLine" id="cb50-4" title="4"></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="co"># Generate private key</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="ex">openssl</span> genrsa -des3 -out myCA.key 2048</a>
<a class="sourceLine" id="cb50-7" title="7"><span class="co"># Generate root certificate</span></a>
<a class="sourceLine" id="cb50-8" title="8"><span class="ex">openssl</span> req -x509 -new -nodes -key myCA.key -sha256 -days 825 -out myCA.pem</a>
<a class="sourceLine" id="cb50-9" title="9"></a>
<a class="sourceLine" id="cb50-10" title="10"><span class="co">######################</span></a>
<a class="sourceLine" id="cb50-11" title="11"><span class="co"># Create CA-signed certs</span></a>
<a class="sourceLine" id="cb50-12" title="12"><span class="co">######################</span></a>
<a class="sourceLine" id="cb50-13" title="13"></a>
<a class="sourceLine" id="cb50-14" title="14"><span class="va">NAME=</span>mydomain.com <span class="co"># Use your own domain name</span></a>
<a class="sourceLine" id="cb50-15" title="15"><span class="co"># Generate a private key</span></a>
<a class="sourceLine" id="cb50-16" title="16"><span class="ex">openssl</span> genrsa -out <span class="va">$NAME</span>.key 2048</a>
<a class="sourceLine" id="cb50-17" title="17"><span class="co"># Create a certificate-signing request</span></a>
<a class="sourceLine" id="cb50-18" title="18"><span class="ex">openssl</span> req -new -key <span class="va">$NAME</span>.key -out <span class="va">$NAME</span>.csr</a>
<a class="sourceLine" id="cb50-19" title="19"><span class="co"># Create a config file for the extensions</span></a>
<a class="sourceLine" id="cb50-20" title="20"><span class="op">&gt;</span><span class="va">$NAME</span><span class="ex">.ext</span> cat <span class="op">&lt;&lt;-EOF</span></a>
<a class="sourceLine" id="cb50-21" title="21">authorityKeyIdentifier=keyid,issuer</a>
<a class="sourceLine" id="cb50-22" title="22">basicConstraints=CA:FALSE</a>
<a class="sourceLine" id="cb50-23" title="23">keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment</a>
<a class="sourceLine" id="cb50-24" title="24">subjectAltName = @alt_names</a>
<a class="sourceLine" id="cb50-25" title="25">[alt_names]</a>
<a class="sourceLine" id="cb50-26" title="26">DNS.1 = <span class="va">$NAME</span> # Be sure to include the domain name here because Common Name is not so commonly honoured by itself</a>
<a class="sourceLine" id="cb50-27" title="27">DNS.2 = bar.<span class="va">$NAME</span> # Optionally, add additional domains (I&#39;ve added a subdomain here)</a>
<a class="sourceLine" id="cb50-28" title="28">IP.1 = 192.168.0.13 # Optionally, add an IP address (if the connection which you have planned requires it)</a>
<a class="sourceLine" id="cb50-29" title="29"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb50-30" title="30"><span class="co"># Create the signed certificate</span></a>
<a class="sourceLine" id="cb50-31" title="31"><span class="ex">openssl</span> x509 -req -in <span class="va">$NAME</span>.csr -CA myCA.pem -CAkey myCA.key -CAcreateserial \</a>
<a class="sourceLine" id="cb50-32" title="32">-out <span class="va">$NAME</span>.crt -days 825 -sha256 -extfile <span class="va">$NAME</span>.ext</a>
<a class="sourceLine" id="cb50-33" title="33"><span class="ex">To</span> recap:</a>
<a class="sourceLine" id="cb50-34" title="34"></a>
<a class="sourceLine" id="cb50-35" title="35"><span class="ex">Become</span> a CA</a>
<a class="sourceLine" id="cb50-36" title="36"><span class="ex">Sign</span> your certificate using your CA cert+key</a>
<a class="sourceLine" id="cb50-37" title="37"><span class="ex">Import</span> myCA.pem as an <span class="st">&quot;Authority&quot;</span> (not into <span class="st">&quot;Your Certificates&quot;</span>) <span class="kw">in</span> <span class="ex">your</span> Chrome settings (Settings <span class="op">&gt;</span> Manage certificates <span class="op">&gt;</span> Authorities <span class="op">&gt;</span> Import)</a>
<a class="sourceLine" id="cb50-38" title="38"><span class="ex">Use</span> the <span class="va">$NAME</span>.crt and <span class="va">$NAME</span>.key files in your server</a>
<a class="sourceLine" id="cb50-39" title="39"><span class="ex">Extra</span> steps (for Mac, at least)<span class="bu">:</span></a>
<a class="sourceLine" id="cb50-40" title="40"></a>
<a class="sourceLine" id="cb50-41" title="41"><span class="ex">Import</span> the CA cert at <span class="st">&quot;File &gt; Import file&quot;</span>, then also find it in the list, right click it, expand <span class="st">&quot;&gt; Trust&quot;</span>, and select <span class="st">&quot;Always&quot;</span></a>
<a class="sourceLine" id="cb50-42" title="42"><span class="ex">Add</span> extendedKeyUsage=serverAuth,clientAuth below basicConstraints=CA:FALSE, and make sure you set the <span class="st">&quot;CommonName&quot;</span> to the same as <span class="va">$NAME</span> when it<span class="st">&#39;s asking for setup</span></a>
<a class="sourceLine" id="cb50-43" title="43"><span class="st">You can check your work to ensure that the certificate is built correctly:</span></a>
<a class="sourceLine" id="cb50-44" title="44"></a>
<a class="sourceLine" id="cb50-45" title="45"><span class="st">openssl verify -CAfile myCA.pem -verify_hostname bar.mydomain.com mydomain.com.crt</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Rsync</p>
<ol class="incremental">
<li><p>how to specify the port in rsync?</p>
<div class="sourceCode" id="cb51" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb51-1" title="1"><span class="fu">rsync</span> -rvz -e <span class="st">&#39;ssh -p 2222&#39;</span> --progress --remove-sent-files ./dir user@host:/path</a></code></pre></div></li>
<li><p>how to exactly copy a local directory to a remote host (remove extra remote file if necessary) and back ?</p>
<div class="sourceCode" id="cb52" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># local -&gt; remote</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="fu">rsync</span> -rvza --progress --delete workspace/ jenkins@localhost:/home/jenkins/workspace</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="co"># remote -&gt; local</span></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="fu">rsync</span> -rvza --progress --delete jenkins@localhost:/home/jenkins/workspace/ workspace</a>
<a class="sourceLine" id="cb52-5" title="5"></a>
<a class="sourceLine" id="cb52-6" title="6"></a></code></pre></div></li>
<li><p>rsync and trailing slash behavior?</p>
<p>Only matter for the source dir:</p>
<ul class="incremental">
<li>if there is a trainling slash, means: copy the content of the dir</li>
<li>without trailing slash mean copy the directory</li>
</ul></li>
</ol></li>
<li><p>Openvpn</p>
<ol class="incremental">
<li><p>list and connect with openvpn from cli?</p>
<ol class="incremental">
<li><p>with nmanager</p>
<div class="sourceCode" id="cb53" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># list the connections</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="ex">nmcli</span> con show</a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co"># get the nome of a connection</span></a>
<a class="sourceLine" id="cb53-4" title="4"><span class="va">con=</span>openvpn</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="ex">nmcli</span> con up id <span class="va">$con</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Dns</p>
<ol class="incremental">
<li><p>Get ip from hostname?</p>
<div class="sourceCode" id="cb54" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb54-1" title="1"><span class="ex">host</span> google.com</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co">#&gt; google.com has address 172.217.17.78</span></a></code></pre></div></li>
<li><p>Get hostname from ip?</p>
<div class="sourceCode" id="cb55" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb55-1" title="1"><span class="ex">nslookup</span> <span class="va">$ip</span> domain.com</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="co">#&gt; &lt;ip&gt; name = &lt;domain&gt;</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Misc</p>
<ol class="incremental">
<li><p>VirtualBox</p>
<ol class="incremental">
<li><p>Windows host</p>
<ol class="incremental">
<li><p>Linux Guest</p>
<ol class="incremental">
<li><p>How to disable HyperV so VBox can run correctly?</p></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<h3 id="hardware">Hardware</h3>
<ol class="incremental">
<li><p>Sound</p>
<ol class="incremental">
<li><p>Troubleshoot sound in Linux/Ubuntu ?</p>
<p>Source: <a href="https://help.ubuntu.com/community/SoundTroubleshootingProcedure">https://help.ubuntu.com/community/SoundTroubleshootingProcedure</a></p>
<div class="sourceCode" id="cb56" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">(</span> <span class="kw">set</span> <span class="ex">-xv</span> <span class="kw">&amp;&amp;</span> <span class="fu">killall</span> pulseaudio<span class="kw">;</span> <span class="ex">pulseaudio</span> -k  <span class="kw">;</span> <span class="fu">rm</span> -r ~/.config/pulse/* <span class="kw">;</span> <span class="fu">rm</span> -r ~/.pulse* <span class="kw">)</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="fu">sleep</span> 10</a>
<a class="sourceLine" id="cb56-3" title="3"><span class="ex">pulseaudio</span> --start</a></code></pre></div></li>
</ol></li>
</ol>
<h2 id="windows">Windows</h2>
<h3 id="disable-hyperv-for-vbox">Disable hyperV for vbox?</h3>
<ul class="incremental">
<li>open a windows cmd.exe as admin</li>
<li>then run:</li>
</ul>
<div class="sourceCode" id="cb57" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb57-1" title="1"><span class="ex">mountvol</span> X: /s</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="ex">copy</span> %WINDIR%\System32\SecConfig.efi X:\EFI\Microsoft\Boot\SecConfig.efi /Y</a>
<a class="sourceLine" id="cb57-3" title="3"><span class="ex">bcdedit</span> /create <span class="dt">{0cb3b571-2f2e-4343-a879-d86a476d7215}</span> /d <span class="st">&quot;DebugTool&quot;</span> /application osloader</a>
<a class="sourceLine" id="cb57-4" title="4"><span class="ex">bcdedit</span> /set <span class="dt">{0cb3b571-2f2e-4343-a879-d86a476d7215}</span> path <span class="st">&quot;\EFI\Microsoft\Boot\SecConfig.efi&quot;</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="ex">bcdedit</span> /set <span class="dt">{bootmgr}</span> bootsequence <span class="dt">{0cb3b571-2f2e-4343-a879-d86a476d7215}</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="ex">bcdedit</span> /set <span class="dt">{0cb3b571-2f2e-4343-a879-d86a476d7215}</span> loadoptions DISABLE-LSA-ISO,DISABLE-VBS</a>
<a class="sourceLine" id="cb57-7" title="7"><span class="ex">bcdedit</span> /set <span class="dt">{0cb3b571-2f2e-4343-a879-d86a476d7215}</span> device partition=X:</a>
<a class="sourceLine" id="cb57-8" title="8"><span class="ex">mountvol</span> X: /d</a></code></pre></div>
<ul class="incremental">
<li>reboot</li>
<li>press F3 at all the question displayed pre-boot</li>
</ul>
<ol class="incremental">
<li><p>manually mount a shared folder in a linux guest?</p>
<div class="sourceCode" id="cb58" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb58-1" title="1"><span class="fu">sudo</span> mount -t vboxsf <span class="op">&lt;</span>sharedFolderName<span class="op">&gt;</span> /path/to/shared/folder/dir</a></code></pre></div></li>
<li><p>host alt-tab when in a guest?</p>
<p><code>host key</code> then alt-tab</p></li>
<li><p>Windows Hosts</p>
<ol class="incremental">
<li><p>Windows10</p>
<ol class="incremental">
<li><p>VT-x is not available (VERR<sub>VMXNOVMX</sub>)</p>
<p>From:</p>
<ul class="incremental">
<li>VT-x is not enabled in the BIOS</li>
<li>The CPU doesn't support VT-x</li>
<li>Hyper-V virtualization is enabled in Windows</li>
<li></li>
<li>Run in command prompt:</li>
</ul>
<div class="sourceCode" id="cb59" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb59-1" title="1"><span class="ex">dism.exe</span> /Online /Disable-Feature:Microsoft-Hyper-V</a></code></pre></div>
<ul class="incremental">
<li>And reboot</li>
</ul></li>
</ol></li>
</ol></li>
<li><p>Text</p>
<ol class="incremental">
<li><p>Less</p>
<ol class="incremental">
<li><p>how to search for a tab ?</p>
<p>Enter a literal tab with: <code>CTRL-v TAB</code>.</p></li>
</ol></li>
<li><p>Tail</p>
<ol class="incremental">
<li><p>skip the N first lines of input with tail?</p>
<div class="sourceCode" id="cb60" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb60-1" title="1"><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="fu">tail</span> -n +2</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="co">#&gt; 2</span></a>
<a class="sourceLine" id="cb60-3" title="3"><span class="co">#&gt; 3</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="co">#&gt; 4</span></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="co">#&gt; 5</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="co">#&gt; 6</span></a>
<a class="sourceLine" id="cb60-7" title="7"><span class="co">#&gt; 7</span></a>
<a class="sourceLine" id="cb60-8" title="8"><span class="co">#&gt; 8</span></a>
<a class="sourceLine" id="cb60-9" title="9"><span class="co">#&gt; 9</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Utils</p>
<ol class="incremental">
<li><p>Comm</p>
<ol class="incremental">
<li><p>comm summary?</p>
<p><code>comm &lt;(echo $'a\nb') &lt;(echo $'a\nc')</code></p>
<table>
<thead>
<tr class="header">
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>a</td>
</tr>
<tr class="even">
<td>b</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>c</td>
<td></td>
</tr>
</tbody>
</table>
<ul class="incremental">
<li>column1: only in FILE1</li>
<li>colukn2: only in FILE2</li>
<li>column3: in FILE1 and FILE2</li>
</ul></li>
<li><p>binary to compare the content of files (all in a but not in b, etc)?</p>
<p><code>comm</code></p></li>
</ol></li>
<li><p>Find</p>
<ol class="incremental">
<li><p>find files modified in the last x minutes</p>
<div class="sourceCode" id="cb61" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb61-1" title="1"><span class="fu">find</span> . -cmin -5</a></code></pre></div></li>
<li><p>find files modified in the last x days</p>
<div class="sourceCode" id="cb62" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb62-1" title="1"><span class="fu">find</span> . -ctime -5</a></code></pre></div></li>
<li><p>handle filenames with spaces ?</p>
<div class="sourceCode" id="cb63" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb63-1" title="1"><span class="fu">find</span> . -maxdepth 1 -print0 <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> -d <span class="st">$&#39;</span><span class="dt">\0</span><span class="st">&#39;</span> <span class="va">d</span> ; <span class="kw">do</span> <span class="bu">echo</span> <span class="va">$d</span> <span class="kw">;</span> <span class="kw">done</span></a></code></pre></div>
<p><a href="http://www.cyberciti.biz/tips/handling-filenames-with-spaces-in-bash.html">http://www.cyberciti.biz/tips/handling-filenames-with-spaces-in-bash.html</a></p></li>
<li><p>sort files by modified date?</p>
<div class="sourceCode" id="cb64" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb64-1" title="1"><span class="fu">find</span> -type f -printf <span class="st">&#39;%T@ %p\0&#39;</span> <span class="kw">|</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="fu">sort</span> -zk 1nr <span class="kw">|</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="fu">sed</span> -z <span class="st">&#39;s/^[^ ]* //&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39;\0&#39;</span> <span class="st">&#39;\n&#39;</span></a></code></pre></div></li>
<li><p>find files bigger than x MBytes?</p>
<div class="sourceCode" id="cb65" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb65-1" title="1"><span class="fu">find</span> . -size +500M -exec l {} <span class="dt">\;</span></a></code></pre></div></li>
<li><p>find filename with regex?</p>
<div class="sourceCode" id="cb66" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb66-1" title="1"><span class="fu">find</span> . -type f -regextype egrep -regex <span class="st">&#39;.*\.(msg|txt)$$&#39;</span></a></code></pre></div></li>
<li><p>find with logical or?</p>
<div class="sourceCode" id="cb67" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb67-1" title="1"><span class="ex">-name</span> <span class="st">&quot;*.xyz&quot;</span> OR ( -name <span class="st">&quot;*.abc&quot;</span> AND -exec ... )</a></code></pre></div></li>
</ol></li>
<li><p>Grep</p>
<ol class="incremental">
<li><p>Non capturing group?</p>
<p>Use: -(?:)-</p>
<div class="sourceCode" id="cb68" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb68-1" title="1"><span class="bu">echo</span> foo bar baz \</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;(?:foo)? bar&#39;</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="ex">foo</span> bar baz</a></code></pre></div></li>
<li><p>cheat sheet</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>short opt</th>
<th>long opt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>print file name with match</td>
<td><code>-H</code></td>
<td><code>--with-filename</code></td>
</tr>
<tr class="even">
<td>print only filename for matches</td>
<td><code>-l</code></td>
<td><code>--files-with-matches</code></td>
</tr>
</tbody>
</table></li>
<li><p>Character class for blanks?</p>
<div class="sourceCode" id="cb69" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb69-1" title="1"><span class="ex">jq</span> -nRr <span class="st">&#39;&quot;1: \t&quot;, &quot;2:  &quot;&#39;</span> <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;[[:space:]]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -R .</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co">#&gt; &quot;1: \t&quot;</span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co">#&gt; &quot;2:  &quot;</span></a></code></pre></div></li>
<li><p>match pattern on multiples lines?</p>
<div class="sourceCode" id="cb70" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb70-1" title="1"><span class="fu">seq</span> 4  <span class="kw">|</span> <span class="fu">grep</span> -Pz <span class="st">&#39;1\n2&#39;</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="co">#               ||</span></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="co">#               |+-------+ treat input as a set of lines  null terminated</span></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="co">#               +-----------+ Perl regex mode</span></a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co">#&gt; =1=</span></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="co">#&gt; =2=</span></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="co">#&gt;  3</span></a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">#&gt;  4</span></a></code></pre></div></li>
</ol></li>
<li><p>Tr</p>
<ol class="incremental">
<li><p>remove all non printable characters from a file with tr ?</p>
<div class="sourceCode" id="cb71" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb71-1" title="1"><span class="fu">tr</span> -cd <span class="st">&#39;[:print:]&#39;</span> <span class="op">&lt;</span> file <span class="op">&gt;</span> newfile</a></code></pre></div></li>
</ol></li>
<li><p>Nohup</p>
<ol class="incremental">
<li><p>run nohup?</p>
<div class="sourceCode" id="cb72" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb72-1" title="1"><span class="fu">nohup</span> bash -c <span class="st">&quot;(time bash executeScript 1 input fileOutput &gt; scrOutput) &amp;&gt; timeUse.txt&quot;</span> <span class="kw">&amp;</span></a></code></pre></div></li>
</ol></li>
<li><p>MoreUtils</p>
<ol class="incremental">
<li><p>read / process / write the same file ?</p>
<ul class="incremental">
<li>Use: <code>sponge</code></li>
<li><code>sponge</code> will read stdin and write to specified file. Unlike a shell redirect it will soaks all its input before writing the output file.</li>
</ul>
<div class="sourceCode" id="cb73" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb73-1" title="1"><span class="fu">sort</span> f <span class="kw">|</span> <span class="ex">sponge</span> f</a></code></pre></div></li>
<li><p>instead of xxx use moreutils yyy?</p>
<table>
<thead>
<tr class="header">
<th>cmd</th>
<th>insteadof</th>
<th>use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>chronic</code></td>
<td></td>
<td><code>chronic backup_script.sh</code></td>
</tr>
<tr class="even">
<td><code>sponge</code></td>
<td><code>sort filename</code> | <code>uniq/ &gt; temp</code></td>
<td><code>sort filename</code> | <code>uniq \vert sponge filename</code></td>
</tr>
<tr class="odd">
<td></td>
<td><code>mv temp filename</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>isutf8</code></td>
<td></td>
<td><code>isutf8 filename</code></td>
</tr>
<tr class="odd">
<td><code>ifne</code></td>
<td></td>
<td><code>./script.sh</code> | <code>ifne less</code></td>
</tr>
<tr class="even">
<td><code>pee</code></td>
<td><code>./script.sh</code> | <code>tee output1 output2</code></td>
<td><code>./script.sh</code> | <code>pee 'grep pattern1' 'gzip -c &gt; output.gz'_</code></td>
</tr>
<tr class="odd">
<td><code>ifdata</code></td>
<td><code>&lt;parsing ifconfig&gt;</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>zrun</code></td>
<td><code>diff &lt;(zcat one.gz) &lt;(zcat two.gz)</code></td>
<td><code>zrun diff one.gz two.gz</code></td>
</tr>
<tr class="odd">
<td><code>ts</code></td>
<td></td>
<td><code>$ { echo "One" ; sleep 3s ; echo "Two" ; }</code> | <code>ts</code></td>
</tr>
<tr class="even">
<td><code>errno</code></td>
<td></td>
<td><code>$ errno 98</code></td>
</tr>
<tr class="odd">
<td><code>vipe</code></td>
<td></td>
<td><code>command1</code> | <code>vipe</code> | <code>command2</code></td>
</tr>
<tr class="even">
<td><code>vidir</code></td>
<td></td>
<td><code>vidir directory/</code></td>
</tr>
<tr class="odd">
<td><code>combine</code></td>
<td><code>comm -12 file1 file2</code></td>
<td><code>combine file1 and file2</code></td>
</tr>
<tr class="even">
<td></td>
<td><code>comm -23 fileA fileB</code></td>
<td><code>combine fileA not fileB</code></td>
</tr>
<tr class="odd">
<td></td>
<td><code>sort file1 file2</code> | <code>uniq</code></td>
<td><code>combine file1 or file2</code></td>
</tr>
<tr class="even">
<td></td>
<td><code>sort file1 file2</code> | <code>uniq --unique</code></td>
<td><code>combine file1 xor file2</code></td>
</tr>
</tbody>
</table>
<p>See: <a href="http://devblog.nestoria.com/post/110168998173/moreutils-basic-unix-tools-that-ought-to-be">http://devblog.nestoria.com/post/110168998173/moreutils-basic-unix-tools-that-ought-to-be</a></p></li>
</ol></li>
<li><p>Stat</p>
<ol class="incremental">
<li><p>Custom format with newlines?</p>
<div class="sourceCode" id="cb74" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># use --printf to insert the code sequences</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="fu">stat</span> --printf=<span class="st">&#39;%U\n%G\n%C\n%z\n&#39;</span> /var/log/secure</a></code></pre></div></li>
</ol></li>
<li><p>Tar</p>
<ol class="incremental">
<li><p>list the content of a remote tgz without intermediary files?</p>
<div class="sourceCode" id="cb75" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb75-1" title="1"><span class="ex">curl</span> http://url/to/file.tgz <span class="kw">|</span> <span class="fu">tar</span> tzfv -</a></code></pre></div></li>
<li><p>send tar compressed archive to stdout?</p>
<div class="sourceCode" id="cb76" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb76-1" title="1"><span class="fu">seq</span> 3 <span class="op">&gt;</span> x <span class="kw">&amp;&amp;</span> <span class="fu">tar</span> czv x <span class="op">&gt;</span> x.tgz</a></code></pre></div></li>
<li><p>recompress without intermediary files?</p>
<p>don't know how to do it with regular target but there's a solution with bsdtar</p></li>
<li><p>Specify arbitrary order of files in tar file?</p></li>
</ol></li>
<li><p>Bsdtar</p>
<ol class="incremental">
<li><p>recompress without intermediary files?</p>
<div class="sourceCode" id="cb77" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb77-1" title="1"><span class="ex">bsdtar</span> -cJf - @- <span class="op">&lt;</span> a.tar.lzo <span class="op">&gt;</span> a.tar.xz</a></code></pre></div></li>
</ol></li>
<li><p>Tree</p>
<ol class="incremental">
<li><p>print tree with unicode characters?</p>
<div class="sourceCode" id="cb78" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb78-1" title="1"><span class="ex">tree</span> -N</a></code></pre></div></li>
</ol></li>
<li><p>Xargs</p>
<ol class="incremental">
<li><p>run a cmd on each line of stdin with xargs?</p>
<div class="sourceCode" id="cb79" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb79-1" title="1"><span class="bu">echo</span> <span class="st">&#39;a</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="st">b</span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="st">c&#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> -I {} <span class="ex">./f</span> {}</a></code></pre></div></li>
<li><p>use bash function?</p>
<div class="sourceCode" id="cb80" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb80-1" title="1"><span class="fu">f()</span> <span class="kw">{</span> <span class="fu">bc</span><span class="kw">;</span> <span class="kw">}</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="bu">echo</span> <span class="st">&#39;1 * 1</span></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="st">2 * 2</span></a>
<a class="sourceLine" id="cb80-4" title="4"><span class="st">3 * 3&#39;</span>                                            \</a>
<a class="sourceLine" id="cb80-5" title="5"><span class="kw">|</span> <span class="fu">xargs</span> -i echo <span class="st">&quot;</span><span class="va">$(</span><span class="bu">declare</span> -f <span class="va">f)</span><span class="st"> ; echo &#39;{}&#39; | f&quot;</span> \</a>
<a class="sourceLine" id="cb80-6" title="6"><span class="kw">|</span> <span class="fu">bash</span></a></code></pre></div></li>
</ol></li>
<li><p>Zip</p>
<ol class="incremental">
<li><p>unzip a single file from archive?</p>
<div class="sourceCode" id="cb81" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb81-1" title="1"><span class="fu">unzip</span> -p myarchive.zip path/to/zipped/file.txt <span class="op">&gt;</span>file.txt</a></code></pre></div></li>
<li><p>compress dir recursive?</p></li>
<li><p>compress dir but exclude a directory ?</p>
<div class="sourceCode" id="cb82" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb82-1" title="1"><span class="fu">zip</span> -9 -r --exclude=*.svn*  foo.zip [directory-to-compress]</a></code></pre></div>
<div class="sourceCode" id="cb83" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb83-1" title="1"><span class="fu">zip</span> -r archive.zip /dir</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Web</p>
<ol class="incremental">
<li><p>Curl</p>
<ol class="incremental">
<li><p>follow redirects?</p>
<div class="sourceCode" id="cb84" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb84-1" title="1"><span class="ex">curl</span> -L <span class="op">&lt;</span>url<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>post data from stdin?</p>
<div class="sourceCode" id="cb85" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb85-1" title="1"><span class="fu">cat</span> data.json <span class="kw">|</span> <span class="ex">curl</span> -H <span class="st">&quot;Content-Type: application/json&quot;</span> -X POST -d @- http://api</a></code></pre></div></li>
</ol></li>
<li><p>Wget</p>
<ol class="incremental">
<li><p>recursively download for example nexus ?</p>
<div class="sourceCode" id="cb86" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb86-1" title="1"><span class="fu">wget</span> --header=<span class="st">&quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>                  \</a>
<a class="sourceLine" id="cb86-2" title="2">     --header=<span class="st">&quot;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0&quot;</span> \</a>
<a class="sourceLine" id="cb86-3" title="3">     --recursive                                                                                         \</a>
<a class="sourceLine" id="cb86-4" title="4">     -e robots=off                                                                                       \</a>
<a class="sourceLine" id="cb86-5" title="5">     --no-parent                                                                                         \</a>
<a class="sourceLine" id="cb86-6" title="6">     http://nexus-url/x/y/z</a></code></pre></div></li>
<li><p>equivalent of curl -sS?</p></li>
</ol></li>
<li><p>Nginx</p>
<ol class="incremental">
<li><p>Check config syntax?</p>
<div class="sourceCode" id="cb87" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb87-1" title="1"><span class="ex">/usr/nginx/sbin/nginx</span> -t -c /usr/nginx/conf/nginx.conf</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="ex">/usr/nginx/sbin/nginx</span> -t</a></code></pre></div></li>
</ol></li>
<li><p>Lynx</p>
<ol class="incremental">
<li><p>html to text by piping to lynx?</p>
<div class="sourceCode" id="cb88" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb88-1" title="1"><span class="ex">curl</span> -L --fail -sS <span class="st">&#39;https://duckduckgo.com?q=lynx&#39;</span> \</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">|</span> <span class="fu">lynx</span> --dump --stdin</a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co">#&gt; [...]</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="co">#&gt; [1]DuckDuckGo</span></a>
<a class="sourceLine" id="cb88-6" title="6"><span class="co">#&gt; lynx________________ [BUTTON Input] (not implemented)_ S</span></a>
<a class="sourceLine" id="cb88-7" title="7"><span class="co">#&gt; REFRESH(0 sec): [2]file://localhost/html?q=lynx</span></a>
<a class="sourceLine" id="cb88-8" title="8"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb88-9" title="9"><span class="co">#&gt; You are being redirected to the non-JavaScript site.</span></a>
<a class="sourceLine" id="cb88-10" title="10"><span class="co">#&gt; [...]</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>X11</p>
<ol class="incremental">
<li><p>NxClient</p>
<ol class="incremental">
<li><p>keyboard issue when connecting with nx ?</p>
<p>Try:</p>
<div class="sourceCode" id="cb89" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb89-1" title="1"><span class="ex">setxkbmap</span> -model evdev -layout us</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol>
<h3 id="sysadmin">Sysadmin</h3>
<ol class="incremental">
<li><p>System Services (systemctl, …)</p>
<ol class="incremental">
<li><p>Systemd</p>
<ol class="incremental">
<li><p>systemd / systemV cheatsheet</p>
<p>from: <a href="https://fedoraproject.org/wiki/SysVinit_to_Systemd_Cheatsheet">https://fedoraproject.org/wiki/SysVinit_to_Systemd_Cheatsheet</a></p>
<table>
<thead>
<tr class="header">
<th>service</th>
<th>Sysvinit Command</th>
<th>Systemd Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stop</td>
<td><code>service ${name} stop</code></td>
<td><code>systemctl stop        ${name}</code></td>
</tr>
<tr class="even">
<td>start</td>
<td><code>service ${name} start</code></td>
<td><code>systemctl start       ${name}</code></td>
</tr>
<tr class="odd">
<td>restart</td>
<td><code>service ${name} restart</code></td>
<td><code>systemctl restart     ${name}</code></td>
</tr>
<tr class="even">
<td>reload conf</td>
<td><code>service ${name} reload</code></td>
<td><code>systemctl reload      ${name}</code></td>
</tr>
<tr class="odd">
<td>restart if service already running</td>
<td><code>service ${name} condrestart</code></td>
<td><code>systemctl condrestart ${name}</code></td>
</tr>
<tr class="even">
<td>status</td>
<td><code>service ${name} status</code></td>
<td><code>systemctl status      ${name}</code></td>
</tr>
<tr class="odd">
<td>enable</td>
<td><code>chkconfig ${name} on</code></td>
<td><code>systemctl enable     ${name}</code></td>
</tr>
<tr class="even">
<td>disable</td>
<td><code>chkconfig ${name} off</code></td>
<td><code>systemctl disable    ${name}</code></td>
</tr>
<tr class="odd">
<td>isEnabled?</td>
<td><code>chkconfig ${name}</code></td>
<td><code>systemctl is-enabled ${name}</code></td>
</tr>
<tr class="even">
<td>reload when created or modififeds</td>
<td><code>chkconfig ${name} --add</code></td>
<td><code>systemctl daemon-reload</code></td>
</tr>
<tr class="odd">
<td>list all services</td>
<td><code>ls /etc/rc.d/init.d/</code></td>
<td><code>systemctl</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>(or) <code>systemctl list-unit-files --type=service</code></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>(or) <code>ls /{etc,lib}/systemd/system/*.service</code></td>
</tr>
<tr class="even">
<td>print levels where this service</td>
<td><code>chkconfig ${name} --list</code></td>
<td><code>systemctl list-unit-files --type=service</code></td>
</tr>
<tr class="odd">
<td>is on/off</td>
<td></td>
<td>(or) <code>ls /etc/systemd/system/*.wants/</code></td>
</tr>
<tr class="even">
<td>print graphical mode services</td>
<td><code>chkconfig --list \vert grep 5:on</code></td>
<td><code>systemctl list-dependencies graphical.target</code></td>
</tr>
<tr class="odd">
<td>print what level of this service</td>
<td><code>chkconfig ${name} --list</code></td>
<td><code>ls /etc/systemd/system/*.wants/${serviceName}.service</code></td>
</tr>
</tbody>
</table></li>
<li><p>follow logs of a particular systemd service?</p>
<div class="sourceCode" id="cb90" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb90-1" title="1"><span class="ex">journalctl</span> -fu collectd</a></code></pre></div></li>
</ol></li>
<li><p>General Linux</p>
<ol class="incremental">
<li><p>Linux reload service config</p>
<div class="sourceCode" id="cb91" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb91-1" title="1"><span class="fu">sudo</span> systemctl daemon-reload</a></code></pre></div></li>
</ol></li>
<li><p>Centos</p>
<ol class="incremental">
<li><p>create a new systemd unit file?</p>
<div class="sourceCode" id="cb92" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb92-1" title="1">    <span class="co"># create a new unit file</span></a>
<a class="sourceLine" id="cb92-2" title="2">      <span class="kw">(</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF&#39;&#39;</span></a>
<a class="sourceLine" id="cb92-3" title="3">[Unit]</a>
<a class="sourceLine" id="cb92-4" title="4">Description=Post docker</a>
<a class="sourceLine" id="cb92-5" title="5">After=docker.service</a>
<a class="sourceLine" id="cb92-6" title="6"></a>
<a class="sourceLine" id="cb92-7" title="7">[Service]</a>
<a class="sourceLine" id="cb92-8" title="8">Type=oneshot</a>
<a class="sourceLine" id="cb92-9" title="9">ExecStart=/usr/bin/chmod 606 /var/run/docker.sock</a>
<a class="sourceLine" id="cb92-10" title="10">RemainAfterExit=true</a>
<a class="sourceLine" id="cb92-11" title="11"></a>
<a class="sourceLine" id="cb92-12" title="12">[Install]</a>
<a class="sourceLine" id="cb92-13" title="13">WantedBy=multi-user.target</a>
<a class="sourceLine" id="cb92-14" title="14"></a>
<a class="sourceLine" id="cb92-15" title="15">EOF</a>
<a class="sourceLine" id="cb92-16" title="16">   ) | sudo tee /etc/systemd/system/multi-user.target.wants/docker-post.service</a>
<a class="sourceLine" id="cb92-17" title="17">   # reload</a>
<a class="sourceLine" id="cb92-18" title="18">   sudo systemctl daemon-reload</a>
<a class="sourceLine" id="cb92-19" title="19">   # check the status</a>
<a class="sourceLine" id="cb92-20" title="20">   systemctl status docker-post.service</a>
<a class="sourceLine" id="cb92-21" title="21">   # enable at boot</a>
<a class="sourceLine" id="cb92-22" title="22">   systemctl enable docker-post.service</a></code></pre></div>
<div class="sourceCode" id="cb93" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># list all services</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="ex">systemctl</span> list-unit-files --type=service</a>
<a class="sourceLine" id="cb93-3" title="3"></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="co"># check if a service is running</span></a>
<a class="sourceLine" id="cb93-5" title="5"><span class="ex">systemctl</span> status name.service</a>
<a class="sourceLine" id="cb93-6" title="6"></a>
<a class="sourceLine" id="cb93-7" title="7"><span class="co"># enable a service</span></a>
<a class="sourceLine" id="cb93-8" title="8"><span class="ex">systemctl</span> enable docker.service</a>
<a class="sourceLine" id="cb93-9" title="9"></a>
<a class="sourceLine" id="cb93-10" title="10"><span class="co"># check if a service is enabled</span></a></code></pre></div></li>
<li><p>the hostname keep coming back at its previous state after each restart?</p>
<p>Try setting the hostanem in <code>/etc/hostname</code></p></li>
</ol></li>
</ol></li>
<li><p>User Admin</p>
<ol class="incremental">
<li><p>how to add a group to a user ?</p>
<div class="sourceCode" id="cb94" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb94-1" title="1"><span class="fu">sudo</span> usermod -aG docker u</a></code></pre></div></li>
<li><p>add a user with specific groups ?</p>
<div class="sourceCode" id="cb95" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb95-1" title="1"><span class="ex">adduser</span> -G group1,group2 <span class="op">&lt;</span>user<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>get the groups of a user ?</p>
<div class="sourceCode" id="cb96" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb96-1" title="1"><span class="fu">groups</span> <span class="op">&lt;</span>user<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>change the shell of a user?</p>
<div class="sourceCode" id="cb97" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb97-1" title="1"><span class="ex">usermod</span> -s /bin/bash user</a></code></pre></div></li>
<li><p>remove a user?</p>
<div class="sourceCode" id="cb98" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb98-1" title="1"><span class="bu">export</span> <span class="va">U=</span><span class="op">&lt;</span><span class="ex">user</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="ex">userdel</span> -r <span class="va">$U</span></a></code></pre></div></li>
<li><p>add a user?</p>
<div class="sourceCode" id="cb99" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb99-1" title="1"><span class="ex">adduser</span> <span class="op">&lt;</span>user<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>view login activity?</p>
<div class="sourceCode" id="cb100" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb100-1" title="1"><span class="fu">last</span></a></code></pre></div></li>
</ol></li>
<li><p>Sudo</p>
<ol class="incremental">
<li><p>allow sudo without password for a user?</p>
<div class="sourceCode" id="cb101" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb101-1" title="1"><span class="co"># if there&#39;s a sudo group add the user to this group</span></a></code></pre></div></li>
<li><p>execute a cmd as another user?</p>
<div class="sourceCode" id="cb102" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb102-1" title="1"><span class="fu">sudo</span> -u <span class="op">&lt;</span>user<span class="op">&gt;</span> /bin/ls -alrth <span class="op">&lt;</span>...<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="co"># WARN! path to binaries must be absolute!</span></a></code></pre></div></li>
</ol></li>
<li><p>Devices (hdd,…)</p>
<ol class="incremental">
<li><p>eject a cd rom?</p>
<div class="sourceCode" id="cb103" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb103-1" title="1"><span class="ex">ejet</span> /dev/cdrom</a></code></pre></div></li>
<li><p>how to list all supported FS for mounting?</p>
<div class="sourceCode" id="cb104" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb104-1" title="1"><span class="fu">cat</span> /proc/filesystems</a></code></pre></div></li>
<li><p>how to fix a screwed nfs mount without rebooting?</p>
<p>TODO: should be completed</p>
<ul class="incremental">
<li>Find the list of process open on the screwed fs:</li>
</ul>
<div class="sourceCode" id="cb105" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb105-1" title="1"><span class="ex">lsof</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;/path/to/nfs&#39;</span></a></code></pre></div>
<ul class="incremental">
<li>kill them</li>
<li>remount</li>
</ul>
<p>ref: <a href="http://joelinoff.com/blog/?p=356">http://joelinoff.com/blog/?p=356</a></p></li>
<li><p>Swap</p>
<ol class="incremental">
<li><p>manage swap (status, enable, disable)?</p>
<div class="sourceCode" id="cb106" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb106-1" title="1"><span class="co"># status</span></a>
<a class="sourceLine" id="cb106-2" title="2"><span class="ex">swapon</span> -s</a>
<a class="sourceLine" id="cb106-3" title="3"><span class="co"># alloff</span></a>
<a class="sourceLine" id="cb106-4" title="4"><span class="ex">swapoff</span> -a</a>
<a class="sourceLine" id="cb106-5" title="5"><span class="co"># allon</span></a>
<a class="sourceLine" id="cb106-6" title="6"><span class="ex">swapon</span> -a</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Dns</p>
<ol class="incremental">
<li><p>How to query all the entries of a dns server ?</p>
<div class="sourceCode" id="cb107" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">set</span> <span class="ex">--</span> domain=mydomain.net</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="ex">dig</span> +nocmd <span class="va">${domain}</span> any +multiline +noall +answer</a></code></pre></div></li>
</ol></li>
<li><p>recover a lost root password at boot with grub</p>
<ul class="incremental">
<li>type some keys at boot to display the menu</li>
<li>edit the boot options</li>
<li>change the line
<ul class="incremental">
<li>that contains: … kerne … quiet splash</li>
<li>remove quiet splash</li>
<li>add at the end: init=/bin/bash</li>
</ul></li>
<li>boot</li>
<li><p>at the prompt:</p>
<div class="sourceCode" id="cb108" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb108-1" title="1"><span class="fu">mount</span> -o remount,rw /</a>
<a class="sourceLine" id="cb108-2" title="2"><span class="fu">mount</span> -o remount,rw /proc</a>
<a class="sourceLine" id="cb108-3" title="3"><span class="fu">passwd</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="fu">sync</span></a></code></pre></div></li>
<li>reboot</li>
</ul></li>
</ol>
<h3 id="terminal">Terminal</h3>
<ol class="incremental">
<li><p>Colors</p>
<ol class="incremental">
<li><p>simple way to color output with grep?</p>
<div class="sourceCode" id="cb109" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb109-1" title="1"><span class="bu">echo</span> -e <span class="st">&#39;foo\nbar\nbaz&#39;</span>                           \</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">|</span> <span class="va">GREP_COLOR=</span><span class="st">&#39;01;36&#39;</span> <span class="fu">egrep</span> --color=always <span class="st">&#39;foo|$&#39;</span> \</a>
<a class="sourceLine" id="cb109-3" title="3"><span class="kw">|</span> <span class="va">GREP_COLOR=</span><span class="st">&#39;01;31&#39;</span> <span class="fu">egrep</span> --color=always <span class="st">&#39;baz|$&#39;</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="co">#&gt; foo *colored turquoise*</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="co">#&gt; bar</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="co">#&gt; baz *colored red*</span></a></code></pre></div></li>
</ol></li>
<li><p>Replace capslock by ctrl in console?</p>
<ol class="incremental">
<li><p>working also in virtual consoles?</p>
<div class="sourceCode" id="cb110" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb110-1" title="1"><span class="co">#in  /etc/default/keyboard</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="co">#replace XKBOPTIONS=&quot;&quot; by XKBOPTIONS=&quot;ctrl:nocaps&quot;</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="co"># then run</span></a>
<a class="sourceLine" id="cb110-4" title="4"><span class="ex">run</span> sudo dpkg-reconfigure -phigh console-setup</a></code></pre></div>
<p>ref: <a href="https://www.emacswiki.org/emacs/MovingTheCtrlKey#toc9">https://www.emacswiki.org/emacs/MovingTheCtrlKey#toc9</a></p></li>
<li><p>working under X?</p>
<div class="sourceCode" id="cb111" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb111-1" title="1"><span class="ex">setxkbmap</span> -option ctrl:nocaps</a></code></pre></div></li>
</ol></li>
<li><p>replace capslock by ctrl in a terminal under X ?</p></li>
<li><p>change language keyboard mapping</p>
<div class="sourceCode" id="cb112" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb112-1" title="1"><span class="co"># run</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="ex">dpkg-reconfigure</span> keyboard-configuration</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="co"># or</span></a>
<a class="sourceLine" id="cb112-4" title="4"><span class="co"># edit /etc/default/keyboard:</span></a>
<a class="sourceLine" id="cb112-5" title="5"><span class="co">#   change XKBLAYOUT=&quot;us,de,fr,ua,ru&quot; by &quot;us&quot; for example</span></a>
<a class="sourceLine" id="cb112-6" title="6"></a>
<a class="sourceLine" id="cb112-7" title="7"><span class="co"># for changes to take effect:</span></a>
<a class="sourceLine" id="cb112-8" title="8"><span class="ex">service</span> keyboard-setup restart</a>
<a class="sourceLine" id="cb112-9" title="9"></a>
<a class="sourceLine" id="cb112-10" title="10"><span class="co"># it should suffice, but if not:</span></a>
<a class="sourceLine" id="cb112-11" title="11"><span class="ex">udevadm</span> trigger --subsystem-match=input --action=change</a></code></pre></div>
<p><a href="https://wiki.debian.org/Keyboard">https://wiki.debian.org/Keyboard</a></p></li>
<li><p>change text mode resolution?</p></li>
<li><p>paste example?</p>
<div class="sourceCode" id="cb113" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb113-1" title="1">$ <span class="ex">paste</span> <span class="op">&lt;(</span><span class="fu">seq</span> 1 3<span class="op">)</span> <span class="op">&lt;(</span><span class="fu">seq</span> 1 3<span class="op">)</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="ex">1</span>       1</a>
<a class="sourceLine" id="cb113-3" title="3"><span class="ex">2</span>       2</a>
<a class="sourceLine" id="cb113-4" title="4"><span class="ex">3</span>       3</a></code></pre></div></li>
<li><p>show which key is pressed?</p>
<div class="sourceCode" id="cb114" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb114-1" title="1"></a></code></pre></div></li>
<li><p>get the number of rows and colums?</p>
<div class="sourceCode" id="cb115" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb115-1" title="1"><span class="ex">tput</span> lines</a>
<a class="sourceLine" id="cb115-2" title="2"><span class="ex">tput</span> cols</a></code></pre></div></li>
<li><p>Presentation conventions</p>
<ol class="incremental">
<li><p>display a command line?</p>
<div class="sourceCode" id="cb116" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">`</span><span class="ex">npm</span> install -g jsonresume-theme-kendall<span class="kw">`</span></a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="io">Io</h3>
<ol class="incremental">
<li><p>Disk</p>
<ol class="incremental">
<li><p>list files open by a particular process</p>
<div class="sourceCode" id="cb117" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb117-1" title="1"><span class="ex">lsof</span> -u jenkins <span class="kw">|</span> <span class="op">&lt;</span><span class="ex">grep/cut</span>/<span class="ex">jq</span><span class="op">&gt;</span></a></code></pre></div></li>
<li><p>how to do a simple bind mount?</p>
<div class="sourceCode" id="cb118" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># with mount cmd:</span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="fu">mount</span> --bind /src/path /dst/path</a>
<a class="sourceLine" id="cb118-3" title="3"></a>
<a class="sourceLine" id="cb118-4" title="4"><span class="co"># with /etc/fstab:</span></a>
<a class="sourceLine" id="cb118-5" title="5"><span class="ex">/src/path</span> /dst/path none defaults,bind 0 0</a></code></pre></div></li>
<li><p>Disks</p>
<ol class="incremental">
<li><p>Disks caches</p>
<ol class="incremental">
<li><p>how do I clear the disk caches in Linux?</p>
<p>From <a href="https://www.tecmint.com/clear-ram-memory-cache-buffer-and-swap-space-on-linux/">https://www.tecmint.com/clear-ram-memory-cache-buffer-and-swap-space-on-linux/</a></p>
<div class="sourceCode" id="cb119" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb119-1" title="1"><span class="co"># clear PageCache only</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="fu">sync</span><span class="kw">;</span> <span class="bu">echo</span> 1 <span class="op">&gt;</span> /proc/sys/vm/drop_caches</a>
<a class="sourceLine" id="cb119-3" title="3"><span class="co"># clear dentries and inodes</span></a>
<a class="sourceLine" id="cb119-4" title="4"><span class="fu">sync</span><span class="kw">;</span> <span class="bu">echo</span> 2 <span class="op">&gt;</span> /proc/sys/vm/drop_caches</a>
<a class="sourceLine" id="cb119-5" title="5"><span class="co"># clear page cache, dentries and inodes (not on production!)</span></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="fu">sync</span><span class="kw">;</span> <span class="bu">echo</span> 3 <span class="op">&gt;</span> /proc/sys/vm/drop_caches</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Images</p>
<ol class="incremental">
<li><p>Copy an img file to a disk with bad blocks?</p>
<div class="sourceCode" id="cb120" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb120-1" title="1"><span class="fu">sudo</span> ddrescue  -r3 2020-08-20-raspios-buster-armhf-full.img -d -f /dev/sdX ddrescuemapfile</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>RemoteFs</p>
<ol class="incremental">
<li><p>nfs</p>
<ol class="incremental">
<li><p>How to mount a remote nfs drive on a linux host?</p>
<div class="sourceCode" id="cb121" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb121-1" title="1"><span class="fu">mount</span> -t nfs <span class="dt">{remote_pc_address}</span>:/remote/dir /some/local/dir</a></code></pre></div></li>
<li><p>List all nfs share of a remote nfs server?</p>
<div class="sourceCode" id="cb122" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb122-1" title="1"><span class="ex">showmount</span> my.nfs.server.com</a></code></pre></div>
<p>Can be found in package (on debian like): <code>nfs-common</code></p></li>
</ol></li>
</ol></li>
<li><p>VirtualFs</p>
<ol class="incremental">
<li><p>How to get the load with /proc?</p>
<div class="sourceCode" id="cb123" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb123-1" title="1"><span class="fu">cat</span> /proc/loadavg</a></code></pre></div></li>
</ol></li>
<li><p>Processes</p>
<ol class="incremental">
<li><p>How to find how are connected by pipes running processes?</p>
<div class="sourceCode" id="cb124" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb124-1" title="1"><span class="co"># draft - draft - draft - draft - draft - draft - draft - draft - draft - draft -</span></a>
<a class="sourceLine" id="cb124-2" title="2"><span class="fu">seq</span> Infinity <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/^/&gt; /&#39;</span> <span class="kw">|</span> <span class="ex">pv</span> -qlL1 <span class="op">&gt;</span> /tmp/o</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="co">#&gt; ^Z</span></a>
<a class="sourceLine" id="cb124-4" title="4"><span class="co">#&gt; [1]+  Stopped                 seq Infinity | sed -r &#39;s/^/&gt; /&#39; | pv -qlL1 &gt; /tmp/o</span></a>
<a class="sourceLine" id="cb124-5" title="5"><span class="bu">bg</span></a>
<a class="sourceLine" id="cb124-6" title="6"><span class="co">#&gt; [1]+ seq Infinity | sed -r &#39;s/^/&gt; /&#39; | pv -qlL1 &gt; /tmp/o &amp;</span></a>
<a class="sourceLine" id="cb124-7" title="7"><span class="fu">tail</span> -f /tmp/o</a>
<a class="sourceLine" id="cb124-8" title="8"><span class="co">#&gt; &gt; 1</span></a>
<a class="sourceLine" id="cb124-9" title="9"><span class="co">#&gt; &gt; 2</span></a>
<a class="sourceLine" id="cb124-10" title="10"><span class="co">#&gt; ^C</span></a>
<a class="sourceLine" id="cb124-11" title="11"><span class="bu">declare</span> <span class="va">pRe</span> <span class="kw">&amp;&amp;</span> <span class="va">pRe=</span><span class="st">&quot;</span><span class="va">$(</span><span class="ex">pgrep</span> -fa <span class="st">&#39;(seq|pv|sed)&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> -f1 -d<span class="st">&#39; &#39;</span> <span class="kw">|</span> <span class="fu">xargs</span> <span class="kw">|</span> <span class="fu">sed</span> -r -e <span class="st">&#39;s/ /|/g&#39;</span> -e <span class="st">&#39;s/.*/(&amp;1)/&#39;</span><span class="va">)</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb124-12" title="12"><span class="ex">lsof</span>  <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&quot;</span><span class="va">$pRe</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">egrep</span> -v <span class="st">&#39;^(lsof|grep)&#39;</span> <span class="kw">|</span>  <span class="fu">egrep</span> <span class="st">&#39;(^C|FIFO)&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> -s <span class="st">&#39; &#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39; &#39;</span> <span class="st">&#39;\t&#39;</span> <span class="kw">|</span> <span class="fu">cut</span> -f 1,2,4,8,9 <span class="kw">|</span> <span class="fu">sort</span> -k 4,3 <span class="kw">|</span> <span class="ex">jq</span> -R . <span class="kw">|</span> <span class="ex">jq</span> -s <span class="st">&#39;. | map(split(&quot;\t&quot;)) &#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -cr <span class="st">&#39;sort_by(.[3],.[2]) | group_by(.[3])&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -cr <span class="st">&#39;.[] | select(length == 2)  | (.[0][0]) as $p1 | (.[1][0]) as $p2 | &quot;\($p2) -&gt; \($p1)&quot;&#39;</span></a>
<a class="sourceLine" id="cb124-13" title="13"><span class="co">#&gt; seq -&gt; sed</span></a>
<a class="sourceLine" id="cb124-14" title="14"><span class="co">#&gt; sed -&gt; pv</span></a>
<a class="sourceLine" id="cb124-15" title="15"><span class="co"># draft - draft - draft - draft - draft - draft - draft - draft - draft - draft -</span></a></code></pre></div></li>
<li><p>Autossh</p>
<ol class="incremental">
<li><p>How to keep a ssh sesssion open with autossh?</p>
<p>Exemple from: <a href="https://wiki.gentoo.org/wiki/Autossh">https://wiki.gentoo.org/wiki/Autossh</a></p>
<div class="sourceCode" id="cb125" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb125-1" title="1"><span class="co"># ssh on port 222, setup a sock proxy on port 999</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="ex">autossh</span>                         \</a>
<a class="sourceLine" id="cb125-3" title="3">    -M 0                        \</a>
<a class="sourceLine" id="cb125-4" title="4">    -p 222                      \</a>
<a class="sourceLine" id="cb125-5" title="5">    -N                          \</a>
<a class="sourceLine" id="cb125-6" title="6">    -D 9999                     \</a>
<a class="sourceLine" id="cb125-7" title="7">    -o <span class="st">&quot;ServerAliveInterval 45&quot;</span> \</a>
<a class="sourceLine" id="cb125-8" title="8">    -o <span class="st">&quot;ServerAliveCountMax 2&quot;</span> username@myserver</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol>
<h3 id="bash">Bash</h3>
<ol class="incremental">
<li><p>Non interactive</p>
<ol class="incremental">
<li><p>Use alises in non interactive bash?</p>
<div class="sourceCode" id="cb126" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb126-1" title="1"><span class="bu">shopt</span> <span class="kw">|</span> <span class="fu">egrep</span> expand_aliases</a>
<a class="sourceLine" id="cb126-2" title="2"><span class="co">#&gt; expand_aliases  off</span></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="bu">shopt</span> -s expand_aliases</a>
<a class="sourceLine" id="cb126-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb126-5" title="5"><span class="bu">shopt</span> <span class="kw">|</span> <span class="fu">egrep</span> expand_aliases</a>
<a class="sourceLine" id="cb126-6" title="6"><span class="ex">expand_aliases</span>  on</a></code></pre></div></li>
</ol></li>
<li><p>Interactive use</p>
<ol class="incremental">
<li><p>Complete</p>
<ol class="incremental">
<li><p>bash completion cheat sheet?</p>
<table>
<thead>
<tr class="header">
<th>complete on</th>
<th>cmd</th>
<th>options</th>
<th></th>
<th></th>
<th>for what?</th>
<th>short form</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>remove</td>
<td><code>complete</code></td>
<td><code>-r</code></td>
<td></td>
<td></td>
<td>all</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><code>complete</code></td>
<td><code>-r</code></td>
<td></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>complete on alias names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>alias</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-a</code></td>
</tr>
<tr class="even">
<td>array variable names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>arrayvar</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>readline key binding names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>binding</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>names of shell builtin commands</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>builtin</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-b</code></td>
</tr>
<tr class="odd">
<td>command names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>command</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>directory names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>directory</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-d</code></td>
</tr>
<tr class="odd">
<td>disabled shell builtins</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>disabled</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>enabled shell builtins</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>enabled</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>names of exported shell variables</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>export</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-e</code></td>
</tr>
<tr class="even">
<td>file names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>file</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-f</code></td>
</tr>
<tr class="odd">
<td>names of shell functions</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>function</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>group names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>group</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-g</code></td>
</tr>
<tr class="odd">
<td>help topics accepted by the help builtin</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>helptopic</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>hostnames as taken from the file specifed by the HOSTFILE shell variable</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>hostname</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>job names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>job</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-j</code></td>
</tr>
<tr class="even">
<td>shell reserved words</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>keyword</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-k</code></td>
</tr>
<tr class="odd">
<td>names of running jobs</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>running</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>service names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>service</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>valid args for the -o option of the set builtin</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>setopt</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>shell option names as accepted by the shopt builtin</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>shopt</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>signal names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>signal</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="even">
<td>names of stopped jobs</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>stopped</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td></td>
</tr>
<tr class="odd">
<td>user names</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>user</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-u</code></td>
</tr>
<tr class="even">
<td>names of all shell variables</td>
<td><code>complete</code></td>
<td><code>-A</code></td>
<td><code>variable</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>cmd1 … cmdN</code></td>
<td><code>-v</code></td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol></li>
<li><p>Common tasks</p>
<ol class="incremental">
<li><p>Random</p>
<ol class="incremental">
<li><p>Generate a lot of (pseudo) random data faster than /dev/urandom?</p>
<pre><code>openssl enc -aes-256-ctr -pass pass:&quot;$(head -c128 /dev/urandom | base64)&quot; -nosalt &lt; /dev/zero | pv &gt; randomfile.bin
</code></pre></li>
</ol></li>
<li><p>generate random string?</p>
<div class="sourceCode" id="cb128" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb128-1" title="1"><span class="co">#!/bin/bash</span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="co"># bash generate random alphanumeric string</span></a>
<a class="sourceLine" id="cb128-3" title="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb128-4" title="4"></a>
<a class="sourceLine" id="cb128-5" title="5"><span class="co"># bash generate random 32 character alphanumeric string (upper and lowercase) and</span></a>
<a class="sourceLine" id="cb128-6" title="6"><span class="va">NEW_UUID=$(</span><span class="fu">cat</span> /dev/urandom <span class="kw">|</span> <span class="fu">tr</span> -dc <span class="st">&#39;a-zA-Z0-9&#39;</span> <span class="kw">|</span> <span class="ex">fold</span> -w 32 <span class="kw">|</span> <span class="fu">head</span> -n 1<span class="va">)</span></a>
<a class="sourceLine" id="cb128-7" title="7"></a>
<a class="sourceLine" id="cb128-8" title="8"><span class="co"># bash generate random 32 character alphanumeric string (lowercase only)</span></a>
<a class="sourceLine" id="cb128-9" title="9"><span class="fu">cat</span> /dev/urandom <span class="kw">|</span> <span class="fu">tr</span> -dc <span class="st">&#39;a-zA-Z0-9&#39;</span> <span class="kw">|</span> <span class="ex">fold</span> -w 32 <span class="kw">|</span> <span class="fu">head</span> -n 1</a>
<a class="sourceLine" id="cb128-10" title="10"></a>
<a class="sourceLine" id="cb128-11" title="11"><span class="co"># Random numbers in a range, more randomly distributed than $RANDOM which is not</span></a>
<a class="sourceLine" id="cb128-12" title="12"><span class="co"># very random in terms of distribution of numbers.</span></a>
<a class="sourceLine" id="cb128-13" title="13"></a>
<a class="sourceLine" id="cb128-14" title="14"><span class="co"># bash generate random number between 0 and 9</span></a>
<a class="sourceLine" id="cb128-15" title="15"><span class="fu">cat</span> /dev/urandom <span class="kw">|</span> <span class="fu">tr</span> -dc <span class="st">&#39;0-9&#39;</span> <span class="kw">|</span> <span class="ex">fold</span> -w 256 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">head</span> --bytes 1</a>
<a class="sourceLine" id="cb128-16" title="16"></a>
<a class="sourceLine" id="cb128-17" title="17"><span class="co"># bash generate random number between 0 and 99</span></a>
<a class="sourceLine" id="cb128-18" title="18"><span class="va">NUMBER=$(</span><span class="fu">cat</span> /dev/urandom <span class="kw">|</span> <span class="fu">tr</span> -dc <span class="st">&#39;0-9&#39;</span> <span class="kw">|</span> <span class="ex">fold</span> -w 256 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">sed</span> -e <span class="st">&#39;s/^0*//&#39;</span> <span class="kw">|</span> <span class="fu">head</span> --bytes 2<span class="va">)</span></a>
<a class="sourceLine" id="cb128-19" title="19"><span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$NUMBER</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb128-20" title="20">  <span class="va">NUMBER=</span>0</a>
<a class="sourceLine" id="cb128-21" title="21"><span class="kw">fi</span></a>
<a class="sourceLine" id="cb128-22" title="22"></a>
<a class="sourceLine" id="cb128-23" title="23"><span class="co"># bash generate random number between 0 and 999</span></a>
<a class="sourceLine" id="cb128-24" title="24"><span class="va">NUMBER=$(</span><span class="fu">cat</span> /dev/urandom <span class="kw">|</span> <span class="fu">tr</span> -dc <span class="st">&#39;0-9&#39;</span> <span class="kw">|</span> <span class="ex">fold</span> -w 256 <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">sed</span> -e <span class="st">&#39;s/^0*//&#39;</span> <span class="kw">|</span> <span class="fu">head</span> --bytes 3<span class="va">)</span></a>
<a class="sourceLine" id="cb128-25" title="25"><span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$NUMBER</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb128-26" title="26">  <span class="va">NUMBER=</span>0</a>
<a class="sourceLine" id="cb128-27" title="27"><span class="kw">fi</span></a></code></pre></div>
<p><a href="https://gist.github.com/earthgecko/3089509">https://gist.github.com/earthgecko/3089509</a></p></li>
<li><p>decimal / hex (and opposite) conversion?</p>
<div class="sourceCode" id="cb129" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb129-1" title="1"><span class="co"># decimal to hex</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="bu">echo</span> <span class="st">&quot;obase=16; 34&quot;</span> <span class="kw">|</span> <span class="fu">bc</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="co"># hex to decimal</span></a>
<a class="sourceLine" id="cb129-4" title="4"> <span class="bu">echo</span> <span class="va">$((</span>0xa<span class="va">))</span></a>
<a class="sourceLine" id="cb129-5" title="5"> <span class="co"># 10</span></a></code></pre></div></li>
<li><p>redirect output in variable?</p>
<p>"must read" about the differents techniques of redirection: <a href="http://stackoverflow.com/questions/13763942/bash-why-piping-input-to-read-only-works-when-fed-into-while-read-const">http://stackoverflow.com/questions/13763942/bash-why-piping-input-to-read-only-works-when-fed-into-while-read-const</a></p></li>
<li><p>stop on error (even in subshell)?</p>
<p>It seems that bash disable -e in subshells. A workaround: set -e explicitly at the start of each subshell</p></li>
<li><p>loop over args?</p>
<div class="sourceCode" id="cb130" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">for</span> <span class="ex">var</span> in <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">do</span></a>
<a class="sourceLine" id="cb130-3" title="3">  <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$var</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="kw">done</span></a></code></pre></div>
<p><a href="http://stackoverflow.com/questions/255898/how-to-iterate-over-arguments-in-a-bash-script">http://stackoverflow.com/questions/255898/how-to-iterate-over-arguments-in-a-bash-script</a></p></li>
<li><p>parse a string as args</p>
<div class="sourceCode" id="cb131" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb131-1" title="1"><span class="ex">How</span> to process the following list of pairs: <span class="st">&quot;Mercury 36&quot;</span> <span class="st">&quot;Venus 67&quot;</span> <span class="st">&quot;Earth 93&quot;</span>  <span class="st">&quot;Mars 142&quot;</span> <span class="st">&quot;Jupiter 483&quot;</span>?</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">(</span><span class="ex">note</span> no =IFS= set<span class="kw">)</span></a>
<a class="sourceLine" id="cb131-3" title="3"><span class="co">#+begin_src sh</span></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co">#!/usr/bin/env bash</span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="kw">set</span> <span class="ex">-euo</span> pipefail</a>
<a class="sourceLine" id="cb131-6" title="6"></a>
<a class="sourceLine" id="cb131-7" title="7"><span class="kw">for</span> <span class="ex">planet</span> in <span class="st">&quot;Mercury 36&quot;</span> <span class="st">&quot;Venus 67&quot;</span></a>
<a class="sourceLine" id="cb131-8" title="8"><span class="kw">do</span></a>
<a class="sourceLine" id="cb131-9" title="9">  <span class="kw">set</span> <span class="ex">--</span> <span class="va">$planet</span></a>
<a class="sourceLine" id="cb131-10" title="10">  <span class="bu">echo</span> <span class="st">&quot;</span><span class="dt">\$</span><span class="st">1=</span><span class="va">$1</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb131-11" title="11">  <span class="bu">echo</span> <span class="st">&quot;</span><span class="dt">\$</span><span class="st">2=</span><span class="va">$2</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb131-12" title="12"><span class="kw">done</span></a>
<a class="sourceLine" id="cb131-13" title="13"><span class="co"># outputs</span></a>
<a class="sourceLine" id="cb131-14" title="14"><span class="co">#</span></a>
<a class="sourceLine" id="cb131-15" title="15"><span class="co"># $1=Mercury</span></a>
<a class="sourceLine" id="cb131-16" title="16"><span class="co"># $2=36</span></a>
<a class="sourceLine" id="cb131-17" title="17"><span class="co"># $1=Venus</span></a>
<a class="sourceLine" id="cb131-18" title="18"><span class="co"># $2=67</span></a></code></pre></div></li>
<li><p>How to save a script params (before doing modifications like shift, ..)?</p>
<div class="sourceCode" id="cb132" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># save with</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="va">original_params=(</span><span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span><span class="va">)</span></a>
<a class="sourceLine" id="cb132-3" title="3"><span class="co"># use the copy with</span></a>
<a class="sourceLine" id="cb132-4" title="4"><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${original_params[@]}</span><span class="st">&quot;</span></a></code></pre></div></li>
<li><p>generate uuid?</p>
<div class="sourceCode" id="cb133" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb133-1" title="1"><span class="fu">cat</span> /proc/sys/kernel/random/uuid</a>
<a class="sourceLine" id="cb133-2" title="2"><span class="co">#&gt; aa6bc854-9eab-43cd-986d-d2318bf4a845</span></a></code></pre></div></li>
<li><p>List all possible commands (including functions)?</p>
<div class="sourceCode" id="cb134" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># also works for zsh</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="bu">compgen</span> -c</a></code></pre></div></li>
</ol></li>
<li><p>Programming</p>
<ol class="incremental">
<li><p>Misc</p>
<ol class="incremental">
<li><p>bash pointer variables?</p></li>
</ol></li>
<li><p>Control flow</p>
<ol class="incremental">
<li><p>Tests/Conditionnals</p>
<ol class="incremental">
<li><p>ternary operator in bash?</p>
<div class="sourceCode" id="cb135" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb135-1" title="1"><span class="fu">bash</span> -c <span class="st">&#39;b=5 c=2 &amp;&amp; d=3 &amp;&amp; let a=b==5?c:d; echo $a&#39;</span></a></code></pre></div></li>
<li><p>cheatsheet</p>
<table>
<tbody>
<tr class="odd">
<td>file</td>
<td>is empty</td>
<td><code>[ -s a ]</code></td>
<td>single brackets</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></li>
<li><p>test files cheatsheet</p>
<p>from: <a href="https://wiki-dev.bash-hackers.org/commands/classictest">https://wiki-dev.bash-hackers.org/commands/classictest</a> <strong>For classic test <code>[ &lt;..&gt; ]</code></strong></p>
<table>
<thead>
<tr class="header">
<th>Operator syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-a &lt;FILE&gt;</td>
<td>True if &lt;FILE&gt; exists. :!: (not recommended, may collide with -a for AND, see below)</td>
</tr>
<tr class="even">
<td>-e &lt;FILE&gt;</td>
<td>True if &lt;FILE&gt; exists.</td>
</tr>
<tr class="odd">
<td>-f &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a regular file.</td>
</tr>
<tr class="even">
<td>-d &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a directory.</td>
</tr>
<tr class="odd">
<td>-c &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a character special file.</td>
</tr>
<tr class="even">
<td>-b &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a block special file.</td>
</tr>
<tr class="odd">
<td>-p &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a named pipe (FIFO).</td>
</tr>
<tr class="even">
<td>-S &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a socket file.</td>
</tr>
<tr class="odd">
<td>-L &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a symbolic link.</td>
</tr>
<tr class="even">
<td>-h &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is a symbolic link.</td>
</tr>
<tr class="odd">
<td>-g &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and has sgid bit set.</td>
</tr>
<tr class="even">
<td>-u &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and has suid bit set.</td>
</tr>
<tr class="odd">
<td>-r &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is readable.</td>
</tr>
<tr class="even">
<td>-w &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is writable.</td>
</tr>
<tr class="odd">
<td>-x &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and is executable.</td>
</tr>
<tr class="even">
<td>-s &lt;FILE&gt;</td>
<td>True, if &lt;FILE&gt; exists and has size bigger than 0 (not empty).</td>
</tr>
<tr class="odd">
<td>-t &lt;fd&gt;</td>
<td>True, if file descriptor &lt;fd&gt; is open and refers to a terminal.</td>
</tr>
<tr class="even">
<td>&lt;FILE1&gt; -nt &lt;FILE2&gt;</td>
<td>True, if &lt;FILE1&gt; is newer than &lt;FILE2&gt; (mtime). :!:</td>
</tr>
<tr class="odd">
<td>&lt;FILE1&gt; -ot &lt;FILE2&gt;</td>
<td>True, if &lt;FILE1&gt; is older than &lt;FILE2&gt; (mtime). :!:</td>
</tr>
<tr class="even">
<td>&lt;FILE1&gt; -ef &lt;FILE2&gt;</td>
<td>True, if &lt;FILE1&gt; and &lt;FILE2&gt; refer to the same device and inode numbers. :!:</td>
</tr>
</tbody>
</table></li>
</ol></li>
<li><p>Looping</p>
<ol class="incremental">
<li><p>loop over cmd output with while?</p>
<div class="sourceCode" id="cb136" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb136-1" title="1"><span class="ex">iseq</span> 3 <span class="kw">|</span> <span class="kw">while</span> <span class="bu">read</span> <span class="va">l</span>; <span class="kw">do</span> <span class="bu">echo</span> <span class="st">&quot;&gt;</span><span class="va">$l</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="co">#&gt; &gt;1</span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="co">#&gt; &gt;2</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="co">#&gt; &gt;3</span></a></code></pre></div></li>
<li><p>c style for loop?</p>
<div class="sourceCode" id="cb137" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">for</span> <span class="kw">((</span>i=0;i&lt;3;i++<span class="kw">))</span>; <span class="kw">do</span></a>
<a class="sourceLine" id="cb137-2" title="2">  <span class="bu">echo</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="kw">done</span></a></code></pre></div></li>
</ol></li>
<li><p>switch case ?</p>
<div class="sourceCode" id="cb138" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">while [[</span> <span class="va">$#</span> <span class="ot">-gt</span> 0<span class="kw"> ]]</span>; <span class="kw">do</span></a>
<a class="sourceLine" id="cb138-2" title="2">    <span class="kw">case</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span><span class="kw"> in</span></a>
<a class="sourceLine" id="cb138-3" title="3">        *:*          <span class="kw">)</span> <span class="va">hostport=(${1//</span>:<span class="va">/</span> <span class="va">})</span>; <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-4" title="4">             <span class="ex">--child</span> ) <span class="va">CHILD=</span>1             ; <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-5" title="5">        <span class="ex">-q</span> <span class="kw">|</span> <span class="ex">--quiet</span> ) <span class="va">QUIET=</span>1             ; <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-6" title="6">        <span class="ex">-s</span> <span class="kw">|</span> <span class="ex">--strict</span>) <span class="va">STRICT=</span>1            ; <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-7" title="7">        <span class="ex">--host</span>=*     ) <span class="va">HOST=</span><span class="st">&quot;</span><span class="va">${1#</span>*=<span class="va">}</span><span class="st">&quot;</span>      ; <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-8" title="8">        <span class="ex">--help</span>       ) <span class="ex">usage</span>               <span class="kw">;</span> <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-9" title="9">        <span class="ex">*</span>            ) <span class="ex">unknownArg</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span>     <span class="kw">;</span> <span class="bu">shift</span> 1 <span class="kw">;;</span></a>
<a class="sourceLine" id="cb138-10" title="10">    <span class="kw">esac</span></a>
<a class="sourceLine" id="cb138-11" title="11"><span class="kw">done</span></a></code></pre></div></li>
</ol></li>
<li><p>Types</p>
<ol class="incremental">
<li><p>Datastructures</p>
<ol class="incremental">
<li><p>Arrays</p>
<ol class="incremental">
<li><p>Associative arrays</p>
<ol class="incremental">
<li><p>declare, print, …</p>
<div class="sourceCode" id="cb139" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb139-1" title="1"><span class="co"># declare</span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="bu">declare</span> -A <span class="va">m=(</span> <span class="va">[red]=</span><span class="st">&#39;0;31&#39;</span> <span class="va">[green]=</span><span class="st">&#39;0;32&#39;</span> <span class="va">)</span></a>
<a class="sourceLine" id="cb139-3" title="3"><span class="co"># print keys</span></a>
<a class="sourceLine" id="cb139-4" title="4"><span class="bu">echo</span> <span class="st">&quot;keys=</span><span class="va">${!m[@]}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb139-5" title="5"><span class="co"># print all</span></a>
<a class="sourceLine" id="cb139-6" title="6"><span class="bu">declare</span> <span class="kw">|</span> <span class="fu">grep</span> colorsCodes</a>
<a class="sourceLine" id="cb139-7" title="7"><span class="co"># iterate</span></a>
<a class="sourceLine" id="cb139-8" title="8"><span class="kw">for</span> <span class="ex">i</span> in <span class="st">&quot;</span><span class="va">${!array[@]}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb139-9" title="9"><span class="kw">do</span></a>
<a class="sourceLine" id="cb139-10" title="10">  <span class="bu">echo</span> <span class="st">&quot;key  : </span><span class="va">$i</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb139-11" title="11">  <span class="bu">echo</span> <span class="st">&quot;value: </span><span class="va">${array[$i]}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb139-12" title="12"><span class="kw">done</span></a></code></pre></div></li>
<li><p>copy ?</p>
<div class="sourceCode" id="cb140" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb140-1" title="1"><span class="bu">declare</span> -A <span class="va">arr=([this]=</span>hello <span class="va">[</span><span class="dt">\&#39;</span><span class="va">that</span><span class="dt">\&#39;</span><span class="va">]=</span>world <span class="va">[theother]=</span><span class="st">&#39;and &quot;goodbye&quot;!&#39;</span><span class="va">)</span></a>
<a class="sourceLine" id="cb140-2" title="2"><span class="bu">declare</span> -A <span class="va">newarr</span></a>
<a class="sourceLine" id="cb140-3" title="3"><span class="kw">for</span> <span class="ex">idx</span> in <span class="st">&quot;</span><span class="va">${!arr[@]}</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb140-4" title="4">    <span class="va">newarr[$idx]=${arr[$idx]}</span></a>
<a class="sourceLine" id="cb140-5" title="5"><span class="kw">done</span></a>
<a class="sourceLine" id="cb140-6" title="6"></a>
<a class="sourceLine" id="cb140-7" title="7"><span class="fu">diff</span> <span class="op">&lt;(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$temp</span><span class="st">&quot;</span><span class="op">)</span> <span class="op">&lt;(</span><span class="bu">declare</span> -p <span class="va">newarr</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/newarr=/arr=/&#39;</span><span class="op">)</span></a>
<a class="sourceLine" id="cb140-8" title="8"><span class="co"># no output</span></a></code></pre></div>
<p><a href="http://stackoverflow.com/questions/19417015/bash-copy-from-one-array-to-another">http://stackoverflow.com/questions/19417015/bash-copy-from-one-array-to-another</a></p></li>
</ol></li>
<li><p>Normal arrays</p>
<ol class="incremental">
<li><p>declare/literal/set/getAll/size</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># declare</span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="bu">declare</span> -a <span class="va">a</span></a>
<a class="sourceLine" id="cb141-3" title="3"><span class="co"># literal</span></a>
<a class="sourceLine" id="cb141-4" title="4"><span class="va">a=(</span>a b c<span class="va">)</span></a>
<a class="sourceLine" id="cb141-5" title="5"><span class="co"># set</span></a>
<a class="sourceLine" id="cb141-6" title="6"><span class="va">a[0]=</span>x</a>
<a class="sourceLine" id="cb141-7" title="7"><span class="co"># get all</span></a>
<a class="sourceLine" id="cb141-8" title="8"><span class="bu">echo</span> <span class="va">${a[*]}</span></a>
<a class="sourceLine" id="cb141-9" title="9"><span class="co"># size</span></a>
<a class="sourceLine" id="cb141-10" title="10"><span class="bu">echo</span> <span class="st">&quot;size=</span><span class="va">${#a[@]}</span><span class="st">&quot;</span></a></code></pre></div></li>
<li><p>access empty array?</p>
<div class="sourceCode" id="cb142" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb142-1" title="1"><span class="bu">declare</span> -a <span class="va">a=()</span></a>
<a class="sourceLine" id="cb142-2" title="2"><span class="bu">echo</span> -n a=</a>
<a class="sourceLine" id="cb142-3" title="3"><span class="bu">echo</span> <span class="va">${a[@} + </span><span class="st">&quot;</span><span class="va">${a[@]}</span><span class="st">&quot;</span><span class="va">}</span></a></code></pre></div></li>
<li><p>parse string to array?</p>
<div class="sourceCode" id="cb143" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb143-1" title="1"><span class="va">IFS=</span><span class="st">&#39;, &#39;</span> <span class="bu">read</span> -r -a <span class="va">array</span> <span class="op">&lt;&lt;&lt;</span> <span class="st">&quot;a, b, c&quot;</span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="bu">echo</span> <span class="st">&quot;array=</span><span class="va">${array[@]}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb143-3" title="3"><span class="co">#&gt; array=a b c</span></a></code></pre></div></li>
<li><p>clone an array into another array?</p>
<div class="sourceCode" id="cb144" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb144-1" title="1"><span class="fu">show()</span> <span class="kw">{</span> <span class="bu">declare</span> <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&quot;^</span><span class="va">${1}</span><span class="st">=&quot;</span> <span class="kw">;</span> <span class="kw">}</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="co"># declare array a1</span></a>
<a class="sourceLine" id="cb144-3" title="3"><span class="bu">declare</span> -a <span class="va">a1=(</span> a b <span class="va">)</span></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="ex">show</span> a1</a>
<a class="sourceLine" id="cb144-5" title="5"><span class="co">#&gt; a1=([0]=&quot;a&quot; [1]=&quot;b&quot;)</span></a>
<a class="sourceLine" id="cb144-6" title="6"><span class="bu">declare</span> -a <span class="va">a2=(</span><span class="st">&quot;</span><span class="va">${a1[@]}</span><span class="st">&quot;</span><span class="va">)</span></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="ex">show</span> a2</a>
<a class="sourceLine" id="cb144-8" title="8"><span class="co">#&gt; a2=([0]=&quot;a&quot; [1]=&quot;b&quot;)</span></a>
<a class="sourceLine" id="cb144-9" title="9"><span class="co"># verify it is a clone</span></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="va">a2[0]=</span>x</a>
<a class="sourceLine" id="cb144-11" title="11"><span class="ex">show</span> a2</a>
<a class="sourceLine" id="cb144-12" title="12"><span class="co">#&gt; a2=([0]=&quot;x&quot; [1]=&quot;b&quot;)</span></a>
<a class="sourceLine" id="cb144-13" title="13"><span class="ex">show</span> a1</a>
<a class="sourceLine" id="cb144-14" title="14"><span class="co">#&gt; a1=([0]=&quot;a&quot; [1]=&quot;b&quot;)</span></a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>Strings</p>
<ol class="incremental">
<li><p>bash strings cheat sheet?</p>
<table>
<thead>
<tr class="header">
<th>what</th>
<th>how</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>size</td>
<td><code>${#str}</code></td>
<td></td>
</tr>
<tr class="even">
<td>substring</td>
<td><code>${str:pos}</code></td>
<td></td>
</tr>
<tr class="odd">
<td>substring</td>
<td><code>${str:pos:length}</code></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>char to int</td>
<td><code>printf '%d\n' "'y"</code></td>
<td></td>
</tr>
<tr class="even">
<td>int to char</td>
<td><code>printf "\x$(printf %x 65)"</code></td>
<td></td>
</tr>
<tr class="odd">
<td>replace all</td>
<td><code>bash -c 'x=abcabc; echo ${x//b/z} # axcaxc</code></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></li>
<li><p>Syntax</p>
<ol class="incremental">
<li><p>ssh escape sequence?</p>
<p><code>ENTER, ~, .</code></p></li>
</ol></li>
<li><p>Printf?</p>
<ol class="incremental">
<li><p>print args, one by line with its position?</p>
<p>from: <a href="http://wiki.bash-hackers.org/commands/builtin/printf">http://wiki.bash-hackers.org/commands/builtin/printf</a></p>
<div class="sourceCode" id="cb145" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb145-1" title="1"><span class="bu">printf</span> <span class="st">&#39;&quot;%b&quot;\n&#39;</span> <span class="st">&quot;</span><span class="va">$0</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">nl</span> -v0 -s<span class="st">&quot;: &quot;</span></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="co">#&gt; 0: &quot;-zsh&quot;</span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="co">#&gt; 1: &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb145-4" title="4"><span class="co">#&gt; 2: &quot;bar&quot;</span></a></code></pre></div></li>
<li><p>print a line accross the terminal?</p>
<p>from: <a href="http://wiki.bash-hackers.org/commands/builtin/printf">http://wiki.bash-hackers.org/commands/builtin/printf</a></p>
<div class="sourceCode" id="cb146" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb146-1" title="1"><span class="fu">bash</span> -c <span class="st">&quot;l=</span><span class="va">$(</span><span class="ex">tput</span> cols<span class="va">)</span><span class="st">&quot;&#39; &amp;&amp; printf -v line &quot;%*s&quot; $l &amp;&amp; echo ${line// /-}&#39;</span></a>
<a class="sourceLine" id="cb146-2" title="2"><span class="co">#&gt; --------------------------------------------------------------------------------</span></a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>Bash options</p>
<ol class="incremental">
<li><p>How to get the values of errexit etc (set by set -e …)?</p>
<div class="sourceCode" id="cb147" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">set</span> <span class="ex">-o</span></a>
<a class="sourceLine" id="cb147-2" title="2"><span class="co">#&gt; allexport       off</span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co">#&gt; braceexpand     on</span></a>
<a class="sourceLine" id="cb147-4" title="4"><span class="co">#&gt; emacs           on</span></a>
<a class="sourceLine" id="cb147-5" title="5"><span class="co">#&gt; errexit         off</span></a>
<a class="sourceLine" id="cb147-6" title="6"><span class="co">#&gt; errtrace        off</span></a></code></pre></div></li>
<li><p>option so bash export all declared variables?</p>
<div class="sourceCode" id="cb148" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb148-1" title="1"><span class="va">a=</span>1</a>
<a class="sourceLine" id="cb148-2" title="2"><span class="fu">bash</span> -c <span class="st">&#39;echo &quot;a=$a&quot;&#39;</span></a>
<a class="sourceLine" id="cb148-3" title="3"><span class="kw">set</span> <span class="ex">-a</span></a>
<a class="sourceLine" id="cb148-4" title="4"><span class="va">a=</span>1</a>
<a class="sourceLine" id="cb148-5" title="5"><span class="fu">bash</span> -c <span class="st">&#39;echo &quot;a=$a&quot;&#39;</span></a>
<a class="sourceLine" id="cb148-6" title="6"><span class="co">#&gt; a=</span></a>
<a class="sourceLine" id="cb148-7" title="7"><span class="co">#&gt; a=1</span></a>
<a class="sourceLine" id="cb148-8" title="8"></a></code></pre></div></li>
<li><p>option to glob also hidden files?</p>
<div class="sourceCode" id="cb149" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb149-1" title="1"><span class="fu">ls</span> -Alrth</a>
<a class="sourceLine" id="cb149-2" title="2">   <span class="co">#&gt; total 1,0K</span></a>
<a class="sourceLine" id="cb149-3" title="3">   <span class="co">#&gt; -rw-r--r-- 1 u u 0 fvr. 10 19:37 .a</span></a>
<a class="sourceLine" id="cb149-4" title="4">   <span class="co">#&gt; -rw-r--r-- 1 u u 0 fvr. 10 19:37 a</span></a>
<a class="sourceLine" id="cb149-5" title="5"><span class="fu">ls</span> *</a>
<a class="sourceLine" id="cb149-6" title="6">   <span class="co">#&gt; a</span></a>
<a class="sourceLine" id="cb149-7" title="7"><span class="bu">shopt</span> -s dotglob <span class="kw">&amp;&amp;</span> <span class="fu">ls</span> *</a>
<a class="sourceLine" id="cb149-8" title="8">   <span class="co">#&gt; a</span></a>
<a class="sourceLine" id="cb149-9" title="9">   <span class="co">#&gt; .als -Alrth</span></a>
<a class="sourceLine" id="cb149-10" title="10">   <span class="co">#&gt; total 1,0K</span></a>
<a class="sourceLine" id="cb149-11" title="11">   <span class="co">#&gt; -rw-r--r-- 1 u u 0 fvr. 10 19:37 .a</span></a>
<a class="sourceLine" id="cb149-12" title="12">   <span class="co">#&gt; -rw-r--r-- 1 u u 0 fvr. 10 19:37 a</span></a></code></pre></div></li>
<li><p>Bash config files</p>
<ol class="incremental">
<li><p>Order of loading of bash init files?</p>
<ul class="incremental">
<li>See diagram: <a href="https://blog.flowblok.id.au/2013-02/shell-startup-scripts.html">https://blog.flowblok.id.au/2013-02/shell-startup-scripts.html</a></li>
<li>graphviz code repo: <code>hg clone https://bitbucket.org/flowblok/shell-startup</code></li>
</ul>
<p><img src="./img/shell-startup.png" /></p></li>
</ol></li>
</ol></li>
<li><p>Files and Redirections</p>
<ol class="incremental">
<li><p>Stdin/out/err</p>
<ol class="incremental">
<li><p>redirect file to stdin on the left side?</p>
<p>see: <a href="http://www.tldp.org/LDP/abs/html/io-redirection.html">http://www.tldp.org/LDP/abs/html/io-redirection.html</a></p>
<div class="sourceCode" id="cb150" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb150-1" title="1"><span class="op">&lt;</span> <span class="ex">input-file</span> command <span class="op">&gt;</span> output-file</a>
<a class="sourceLine" id="cb150-2" title="2"><span class="co"># non standard</span></a></code></pre></div></li>
<li><p>redirecting stdout, stderr</p>
<div class="sourceCode" id="cb151" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">|</span> <span class="ex">redirect</span> from <span class="kw">|</span> <span class="ex">to</span>   <span class="kw">|</span> <span class="ex">cmd</span>                            <span class="kw">|</span> <span class="ex">notes</span>          <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-2" title="2"><span class="kw">|</span><span class="ex">---------------+------+--------------------------------+----------------</span><span class="kw">|</span></a>
<a class="sourceLine" id="cb151-3" title="3"><span class="kw">|</span> <span class="ex">out</span>           <span class="kw">|</span> <span class="ex">err</span>  <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">1&gt;&amp;2</span>                       <span class="kw">|</span>                <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-4" title="4"><span class="kw">|</span> <span class="ex">out</span> <span class="kw">&amp;</span> <span class="ex">err</span>     <span class="kw">|</span> <span class="fu">file</span> <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">&amp;&gt;</span>   file                  <span class="kw">|</span>                <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-5" title="5"><span class="kw">|</span>               <span class="kw">|</span>      <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">&gt;</span>    file <span class="op">2&gt;&amp;1</span>             <span class="kw">|</span> <span class="kw">for</span> <span class="ex">older</span> bash <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-6" title="6"><span class="kw">|</span> <span class="ex">err</span>           <span class="kw">|</span> <span class="ex">out</span>  <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">2&gt;&amp;1</span>                       <span class="kw">|</span>                <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-7" title="7"><span class="kw">|</span> <span class="ex">err</span> <span class="kw">&amp;</span> <span class="ex">out</span>     <span class="kw">|</span> <span class="ex">pipe</span> <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">2&gt;&amp;1</span> <span class="kw">|</span>  <span class="fu">grep</span> <span class="st">&#39;.*&#39;</span>          <span class="kw">|</span>                <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-8" title="8"><span class="kw">|</span>               <span class="kw">|</span>      <span class="kw">|</span>  <span class="fu">ls</span>      <span class="kw">|&amp;</span> <span class="fu">grep</span> <span class="st">&#39;.*&#39;</span>          <span class="kw">|</span> <span class="ex">equiv</span>          <span class="kw">|</span></a>
<a class="sourceLine" id="cb151-9" title="9"><span class="kw">|</span> <span class="ex">err</span>           <span class="kw">|</span> <span class="ex">proc</span> <span class="kw">|</span>  <span class="fu">ls</span> <span class="op">2&gt;</span> <span class="op">&gt;(</span><span class="fu">grep</span> foo<span class="op">)</span>  <span class="st">&#39;          | equiv          |</span></a></code></pre></div></li>
<li><p>use stdout as a file (with filename) for another cmd?</p>
<div class="sourceCode" id="cb152" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb152-1" title="1"><span class="ex">cmd</span> <span class="op">&lt;(</span><span class="fu">cat</span> f<span class="op">)</span></a></code></pre></div></li>
<li><p>swap stdout and stderr?</p>
<p><code>cmd 3&gt;&amp;1 1&gt;&amp;2 2&gt;&amp;3</code></p>
<div class="sourceCode" id="cb153" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb153-1" title="1">   $ <span class="fu">f()</span> <span class="kw">{</span> <span class="kw">(</span><span class="bu">echo</span> out<span class="kw">)</span> <span class="kw">&amp;&amp;</span> <span class="kw">(</span><span class="bu">echo</span> err <span class="op">1&gt;&amp;2</span><span class="kw">)</span>; <span class="kw">}</span></a>
<a class="sourceLine" id="cb153-2" title="2">   $ <span class="ex">f</span></a>
<a class="sourceLine" id="cb153-3" title="3"><span class="ex">out</span></a>
<a class="sourceLine" id="cb153-4" title="4"><span class="ex">err</span></a>
<a class="sourceLine" id="cb153-5" title="5">   $ <span class="fu">s()</span> <span class="kw">{</span> <span class="fu">sed</span> <span class="st">&quot;s/.*/=</span><span class="va">$1</span><span class="st">&gt;&amp;&lt;</span><span class="va">$1</span><span class="st">=/&quot;</span><span class="kw">;</span> <span class="kw">}</span></a>
<a class="sourceLine" id="cb153-6" title="6">   $ <span class="ex">f</span> <span class="kw">|</span> <span class="ex">s</span> 1</a>
<a class="sourceLine" id="cb153-7" title="7"><span class="ex">err</span></a>
<a class="sourceLine" id="cb153-8" title="8">=<span class="op">1&gt;</span><span class="ex">out</span><span class="op">&lt;</span>1=</a>
<a class="sourceLine" id="cb153-9" title="9">   $ <span class="kw">(</span><span class="ex">f</span> <span class="op">3&gt;&amp;1</span> <span class="op">1&gt;&amp;2</span> <span class="op">2&gt;&amp;3</span><span class="kw">)</span> <span class="kw">|</span> <span class="ex">s</span> 1</a>
<a class="sourceLine" id="cb153-10" title="10"><span class="ex">out</span></a>
<a class="sourceLine" id="cb153-11" title="11">=<span class="op">1&gt;</span><span class="ex">err</span><span class="op">&lt;</span>1=</a>
<a class="sourceLine" id="cb153-12" title="12">   $ <span class="kw">((</span>f 3&gt;&amp;1 1&gt;&amp;2 2&gt;&amp;3) | s 1) | s 2</a>
<a class="sourceLine" id="cb153-13" title="13">out</a>
<a class="sourceLine" id="cb153-14" title="14">=2&gt;=1&gt;err&lt;1=&lt;2=</a>
<a class="sourceLine" id="cb153-15" title="15">   $ (((f 3&gt;&amp;1 1&gt;&amp;2 2&gt;&amp;3) | s 1) 3&gt;&amp;1 1&gt;&amp;2 2&gt;&amp;3) | s 2</a>
<a class="sourceLine" id="cb153-16" title="16">=2&gt;out&lt;2=</a>
<a class="sourceLine" id="cb153-17" title="17">=1&gt;err&lt;1=</a></code></pre></div></li>
<li><p>write to stdin of a backround process?</p>
<p>see: <a href="https://serverfault.com/questions/188936/writing-to-stdin-of-background-process">https://serverfault.com/questions/188936/writing-to-stdin-of-background-process</a></p>
<div class="sourceCode" id="cb154" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb154-1" title="1"><span class="co"># create server</span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="fu">mkfifo</span> in</a>
<a class="sourceLine" id="cb154-3" title="3"><span class="fu">cat</span> <span class="op">&gt;</span> in <span class="kw">&amp;</span></a>
<a class="sourceLine" id="cb154-4" title="4"><span class="bu">echo</span> <span class="va">$!</span> <span class="op">&gt;</span> pid</a>
<a class="sourceLine" id="cb154-5" title="5"><span class="fu">cat</span> in <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.*/changed&gt; &amp;/&#39;</span> <span class="kw">&amp;</span></a>
<a class="sourceLine" id="cb154-6" title="6"><span class="co"># use server</span></a>
<a class="sourceLine" id="cb154-7" title="7"><span class="bu">echo</span> foo <span class="op">&gt;</span> in</a>
<a class="sourceLine" id="cb154-8" title="8"><span class="co"># stop server</span></a>
<a class="sourceLine" id="cb154-9" title="9"><span class="bu">kill</span> -9 <span class="va">$(</span><span class="fu">cat</span> pid<span class="va">)</span></a></code></pre></div></li>
<li><p>here-string with indentation in src but not in output?</p>
<div class="sourceCode" id="cb155" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb155-1" title="1">      <span class="fu">cat</span> <span class="op">&lt;&lt;EOF&#39;&#39;</span></a>
<a class="sourceLine" id="cb155-2" title="2">&lt;TAB&gt;hi</a>
<a class="sourceLine" id="cb155-3" title="3">EOF</a>
<a class="sourceLine" id="cb155-4" title="4">      #&gt; &lt;TAB&gt;hi</a>
<a class="sourceLine" id="cb155-5" title="5">      # But:</a>
<a class="sourceLine" id="cb155-6" title="6">      cat &lt;&lt;-EOF&#39;&#39;</a>
<a class="sourceLine" id="cb155-7" title="7">&lt;TAB&gt;hi</a>
<a class="sourceLine" id="cb155-8" title="8">EOF</a>
<a class="sourceLine" id="cb155-9" title="9">      #&gt; hi</a></code></pre></div></li>
<li><p>File Descriptors</p>
<ol class="incremental">
<li><p>Named File Descriptors</p>
<ol class="incremental">
<li><p>define a named file descriptor to a writable file and write to it?</p>
<div class="sourceCode" id="cb156" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb156-1" title="1"><span class="co"># open</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="bu">exec</span> <span class="dt">{filew}</span><span class="op">&gt;</span>outputfile</a>
<a class="sourceLine" id="cb156-3" title="3"><span class="co"># write</span></a>
<a class="sourceLine" id="cb156-4" title="4"><span class="bu">echo</span> foo <span class="op">&gt;</span><span class="kw">&amp;</span><span class="va">$filew</span></a>
<a class="sourceLine" id="cb156-5" title="5"><span class="co"># check</span></a>
<a class="sourceLine" id="cb156-6" title="6"><span class="fu">cat</span> outputfile</a>
<a class="sourceLine" id="cb156-7" title="7"><span class="co">#&gt; foo</span></a>
<a class="sourceLine" id="cb156-8" title="8"><span class="co"># close</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="bu">exec</span> <span class="dt">{filew}</span><span class="op">&gt;</span><span class="kw">&amp;</span><span class="ex">-</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>how to know if stdout is a terminal?</p>
<div class="sourceCode" id="cb157" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb157-1" title="1"><span class="bu">echo</span> -n <span class="st">&quot;stdout is: &quot;</span></a>
<a class="sourceLine" id="cb157-2" title="2"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-t</span> 1<span class="bu"> ]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb157-3" title="3">  <span class="bu">echo</span> <span class="st">&quot;a terminal&quot;</span></a>
<a class="sourceLine" id="cb157-4" title="4"><span class="kw">else</span></a>
<a class="sourceLine" id="cb157-5" title="5">  <span class="bu">echo</span> <span class="st">&quot;not a terminal&quot;</span></a>
<a class="sourceLine" id="cb157-6" title="6"><span class="kw">fi</span></a></code></pre></div></li>
<li><p>Printout</p>
<ol class="incremental">
<li><p>Padding</p>
<ol class="incremental">
<li><p>right / left pad with printf?</p>
<div class="sourceCode" id="cb158" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb158-1" title="1"><span class="bu">printf</span> <span class="st">&quot;%40s\n&quot;</span> foo <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39; &#39;</span> .</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="co">#&gt; .....................................foo</span></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="bu">printf</span> <span class="st">&quot;%-40s\n&quot;</span> foo <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39; &#39;</span> .</a>
<a class="sourceLine" id="cb158-4" title="4"><span class="co">#&gt; foo.....................................</span></a></code></pre></div></li>
<li><p>zero padding numbers?</p>
<div class="sourceCode" id="cb159" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb159-1" title="1"><span class="bu">printf</span> <span class="st">&quot;%05d\n&quot;</span> 99</a>
<a class="sourceLine" id="cb159-2" title="2"><span class="co">#&gt; 00099</span></a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>Tmp files</p>
<ol class="incremental">
<li><p>"delete while still open" trick to be sure a file will be deleted?</p>
<p>from: <a href="https://unix.stackexchange.com/questions/181937/how-create-a-temporary-file-in-shell-script">https://unix.stackexchange.com/questions/181937/how-create-a-temporary-file-in-shell-script</a></p>
<div class="sourceCode" id="cb160" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb160-1" title="1"><span class="va">tmpfile=$(</span><span class="fu">mktemp</span> /tmp/abc-script.XXXXXX<span class="va">)</span></a>
<a class="sourceLine" id="cb160-2" title="2"><span class="bu">exec</span> <span class="op">3&gt;</span><span class="st">&quot;</span><span class="va">$tmpfile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="fu">rm</span> <span class="st">&quot;</span><span class="va">$tmpfile</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb160-4" title="4"><span class="bu">:</span> ...</a>
<a class="sourceLine" id="cb160-5" title="5"><span class="bu">echo</span> foo <span class="op">&gt;&amp;3</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Env</p>
<ol class="incremental">
<li><p>how to run a command with the env cleared?</p>
<div class="sourceCode" id="cb161" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb161-1" title="1"><span class="fu">env</span> -i bash -c env</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="co">#&gt;        -i, --ignore-environment</span></a>
<a class="sourceLine" id="cb161-3" title="3"><span class="co">#&gt;        start with an empty environment</span></a>
<a class="sourceLine" id="cb161-4" title="4"></a></code></pre></div></li>
<li><p>export bash function?</p>
<div class="sourceCode" id="cb162" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb162-1" title="1"><span class="fu">f()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="st">&quot;I&#39;m f!&quot;</span> <span class="kw">;</span> <span class="kw">}</span></a>
<a class="sourceLine" id="cb162-2" title="2"><span class="bu">export</span> -f <span class="va">f</span></a>
<a class="sourceLine" id="cb162-3" title="3"><span class="fu">bash</span> -c f</a>
<a class="sourceLine" id="cb162-4" title="4"><span class="co">#&gt; I&#39;m f!</span></a></code></pre></div></li>
<li><p>Replace all env var by values in file?</p>
<div class="sourceCode" id="cb163" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb163-1" title="1"><span class="ex">envsubst</span></a></code></pre></div></li>
<li><p>how to make bash source a file before running a command?</p>
<p>Use the <code>BASH_ENV</code> to tell bash to source a file:</p>
<div class="sourceCode" id="cb164" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb164-1" title="1"><span class="fu">touch</span> .bashrc</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="bu">echo</span> foo=bar <span class="op">&gt;&gt;</span> .bashrc</a>
<a class="sourceLine" id="cb164-3" title="3"><span class="fu">bash</span> -c <span class="st">&#39;echo $foo&#39;</span></a>
<a class="sourceLine" id="cb164-4" title="4"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb164-5" title="5"><span class="va">BASH_ENV=</span>.bashrc <span class="fu">bash</span> -c <span class="st">&#39;echo $foo&#39;</span></a>
<a class="sourceLine" id="cb164-6" title="6"><span class="co">#&gt; bar</span></a></code></pre></div></li>
<li><p>how to test if a variable is defined?</p>
<div class="sourceCode" id="cb165" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">if [[</span> <span class="va">${varname:-}</span><span class="kw"> ]]</span>; <span class="kw">then</span></a>
<a class="sourceLine" id="cb165-2" title="2">  <span class="bu">echo</span> <span class="st">&quot;var is defined&quot;</span></a>
<a class="sourceLine" id="cb165-3" title="3"><span class="kw">else</span></a>
<a class="sourceLine" id="cb165-4" title="4">  <span class="bu">echo</span> <span class="st">&quot;var not defined or empt&quot;</span></a>
<a class="sourceLine" id="cb165-5" title="5"><span class="kw">fi</span></a></code></pre></div>
<ul class="incremental">
<li><p>Another way from <a href="https://wiki-dev.bash-hackers.org/scripting/posparams">bash hackers</a>:</p>
<div class="sourceCode" id="cb166" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">if</span><span class="bu"> [</span> <span class="va">${x+</span>defined<span class="va">}</span><span class="bu"> ]</span>; <span class="kw">then</span> <span class="bu">echo</span> <span class="st">&quot;x is not defined&quot;</span><span class="kw">;</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb166-2" title="2">                     <span class="kw">else</span> <span class="bu">echo</span> <span class="st">&quot;x is defined (may be blank)&quot;</span><span class="kw">;</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb166-3" title="3"><span class="kw">fi</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb166-4" title="4">;</a></code></pre></div></li>
</ul></li>
</ol></li>
<li><p>Debugging</p>
<ol class="incremental">
<li><p>how to make a bash script stop and print current line before running it?</p>
<p>Add to your script:</p>
<div class="sourceCode" id="cb167" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb167-1" title="1"><span class="bu">trap</span> <span class="st">&#39;(read -p &quot;[$BASH_SOURCE:$LINENO] $BASH_COMMAND?&quot;)&#39;</span> DEBUG</a></code></pre></div>
<p>From: <a href="https://translate.google.co.uk/translate?hl=fr&amp;sl=en&amp;tl=fr&amp;u=http%3A%2F%2Fwww.softpanorama.org%2FScripting%2FShellorama%2Fbash_debugging.shtml&amp;anno=2">https://translate.google.co.uk/translate?hl=fr&amp;sl=en&amp;tl=fr&amp;u=http%3A%2F%2Fwww.softpanorama.org%2FScripting%2FShellorama%2Fbash_debugging.shtml&amp;anno=2</a></p></li>
<li><p>how to execute a script step by step?</p>
<p>Add to your script:</p>
<div class="sourceCode" id="cb168" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb168-1" title="1"><span class="bu">trap</span> <span class="st">&#39;echo TRAP ERROR something wrong happened, errcode=$? 1&gt;&amp;2 ; finish&#39;</span> ERR</a></code></pre></div>
<div class="sourceCode" id="cb169" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb169-1" title="1"><span class="bu">declare</span> <span class="va">varName=</span>foo</a>
<a class="sourceLine" id="cb169-2" title="2"><span class="bu">declare</span> -n <span class="va">refToVar=</span>varName</a>
<a class="sourceLine" id="cb169-3" title="3"><span class="bu">echo</span> <span class="va">${refToVar}</span></a>
<a class="sourceLine" id="cb169-4" title="4"><span class="co">#&gt; foo</span></a></code></pre></div>
<p>works recursively:</p>
<div class="sourceCode" id="cb170" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb170-1" title="1">$ <span class="bu">declare</span> <span class="va">varName=</span>foo</a>
<a class="sourceLine" id="cb170-2" title="2">$ <span class="bu">declare</span> -n <span class="va">refToVar=</span>varName</a>
<a class="sourceLine" id="cb170-3" title="3">$ <span class="bu">declare</span> -n <span class="va">refToRefToVar=</span>refToVar</a>
<a class="sourceLine" id="cb170-4" title="4">$ <span class="bu">echo</span> <span class="va">${refToRefToVar}</span></a>
<a class="sourceLine" id="cb170-5" title="5"><span class="co">#&gt; foo</span></a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="zsh">Zsh</h3>
<ol class="incremental">
<li><p>Completion</p>
<ol class="incremental">
<li><p>using bash's autocomplete with zsh?</p>
<div class="sourceCode" id="cb171" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb171-1" title="1"><span class="fu">touch</span> cmd <span class="kw">&amp;&amp;</span> <span class="fu">chmod</span> +x cmd</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="co"># run bashcompinit</span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="ex">autoload</span> bashcompinit</a>
<a class="sourceLine" id="cb171-4" title="4"><span class="ex">bashcompinit</span></a>
<a class="sourceLine" id="cb171-5" title="5"><span class="co"># bash&#39;s way of saying that cmd can complete with foo or bar or baz:</span></a>
<a class="sourceLine" id="cb171-6" title="6"><span class="bu">complete</span> -W <span class="st">&#39;foo bar baz&#39;</span> cmd</a>
<a class="sourceLine" id="cb171-7" title="7"><span class="co">#&gt; ./cmd b&lt;tab&gt;&lt;tab&gt; will show &quot;foo&quot; &quot;bar&quot; &quot;baz&quot;</span></a></code></pre></div></li>
<li><p>Copy an existing completion for another command?</p>
<ul class="incremental">
<li>From: <a href="https://github.com/zsh-users/zsh-completions/blob/master/zsh-completions-howto.org">https://github.com/zsh-users/zsh-completions/blob/master/zsh-completions-howto.org</a></li>
</ul>
<div class="sourceCode" id="cb172" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb172-1" title="1"><span class="ex">compdef</span> cmd1=cmd2</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="x">X</h3>
<ol class="incremental">
<li><p>copy to system clipboard from the command line?</p>
<div class="sourceCode" id="cb173" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb173-1" title="1"><span class="bu">echo</span> a <span class="kw">|</span> <span class="ex">xclip</span> -selection clipboard</a></code></pre></div></li>
<li><p>dual monitor setup: turn off one of the monitor and not the other?</p>
<div class="sourceCode" id="cb174" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb174-1" title="1"><span class="co"># choose one of the monitor with:</span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="ex">xrandr</span> -q</a>
<a class="sourceLine" id="cb174-3" title="3"><span class="co"># disbale it</span></a>
<a class="sourceLine" id="cb174-4" title="4"><span class="ex">xrandr</span> --output LVDS1 --off</a></code></pre></div></li>
<li><p>force X resolution when an external monitor is not detected?</p>
<div class="sourceCode" id="cb175" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb175-1" title="1"><span class="co"># check the current display and resolutions:</span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="ex">xrandr</span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="co"># calculate the modeline</span></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="kw">(</span> <span class="bu">export</span> <span class="va">x=</span>1920 <span class="va">y=</span>1080 <span class="va">freq=</span>60 <span class="kw">&amp;&amp;</span> <span class="ex">cvt</span> <span class="va">$x</span> <span class="va">$y</span> <span class="va">$freq</span><span class="kw">)</span></a>
<a class="sourceLine" id="cb175-5" title="5"><span class="co">#&gt; # 1920x1080 59.96 Hz (CVT 2.07M9) hsync: 67.16 kHz; pclk: 173.00 MHz</span></a>
<a class="sourceLine" id="cb175-6" title="6"><span class="co">#&gt; Modeline &quot;1920x1080_60.00&quot;  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync</span></a>
<a class="sourceLine" id="cb175-7" title="7"><span class="co"># take the ouput and feed it to xrandr to create the new modeline:</span></a>
<a class="sourceLine" id="cb175-8" title="8"><span class="ex">xrandr</span> --newmode 1920x960_60.00 152.00  1920 2032 2232 2544  960 963 973 996 -hsync +vsync</a>
<a class="sourceLine" id="cb175-9" title="9"><span class="co"># add it to the output</span></a>
<a class="sourceLine" id="cb175-10" title="10"><span class="ex">xrandr</span> --addmode DP-2 1920x960_60.00</a>
<a class="sourceLine" id="cb175-11" title="11"><span class="co"># in monitors setup choose the new reolution</span></a></code></pre></div></li>
<li><p>Fonts</p>
<ol class="incremental">
<li><p>List fonts?</p>
<div class="sourceCode" id="cb176" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb176-1" title="1"><span class="ex">fc-list</span></a></code></pre></div></li>
</ol></li>
<li><p>Gnome</p>
<ol class="incremental">
<li><p>How to logout from Gnome with the terminal?</p>
<div class="sourceCode" id="cb177" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb177-1" title="1"><span class="ex">gnome-session-quit</span></a></code></pre></div></li>
</ol></li>
<li><p>Remote</p>
<ol class="incremental">
<li><p>NoMachine NX</p>
<ol class="incremental">
<li><p>How to administrate the NX server?</p>
<div class="sourceCode" id="cb178" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb178-1" title="1"><span class="fu">sudo</span> /usr/NX/bin/nxserver --status</a>
<a class="sourceLine" id="cb178-2" title="2"><span class="fu">sudo</span> /usr/NX/bin/nxserver --stop</a>
<a class="sourceLine" id="cb178-3" title="3"><span class="fu">sudo</span> /usr/NX/bin/nxserver --start</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Xpra</p>
<ol class="incremental">
<li><p>xpra quickstart on ubuntu?</p>
<div class="sourceCode" id="cb179" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb179-1" title="1"><span class="co"># On the server ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb179-2" title="2"><span class="co">## install xpra</span></a>
<a class="sourceLine" id="cb179-3" title="3"><span class="fu">sudo</span> aptitude install xpra</a>
<a class="sourceLine" id="cb179-4" title="4"><span class="co">## intall xvfb</span></a>
<a class="sourceLine" id="cb179-5" title="5"><span class="fu">sudo</span> aptitude install xvfb</a>
<a class="sourceLine" id="cb179-6" title="6"><span class="co">## use xvfb instead of xorg:</span></a>
<a class="sourceLine" id="cb179-7" title="7"><span class="fu">sudo</span> vim /etc/xpra/xpra.conf</a>
<a class="sourceLine" id="cb179-8" title="8"><span class="co"># comment   the line starting with &#39;xvfb=Xorg&#39;</span></a>
<a class="sourceLine" id="cb179-9" title="9"><span class="co"># UNcomment the line starting with &#39;xvfb=Xvfb&#39;</span></a>
<a class="sourceLine" id="cb179-10" title="10"><span class="co">## start a session on the display #10 without the deamon (for troubleshooting):</span></a>
<a class="sourceLine" id="cb179-11" title="11"><span class="va">display=</span>10</a>
<a class="sourceLine" id="cb179-12" title="12"><span class="ex">xpra</span> start --daemon=no :<span class="va">${display}</span></a>
<a class="sourceLine" id="cb179-13" title="13"><span class="co"># on the client ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb179-14" title="14"><span class="co">## install xpra</span></a>
<a class="sourceLine" id="cb179-15" title="15"><span class="fu">sudo</span> aptitude install xpra</a>
<a class="sourceLine" id="cb179-16" title="16"><span class="co"># attach to the remote session</span></a>
<a class="sourceLine" id="cb179-17" title="17"><span class="va">display=</span>10</a>
<a class="sourceLine" id="cb179-18" title="18"><span class="ex">xpra</span> attach ssh/<span class="va">${remoteSshUser}</span>@<span class="va">${remoteSshHost}</span>:<span class="va">${remoteSshPort}</span>/<span class="va">${display}</span></a>
<a class="sourceLine" id="cb179-19" title="19"><span class="co"># On the server ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb179-20" title="20"><span class="co">## start a test app:</span></a>
<a class="sourceLine" id="cb179-21" title="21"><span class="va">DISPLAY=${display}</span> <span class="ex">xeyes</span></a>
<a class="sourceLine" id="cb179-22" title="22"><span class="co">#&gt; xeyes should open on the client...</span></a>
<a class="sourceLine" id="cb179-23" title="23"><span class="co">## now start a bigger app:</span></a>
<a class="sourceLine" id="cb179-24" title="24"><span class="va">DISPLAY=${display}</span> <span class="ex">google-chrome</span></a></code></pre></div></li>
</ol></li>
<li><p>Window managers</p>
<ol class="incremental">
<li><p>Gnome</p>
<ol class="incremental">
<li><p>open the network manager (for proxy settings) from the command line?</p>
<div class="sourceCode" id="cb180" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb180-1" title="1"><span class="ex">gnome-control-center</span> network</a></code></pre></div></li>
<li><p>Gnome 3</p>
<ol class="incremental">
<li><p>Gnome Shell</p>
<ol class="incremental">
<li><p>how to have cpu,etc montoring in the top bar?</p>
<ul class="incremental">
<li>Install system-monitor gnome extension</li>
<li>Can search it through gnome shell search (win key)</li>
</ul></li>
<li><p>how restart gnome shell?</p>
<ul class="incremental">
<li><code>alt-F2</code></li>
<li><code>r</code></li>
</ul>
<ol class="incremental">
<li><p>Gnome Shell Extensions?</p>
<ol class="incremental">
<li><p>how to manage enabling/disabling gnome shell user extensions (command line)?</p>
<p>from: <a href="https://askubuntu.com/questions/1029376/how-to-enable-and-disable-gnome-extensions-from-command-line">https://askubuntu.com/questions/1029376/how-to-enable-and-disable-gnome-extensions-from-command-line</a></p>
<div class="sourceCode" id="cb181" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb181-1" title="1"><span class="co"># are all gnome shell user extensions disabled?</span></a>
<a class="sourceLine" id="cb181-2" title="2"><span class="ex">gsettings</span> get org.gnome.shell disable-user-extensions</a>
<a class="sourceLine" id="cb181-3" title="3"><span class="co"># disable all gnome shell user extensions</span></a>
<a class="sourceLine" id="cb181-4" title="4"><span class="ex">gsettings</span> set org.gnome.shell disable-user-extensions true</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>Xdg-open</p>
<ol class="incremental">
<li><p>choose browser to use with xdg-open?</p>
<div class="sourceCode" id="cb182" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb182-1" title="1"><span class="ex">xdg-settings</span> set default-web-browser google-chrome.desktop</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="converting-formats">Converting formats</h3>
<ol class="incremental">
<li><p>convert file format table?</p>
<table>
<thead>
<tr class="header">
<th>src</th>
<th>dst</th>
<th>command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rtf</code></td>
<td><code>pdf</code></td>
<td><code>libreoffice --headless --invisible --norestore --convert-to pdf source-file.rtf</code></td>
</tr>
</tbody>
</table></li>
<li><p>Pdf</p>
<ol class="incremental">
<li><p>replace a string in a pdf file ?</p>
<div class="sourceCode" id="cb183" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb183-1" title="1"><span class="ex">pdftk</span> file.pdf output uncompressed.pdf uncompress</a>
<a class="sourceLine" id="cb183-2" title="2"></a>
<a class="sourceLine" id="cb183-3" title="3"><span class="fu">sed</span> -e <span class="st">&quot;s/ORIGINALSTRING/NEWSTRING/g&quot;</span> <span class="op">&lt;</span>uncompressed.pdf <span class="op">&gt;</span>modified.pdf</a>
<a class="sourceLine" id="cb183-4" title="4"></a>
<a class="sourceLine" id="cb183-5" title="5"><span class="ex">pdftk</span> modified.pdf output recompressed.pdf compress</a></code></pre></div>
<p><a href="http://stackoverflow.com/questions/9871585/how-to-find-and-replace-text-in-a-existing-pdf-file-with-pdftk-or-other-command">http://stackoverflow.com/questions/9871585/how-to-find-and-replace-text-in-a-existing-pdf-file-with-pdftk-or-other-command</a></p></li>
</ol></li>
</ol>
<h3 id="locale">Locale</h3>
<ol class="incremental">
<li><p>fix locale config?</p>
<ol class="incremental">
<li><p>ubuntu / debian</p>
<div class="sourceCode" id="cb184" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb184-1" title="1"><span class="co"># add to /etc/environnement</span></a>
<a class="sourceLine" id="cb184-2" title="2"><span class="va">LC_ALL=</span>en_US.UTF-8</a>
<a class="sourceLine" id="cb184-3" title="3"><span class="va">LANG=</span>en_US.UTF-8</a>
<a class="sourceLine" id="cb184-4" title="4"></a>
<a class="sourceLine" id="cb184-5" title="5"><span class="fu">sudo</span> locale-gen <span class="st">&quot;en_US.UTF-8&quot;</span></a>
<a class="sourceLine" id="cb184-6" title="6"><span class="fu">sudo</span> dpkg-reconfigure locales</a>
<a class="sourceLine" id="cb184-7" title="7"></a></code></pre></div>
<p><strong>note</strong>:</p>
<div class="sourceCode" id="cb185" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb185-1" title="1"></a>
<a class="sourceLine" id="cb185-2" title="2">      [<span class="ex">warn</span>] /etc/environment has been deprecated for locale information<span class="kw">;</span> <span class="ex">use</span> /etc/default/locale for LANG=en_US.UTF-8 instead ... (warning)<span class="ex">.</span></a>
<a class="sourceLine" id="cb185-3" title="3">[<span class="ex">warn</span>] /etc/environment has been deprecated for locale information<span class="kw">;</span> <span class="ex">use</span> /etc/default/locale for LC_ALL=en_US.UTF-8 instead ... (warning)<span class="ex">.</span></a>
<a class="sourceLine" id="cb185-4" title="4"></a></code></pre></div></li>
<li><p>centos</p>
<div class="sourceCode" id="cb186" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb186-1" title="1"><span class="fu">cat</span> /etc/environment /etc/environment.bak</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="fu">cat</span> /etc/environment          \</a>
<a class="sourceLine" id="cb186-3" title="3"><span class="kw">|</span> <span class="ex">jq</span> -R .                     \</a>
<a class="sourceLine" id="cb186-4" title="4"><span class="kw">|</span> <span class="ex">jq</span> -sr <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb186-5" title="5"><span class="st">  [&quot;LANG=en_US.utf-10&quot;, &quot;LC_ALL=en_US.utf-8&quot;] as $vars</span></a>
<a class="sourceLine" id="cb186-6" title="6"><span class="st">  | if contains($vars) then empty else $vars end</span></a>
<a class="sourceLine" id="cb186-7" title="7"><span class="st">  | join(&quot;\n&quot;)</span></a>
<a class="sourceLine" id="cb186-8" title="8"><span class="st">  | &quot;echo \&quot;\(.)\&quot;</span></a>
<a class="sourceLine" id="cb186-9" title="9"><span class="st">  | tee -a /etc/environment &quot; &#39;</span> \</a>
<a class="sourceLine" id="cb186-10" title="10"><span class="kw">|</span> <span class="fu">bash</span> -xeuo pipefail</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="network">Network</h3>
<ol class="incremental">
<li><p>How to trace all network activity?</p>
<p><code>tcpflow</code></p>
<div class="sourceCode" id="cb187" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb187-1" title="1"><span class="ex">tcpflow</span> -p -c -i eth0 port 80 <span class="kw">|</span> <span class="fu">grep</span> -oE <span class="st">&#39;(GET|POST|HEAD) .* HTTP/1.[01]|Host: .*&#39;</span></a></code></pre></div>
<p><a href="http://unix.stackexchange.com/questions/6279/on-the-fly-monitoring-http-requests-on-a-network-interface">http://unix.stackexchange.com/questions/6279/on-the-fly-monitoring-http-requests-on-a-network-interface</a></p></li>
<li><p>how to get the ip adresse of the local host ?</p>
<p><strong>Note</strong>: To be verfied!</p>
<div class="sourceCode" id="cb188" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb188-1" title="1"><span class="fu">hostname</span> -I</a></code></pre></div>
<p>or (?)</p>
<div class="sourceCode" id="cb189" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb189-1" title="1"><span class="fu">hostname</span> -I <span class="kw">|</span> <span class="fu">cut</span> -d<span class="st">&#39; &#39;</span> -f1</a></code></pre></div></li>
<li><p>list open ports?</p>
<div class="sourceCode" id="cb190" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb190-1" title="1"><span class="fu">netstat</span> -lntu</a></code></pre></div></li>
<li><p>Proxy</p>
<ol class="incremental">
<li><p>Request with curl through a proxy over ssh ?</p>
<div class="sourceCode" id="cb191" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb191-1" title="1"><span class="va">remoteHost=</span>remote.host</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="va">remoteHostSshPort=</span>22222</a>
<a class="sourceLine" id="cb191-3" title="3"><span class="co"># Create socks5 proxy on client machine</span></a>
<a class="sourceLine" id="cb191-4" title="4"><span class="fu">ssh</span> -vvv -D 8123 -f -C -N -p 55555 u@localhost</a>
<a class="sourceLine" id="cb191-5" title="5"><span class="co"># Request with curl telling him to use the proxy</span></a>
<a class="sourceLine" id="cb191-6" title="6"><span class="ex">curl</span> -x socks5h://localhost:8123 http://remote.host.com</a>
<a class="sourceLine" id="cb191-7" title="7"><span class="co"># OR</span></a>
<a class="sourceLine" id="cb191-8" title="8"><span class="ex">curl</span> --socks5-hostname localhost:8123 http://remote.host.com</a></code></pre></div></li>
</ol></li>
<li><p>how to list all open ports and their associated processes?</p>
<div class="sourceCode" id="cb192" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb192-1" title="1"><span class="fu">sudo</span> netstat -lntp</a></code></pre></div></li>
<li><p>Mtu</p>
<ol class="incremental">
<li><p>temporary change the mtu of a network interface?</p>
<div class="sourceCode" id="cb193" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb193-1" title="1"><span class="ex">ifconfig</span> eth0 mtu 9000</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="compression">Compression</h3>
<ol class="incremental">
<li><p>compress stdin, uncompress to stdout ?</p>
<div class="sourceCode" id="cb194" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb194-1" title="1"><span class="kw">|</span>            <span class="kw">|</span> <span class="ex">cmd</span>                       <span class="kw">|</span></a>
<a class="sourceLine" id="cb194-2" title="2"><span class="kw">|</span><span class="ex">------------+---------------------------</span><span class="kw">|</span></a>
<a class="sourceLine" id="cb194-3" title="3"><span class="kw">|</span> <span class="ex">compress</span>   <span class="kw">|</span> <span class="bu">echo</span> foobarXgzip <span class="op">&gt;</span> msg.gz <span class="kw">|</span></a>
<a class="sourceLine" id="cb194-4" title="4"><span class="kw">|</span> <span class="ex">decompress</span> <span class="kw">|</span> <span class="fu">zcat</span> msg.gz               <span class="kw">|</span></a></code></pre></div></li>
<li><p>Xz</p>
<ol class="incremental">
<li><p>compress/decompress stdin with xz?</p>
<div class="sourceCode" id="cb195" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb195-1" title="1"><span class="co"># compress</span></a>
<a class="sourceLine" id="cb195-2" title="2"><span class="fu">seq</span> 3 <span class="kw">|</span> <span class="fu">xz</span> <span class="op">&gt;</span> out.xz</a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co"># decompress</span></a>
<a class="sourceLine" id="cb195-4" title="4"><span class="fu">cat</span> out.xz <span class="kw">|</span> <span class="fu">unxz</span></a>
<a class="sourceLine" id="cb195-5" title="5"><span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb195-6" title="6"><span class="co">#&gt; 2</span></a>
<a class="sourceLine" id="cb195-7" title="7"><span class="co">#&gt; 3</span></a></code></pre></div></li>
<li><p>decompress stdin with xz?</p>
<div class="sourceCode" id="cb196" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb196-1" title="1"></a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="fs">Fs</h3>
<ol class="incremental">
<li><p>difference between <code>/bin</code>, <code>/usr/bin</code>, <code>/usr/local/bin</code>?</p>
<p>From: <a href="https://unix.stackexchange.com/questions/8656/usr-bin-vs-usr-local-bin-on-linux">https://unix.stackexchange.com/questions/8656/usr-bin-vs-usr-local-bin-on-linux</a></p>
<ul class="incremental">
<li><code>/bin</code>: for booting the os (must fit on a small partition)</li>
<li><code>/usr/bin</code>: Normal binaries installed by the package manager</li>
<li><code>/usr/local/bin</code>: Was installed after manually compiled (for exemple)</li>
</ul></li>
<li><p>Zfs</p>
<ol class="incremental">
<li><p>Create a new zfs "env" in a file?</p>
<div class="sourceCode" id="cb197" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb197-1" title="1"><span class="ex">zpool</span> list</a>
<a class="sourceLine" id="cb197-2" title="2"></a>
<a class="sourceLine" id="cb197-3" title="3"><span class="ex">fallocate</span> -l 500M /tmp/zpooltest</a>
<a class="sourceLine" id="cb197-4" title="4"><span class="co"># or</span></a>
<a class="sourceLine" id="cb197-5" title="5"><span class="ex">truncate</span> -s 500M /tmp/zpooltest</a>
<a class="sourceLine" id="cb197-6" title="6"></a>
<a class="sourceLine" id="cb197-7" title="7"><span class="ex">zpool</span> create testpool /tmp/zpooltest</a>
<a class="sourceLine" id="cb197-8" title="8"><span class="ex">zpool</span> list</a>
<a class="sourceLine" id="cb197-9" title="9"><span class="ex">zfs</span> create testpool/lz4</a>
<a class="sourceLine" id="cb197-10" title="10"><span class="ex">zfs</span> set compression=lz4 testpool/lz4</a>
<a class="sourceLine" id="cb197-11" title="11"><span class="ex">zfs</span> set dedup=on testpool/lz4</a>
<a class="sourceLine" id="cb197-12" title="12"><span class="ex">zpool</span> list</a>
<a class="sourceLine" id="cb197-13" title="13"><span class="co">#&gt; NAME           SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT</span></a>
<a class="sourceLine" id="cb197-14" title="14"><span class="co">#&gt; testpool       480M  1,93M   478M         -    11%     0%  1.00x  ONLINE  -</span></a>
<a class="sourceLine" id="cb197-15" title="15"><span class="co">#&gt; zpool-docker   199G   163G  36,0G         -    83%    81%  2.17x  ONLINE  -</span></a>
<a class="sourceLine" id="cb197-16" title="16"><span class="ex">zfs</span> list testpool</a>
<a class="sourceLine" id="cb197-17" title="17"><span class="co">#&gt; NAME       USED  AVAIL  REFER  MOUNTPOINT</span></a>
<a class="sourceLine" id="cb197-18" title="18"><span class="co">#&gt; testpool   652K   447M    19K  /testpool</span></a></code></pre></div></li>
<li><p>How to destroy a zpool ?</p>
<div class="sourceCode" id="cb198" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb198-1" title="1"><span class="ex">zpool</span> destroy <span class="op">&lt;</span>poolName<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>How to add new devices to an exising pool?</p>
<div class="sourceCode" id="cb199" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb199-1" title="1"><span class="co"># List already used devices</span></a>
<a class="sourceLine" id="cb199-2" title="2"><span class="fu">sudo</span> zpool status</a>
<a class="sourceLine" id="cb199-3" title="3"><span class="co"># check availavble devices</span></a>
<a class="sourceLine" id="cb199-4" title="4"><span class="ex">lsblk</span></a>
<a class="sourceLine" id="cb199-5" title="5"><span class="co"># add a device to the pool</span></a>
<a class="sourceLine" id="cb199-6" title="6"><span class="fu">sudo</span> zpool add zpool-docker /dev/sde</a>
<a class="sourceLine" id="cb199-7" title="7"><span class="co"># list again to check it has been taken into account</span></a>
<a class="sourceLine" id="cb199-8" title="8"><span class="fu">sudo</span> zpool add zpool-docker /dev/sde</a></code></pre></div></li>
<li><p>How to view the dedup and compression properties of pools?</p>
<div class="sourceCode" id="cb200" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb200-1" title="1"><span class="co"># a starting point:</span></a>
<a class="sourceLine" id="cb200-2" title="2"><span class="fu">sudo</span> zfs list -o devices,type,mountpoint,compressratio,refcompressratio,compression,dedup</a></code></pre></div></li>
<li><p>Snaphot clones, etc</p>
<p>from: <a href="https://www.howtoforge.com/tutorial/how-to-use-snapshots-clones-and-replication-in-zfs-on-linux/">https://www.howtoforge.com/tutorial/how-to-use-snapshots-clones-and-replication-in-zfs-on-linux/</a></p>
<div class="sourceCode" id="cb201" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb201-1" title="1"><span class="co"># #### Given you havea datapool, eg created with:</span></a>
<a class="sourceLine" id="cb201-2" title="2">    <span class="ex">zpool</span> create datapool mirror /dev/sdb /dev/sdc</a>
<a class="sourceLine" id="cb201-3" title="3">    <span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb201-4" title="4">    <span class="ex">zpool</span> list</a>
<a class="sourceLine" id="cb201-5" title="5">    <span class="co">#&gt; NAME       SIZE  ALLOC   FREE  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT</span></a>
<a class="sourceLine" id="cb201-6" title="6">    <span class="ex">datapool</span>  1.98G    65K  1.98G         -     0%     0%  1.00x  ONLINE  -</a>
<a class="sourceLine" id="cb201-7" title="7"><span class="co"># #### and a zfs filesystem created for exeample with:</span></a>
<a class="sourceLine" id="cb201-8" title="8">    <span class="ex">zfs</span> create datapool/docs -o mountpoint=/docs</a>
<a class="sourceLine" id="cb201-9" title="9">    <span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb201-10" title="10">    <span class="ex">zfs</span> list -r datapool</a>
<a class="sourceLine" id="cb201-11" title="11">    <span class="co">#&gt; NAME            USED  AVAIL  REFER  MOUNTPOINT</span></a>
<a class="sourceLine" id="cb201-12" title="12">    <span class="co">#&gt; datapool       93.5K  1.92G    19K  /datapool</span></a>
<a class="sourceLine" id="cb201-13" title="13">    <span class="co">#&gt; datapool/docs    19K  1.92G    19K  /docs</span></a>
<a class="sourceLine" id="cb201-14" title="14"><span class="co"># </span><span class="al">###</span><span class="co"> you can create a snapshot with :</span></a>
<a class="sourceLine" id="cb201-15" title="15">    <span class="ex">zfs</span> snapshot datapool/docs@version1</a>
<a class="sourceLine" id="cb201-16" title="16">    <span class="ex">zfs</span> list -t snapshot</a>
<a class="sourceLine" id="cb201-17" title="17">    <span class="co">#&gt; NAME                     USED  AVAIL  REFER  MOUNTPOINT</span></a>
<a class="sourceLine" id="cb201-18" title="18">    <span class="co">#&gt; datapool/docs@version1      0      -  19.5K  -</span></a></code></pre></div></li>
</ol></li>
<li><p>AccessControl</p>
<ol class="incremental">
<li><p>Set read right reccursive for all files and and dir in a given dir?</p>
<div class="sourceCode" id="cb202" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb202-1" title="1"><span class="va">dir=</span>/path/to</a>
<a class="sourceLine" id="cb202-2" title="2"><span class="kw">&amp;&amp;</span> <span class="fu">find</span> <span class="st">&quot;</span><span class="va">$dir</span><span class="st">&quot;</span> -type f -print0 <span class="kw">|</span> <span class="fu">xargs</span> -0 chmod 744 \</a>
<a class="sourceLine" id="cb202-3" title="3"><span class="kw">&amp;&amp;</span> <span class="fu">find</span> <span class="st">&quot;</span><span class="va">$dir</span><span class="st">&quot;</span> -type d -print0 <span class="kw">|</span> <span class="fu">xargs</span> -0 chmod 755</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="distribs">Distribs</h3>
<ol class="incremental">
<li><p>Alpine</p>
<ol class="incremental">
<li><p>Apk</p>
<ol class="incremental">
<li><p>use a http cache for apk ?</p>
<p>from: <a href="https://hub.docker.com/r/vektorlab/apk-cache/">https://hub.docker.com/r/vektorlab/apk-cache/</a></p>
<ul class="incremental">
<li>Run an apk-cache on port 80 + –add-host:</li>
</ul>
<div class="sourceCode" id="cb203" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb203-1" title="1"><span class="co"># run an apk-cache container</span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="ex">docker</span> run -d -p 80:80 --name=apk-cache vektorlab/apk-cache</a>
<a class="sourceLine" id="cb203-3" title="3"><span class="co"># run container by replacing dl-4.alpinelinux.org:</span></a>
<a class="sourceLine" id="cb203-4" title="4"><span class="ex">docker</span> run --add-host dl-cdn.alpinelinux.org:<span class="va">${hostIp}</span> -it alpine:3.6</a>
<a class="sourceLine" id="cb203-5" title="5"><span class="co"># Alternative if not running on port 80, link the container:</span></a>
<a class="sourceLine" id="cb203-6" title="6"><span class="ex">docker</span> run -d -p 80:80 --name=apk-cache vektorlab/apk-cache</a></code></pre></div>
<ul class="incremental">
<li>Run an apk-cache on any port + link on port 80 + –add-host:</li>
</ul>
<div class="sourceCode" id="cb204" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb204-1" title="1"><span class="co"># run an apk-cache container</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="ex">docker</span> run -d -p 8080:80 --name=apk-cache vektorlab/apk-cache</a>
<a class="sourceLine" id="cb204-3" title="3"><span class="co"># docker run with link</span></a>
<a class="sourceLine" id="cb204-4" title="4"><span class="ex">docker</span> run -ti --link apk-cache:dl-4.alpinelinux.org alpine:latest /bin/sh</a></code></pre></div>
<ul class="incremental">
<li>Run apk-cache on any port + overwrite resolution of dl-4.alpinelinux.org via dnsmasq</li>
</ul></li>
<li><p>add a repo?</p>
<div class="sourceCode" id="cb205" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb205-1" title="1"><span class="bu">echo</span> <span class="st">&quot;http://107.181.185.116/alpine/v3.2/main&quot;</span> <span class="op">&gt;&gt;</span> /etc/apk/repositories<span class="kw">;</span> <span class="kw">\</span></a></code></pre></div></li>
<li><p>how to install telnet on alpine ???</p>
<div class="sourceCode" id="cb206" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Debian</p>
<ol class="incremental">
<li><p>Old debian GPG invalid signature when apt-get update?</p>
<p>Re-import expired pgp keys with:</p>
<div class="sourceCode" id="cb207" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb207-1" title="1"><span class="ex">apt-key</span> list <span class="kw">|</span> <span class="fu">grep</span> expired <span class="kw">|</span>  <span class="fu">tr</span> -s <span class="st">&#39; &#39;</span>  <span class="kw">|</span> <span class="fu">cut</span> -f2 -d <span class="st">&#39; &#39;</span> <span class="kw">|</span> <span class="fu">cut</span> -f2 -d<span class="st">&#39;/&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> -r <span class="st">&#39;s/.*/apt-key adv --recv-keys --keyserver keys.gnupg.net &amp;/&#39;</span> <span class="kw">|</span> <span class="fu">bash</span> -xv</a>
<a class="sourceLine" id="cb207-2" title="2"></a></code></pre></div></li>
</ol></li>
<li><p>Ubuntu</p>
<ol class="incremental">
<li><p>X</p>
<ol class="incremental">
<li><p>Disable Wayland to use Xorg instead?</p>
<div class="sourceCode" id="cb208" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb208-1" title="1"><span class="ex">Edit</span> =/etc/gdm3/custom.conf=</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="ex">change</span>:  :WaylandEnable=true:</a>
<a class="sourceLine" id="cb208-3" title="3"><span class="ex">by</span>    :  :WaylandEnable=false:</a></code></pre></div></li>
</ol></li>
<li><p>Admin</p>
<ol class="incremental">
<li><p>How to authorize normal user to connect to wifi withouth authenticating as admin ?</p>
<ul class="incremental">
<li>Using the admin account, connect to the wifi</li>
<li>And in the wifi properties, choose:
<ul class="incremental">
<li>"Make available to others users"</li>
<li></li>
</ul></li>
</ul></li>
</ol></li>
<li><p>18.04</p>
<ol class="incremental">
<li><p>X</p>
<ol class="incremental">
<li><p>Normal alt-tab?</p>
<p>From: <a href="https://askubuntu.com/questions/1036248/how-to-separate-opened-windows-in-alttab-switcher-in-ubuntu-18-04">https://askubuntu.com/questions/1036248/how-to-separate-opened-windows-in-alttab-switcher-in-ubuntu-18-04</a></p>
<ul class="incremental">
<li>Go to <code>Settings &gt; Devices &gt; Keyboard</code>.</li>
<li>Choose: "Switch windows"</li>
<li>Assign 'alt-tab' to it</li>
</ul></li>
</ol></li>
<li><p>uninstall snap?</p>
<p>from: <a href="https://stackoverflow.com/questions/50322306/how-to-remove-snap-store-from-ubuntu">https://stackoverflow.com/questions/50322306/how-to-remove-snap-store-from-ubuntu</a></p>
<div class="sourceCode" id="cb209" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb209-1" title="1"><span class="fu">sudo</span> apt autoremove --purge snapd</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol>
<h3 id="backup">Backup</h3>
<ol class="incremental">
<li><p>Bup</p>
<ol class="incremental">
<li><p>bup essentials?</p>
<table>
<thead>
<tr class="header">
<th>category</th>
<th>what?</th>
<th>cmd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>init</td>
<td>init bup in curr dir</td>
<td><code>bup init</code></td>
</tr>
<tr class="even">
<td>save</td>
<td>local backup</td>
<td><code>bup index $d</code></td>
</tr>
<tr class="odd">
<td></td>
<td>- of dir : $d</td>
<td><code>bup save -n ${n} ${d}</code></td>
</tr>
<tr class="even">
<td></td>
<td>- with name: $n</td>
<td></td>
</tr>
<tr class="odd">
<td>restore</td>
<td>Restore local backup</td>
<td><code>bup restore -C ${p} ${n}/${d}</code></td>
</tr>
<tr class="even">
<td></td>
<td>- of dir : $d</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>- with name : $n</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>- at path : $p</td>
<td></td>
</tr>
<tr class="odd">
<td>list</td>
<td>list backup</td>
<td><code>bup ls $n</code></td>
</tr>
<tr class="even">
<td></td>
<td>- with name: $n</td>
<td></td>
</tr>
<tr class="odd">
<td>save</td>
<td>local backup</td>
<td><code>tar cvf $d</code> &lt;pipe&gt; <code>bup split -n $n -vv</code></td>
</tr>
<tr class="even">
<td></td>
<td>- of dir : $d</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>- with name: $n</td>
<td></td>
</tr>
</tbody>
</table></li>
</ol></li>
</ol>
<h2 id="solaris">Solaris</h2>
<h3 id="equivalent-of-linuxs-ps-aux">equivalent of linux's <code>ps aux</code> ?</h3>
<p>maybee not exaclty equiv, but roughly:</p>
<div class="sourceCode" id="cb210" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb210-1" title="1"><span class="fu">ps</span> -AfL</a></code></pre></div>
<h2 id="aix">AIX</h2>
<h3 id="list-all-processes-with-their-corresponding-commands">list all processes with their corresponding commands?</h3>
<div class="sourceCode" id="cb211" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb211-1" title="1"><span class="fu">ps</span> -Af</a></code></pre></div>
<ol class="incremental">
<li><p>How to know the actual amount of ram used by dedup on a particular dataset ?</p>
<p>from: <a href="https://serverfault.com/questions/533877/how-large-is-my-zfs-dedupe-table-at-the-moment">https://serverfault.com/questions/533877/how-large-is-my-zfs-dedupe-table-at-the-moment</a></p>
<div class="sourceCode" id="cb212" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb212-1" title="1"><span class="fu">sudo</span> zpool status -D zpool-docker <span class="kw">|</span> <span class="ex">jq</span> -Rr <span class="st">&#39;capture(&quot;^\\s*dedup: DDT entries (?&lt;ddt&gt;[0-9]+)[^0-9]\\s+size (?&lt;sizeOnDisk&gt;[0-9]+) on disk, (?&lt;inCore&gt;[0-9]+) in core$&quot;) | map_values(fromjson) | { ramUsedForDedupInMBytes: (.ddt * .inCore / (1024 * 1024))}&#39;</span></a></code></pre></div>
<ol class="incremental">
<li><p>common rsync flags?</p>
<div class="sourceCode" id="cb213" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb213-1" title="1"><span class="co"># to copy exactly (like above) plus more feedback:</span></a>
<a class="sourceLine" id="cb213-2" title="2"><span class="fu">rsync</span> -rvza --progress --delete --info=progress2 workspace/ jenkins@localhost:/home/jenkins/workspace</a>
<a class="sourceLine" id="cb213-3" title="3"><span class="co"># even more verbose</span></a>
<a class="sourceLine" id="cb213-4" title="4"><span class="fu">rsync</span> -rvza --progress --delete --info=stats2,misc1,flist0 workspace/ jenkins@localhost:/home/jenkins/workspace</a></code></pre></div></li>
<li><p>Compress / decompress on the fly?</p>
<p>+BEGIN<sub>SRC</sub> sh</p>
<p>mkdir d seq 2 &gt; d/f</p>
<p>tar -cf - d | xz &gt; d.tar.xz</p>
<p>ls #&gt; d d.tar.xz rm -rf d</p>
<p>unxz &lt; d.tar.xz| tar x</p>
<p>ls #&gt; d d.tar.xz cat d/f #&gt; 1 #&gt; 2</p>
<p>+END<sub>SRC</sub></p></li>
<li><p>How to display the actual configuration of the ssh command?</p>
<div class="sourceCode" id="cb214" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb214-1" title="1"><span class="fu">ssh</span> user@host -G</a></code></pre></div>
<p>_</p></li>
<li><p>Signal to control nginx at runtime?</p>
<div class="sourceCode" id="cb215" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb215-1" title="1"><span class="ex">quit</span> – Shut down gracefully</a>
<a class="sourceLine" id="cb215-2" title="2"><span class="ex">reload</span> – Reload the configuration file</a>
<a class="sourceLine" id="cb215-3" title="3"><span class="ex">reopen</span> – Reopen log files</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="ex">stop</span> – Shut down immediately (fast shutdown)</a></code></pre></div></li>
</ol></li>
</ol>
<h1 id="crypto">Crypto</h1>
<h2 id="gpg">Gpg</h2>
<h3 id="how-to-encrypt-symmetric-stdin-without-x-inappropriate-ioctl-for-device">How to encrypt symmetric stdin without X (Inappropriate ioctl for device)?</h3>
<div class="sourceCode" id="cb216" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb216-1" title="1"><span class="co"># Workaround:</span></a>
<a class="sourceLine" id="cb216-2" title="2"><span class="kw">(</span> <span class="bu">export</span> <span class="va">GPG_TTY=$(</span><span class="ex">tty</span><span class="va">)</span> <span class="kw">&amp;&amp;</span> <span class="fu">tar</span> czv f <span class="kw">|</span> <span class="ex">gpg</span> --symmetric  <span class="op">&gt;</span> f.gpg <span class="kw">)</span></a></code></pre></div>
<h3 id="verify-a-gpg-signed-file">verify a gpg signed file?</h3>
<div class="sourceCode" id="cb217" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb217-1" title="1"><span class="ex">gpg</span> --verify file.gpg file</a></code></pre></div>
<h3 id="how-to-import-a-gpg-public-key">how to import a gpg public key?</h3>
<div class="sourceCode" id="cb218" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb218-1" title="1"><span class="va">keyId=</span>7C207910</a>
<a class="sourceLine" id="cb218-2" title="2"><span class="va">keyFingerprint=</span><span class="st">&#39;28D3 BED8 51FD F3AB 57FE F93C 2335 87A4 7C20 7910&#39;</span></a>
<a class="sourceLine" id="cb218-3" title="3"><span class="ex">gpg</span> --keyserver keyserver.ubuntu.com --recv <span class="va">$keyId</span></a>
<a class="sourceLine" id="cb218-4" title="4"><span class="ex">gpg</span> --list-keys --with-fingerprint <span class="va">$keyId</span> <span class="kw">|</span> <span class="fu">tr</span> -s <span class="st">&#39; &#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;</span><span class="va">${keyFingerprint}</span><span class="st">&quot;</span></a></code></pre></div>
<h1 id="non-unixes">Non-unixes</h1>
<h2 id="ms-windows">Ms windows</h2>
<h3 id="vsphere">Vsphere</h3>
<ol class="incremental">
<li><p>when cloning a win vm, how to avoid a duplicate ip adress?</p>
<ul class="incremental">
<li>vsphere: clone the vm :
<ul class="incremental">
<li>but customize the hardware</li>
<li>disable the network card</li>
</ul></li>
<li>Open the vmware console to access the machine:
<ul class="incremental">
<li>win: setup a new ip adress</li>
</ul></li>
<li>vsphere: enable "connect" "connect at startup"</li>
</ul></li>
</ol>
<h3 id="cygwin">Cygwin</h3>
<ol class="incremental">
<li><p>Sshd</p>
<ol class="incremental">
<li><p>start sshd as a service after its installation with the Cygwin installer?</p>
<ol class="incremental">
<li><p>TODO to be verified</p>
<ol class="incremental">
<li>Open a cmd.exe as administrator</li>
<li><p>Run:</p>
<div class="sourceCode" id="cb219" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb219-1" title="1"><span class="ex">cygrunsrv</span> -S sshd</a></code></pre></div>
(from: <a href="https://unix.stackexchange.com/questions/296275/running-sshd-in-cygwin-var-empty-must-be-owned-by-root">https://unix.stackexchange.com/questions/296275/running-sshd-in-cygwin-var-empty-must-be-owned-by-root</a></li>
</ol></li>
</ol></li>
<li><p>install gpg under cygwin?</p>
<p>It's already in the standard Cygwin repo, only called <code>gnupg</code>.</p></li>
</ol></li>
</ol>
<h3 id="cmd.exe">cmd.exe</h3>
<ol class="incremental">
<li><p>windows services cheatsheet?</p>
<ul class="incremental">
<li><p>list all</p>
<div class="sourceCode" id="cb220" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb220-1" title="1"><span class="ex">sc</span> queryex type= service state= all</a></code></pre></div></li>
</ul>
<ul class="incremental">
<li><p>list service containing the string "NATION"?</p>
<div class="sourceCode" id="cb221" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb221-1" title="1"><span class="ex">sc</span> queryex type= service state= all <span class="kw">|</span> <span class="fu">find</span> /i <span class="st">&quot;NATION&quot;</span></a></code></pre></div></li>
</ul></li>
</ol>
<h1 id="docker">Docker</h1>
<h2 id="images-1">Images</h2>
<h3 id="find-images-on-the-command-line">find images on the command line ?</h3>
<p>???</p>
<h3 id="building">Building</h3>
<ol class="incremental">
<li><p>docker build from stdin?</p>
<div class="sourceCode" id="cb222" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb222-1" title="1"><span class="co">#</span></a>
<a class="sourceLine" id="cb222-2" title="2"><span class="co"># docker &lt; 17.05</span></a>
<a class="sourceLine" id="cb222-3" title="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb222-4" title="4"><span class="ex">docker</span> build -t foo -<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb222-5" title="5">FROM busybox</a>
<a class="sourceLine" id="cb222-6" title="6">RUN echo &quot;hello world&quot;</a>
<a class="sourceLine" id="cb222-7" title="7"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb222-8" title="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb222-9" title="9"><span class="co"># docker &gt;= 17.05</span></a>
<a class="sourceLine" id="cb222-10" title="10"><span class="co">#</span></a>
<a class="sourceLine" id="cb222-11" title="11"><span class="ex">docker</span> build -t . -f-<span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb222-12" title="12">FROM busybox</a>
<a class="sourceLine" id="cb222-13" title="13">RUN echo &quot;hello world&quot;</a>
<a class="sourceLine" id="cb222-14" title="14">COPY . /my-copied-files</a>
<a class="sourceLine" id="cb222-15" title="15"><span class="op">EOF</span></a></code></pre></div></li>
</ol>
<h3 id="tags">Tags</h3>
<ol class="incremental">
<li><p>Give a name to an image?</p>
<div class="sourceCode" id="cb223" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb223-1" title="1"><span class="ex">docker</span> tag <span class="op">&lt;</span>srcImgId<span class="op">&gt;</span>   <span class="op">&lt;</span>imgName<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="ex">docker</span> tag 978d85d02b87 firc/foo:1</a></code></pre></div></li>
</ol>
<h2 id="containers">Containers</h2>
<h3 id="docker-runstartexec">docker run/start/exec ?</h3>
<table>
<thead>
<tr class="header">
<th>cmd</th>
<th>descr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>run</td>
<td>run cmd in <strong>new</strong> container</td>
</tr>
<tr class="even">
<td>exec</td>
<td>run cmd in <strong>running</strong> container</td>
</tr>
<tr class="odd">
<td>start</td>
<td>start a <strong>stopped</strong> container</td>
</tr>
</tbody>
</table>
<h2 id="troubleshoot-ubuntu-network">troubleshoot ubuntu network ?</h2>
<ul class="incremental">
<li>ping 8.8.8.8 but no www.google.com ?</li>
<li>incomplete response:</li>
</ul>
<div class="sourceCode" id="cb224" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb224-1" title="1"><span class="co"># Find your network&#39;s DNS server:</span></a>
<a class="sourceLine" id="cb224-2" title="2">$ <span class="ex">nmcli</span> dev show <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;IP4.DNS&#39;</span></a>
<a class="sourceLine" id="cb224-3" title="3"><span class="ex">IP4.DNS</span>[1]:                             10.19.18.25</a>
<a class="sourceLine" id="cb224-4" title="4"></a>
<a class="sourceLine" id="cb224-5" title="5"><span class="co"># Open up /lib/systemd/system/docker.service and add DNS settings to the ExecStart line:</span></a>
<a class="sourceLine" id="cb224-6" title="6"><span class="va">ExecStart=</span>/usr/bin/docker <span class="ex">daemon</span> --dns 8.8.8.8 --dns 10.19.18.25 -H fd://</a></code></pre></div>
<p>From: <a href="http://askubuntu.com/questions/475764/docker-io-dns-doesnt-work-its-trying-to-use-8-8-8-8">http://askubuntu.com/questions/475764/docker-io-dns-doesnt-work-its-trying-to-use-8-8-8-8</a></p>
<h2 id="persistence">Persistence</h2>
<h3 id="repair-docker-after-a-disk-full">repair docker after a disk full?</h3>
<div class="sourceCode" id="cb225" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb225-1" title="1"><span class="ex">service</span> docker stop</a>
<a class="sourceLine" id="cb225-2" title="2"></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="ex">thin_check</span> /var/lib/docker/devicemapper/devicemapper/metadata</a>
<a class="sourceLine" id="cb225-4" title="4"></a>
<a class="sourceLine" id="cb225-5" title="5"><span class="ex">thin_check</span> --clear-needs-check-flag /var/lib/docker/devicemapper/devicemapper/metadata</a>
<a class="sourceLine" id="cb225-6" title="6"></a>
<a class="sourceLine" id="cb225-7" title="7"><span class="ex">service</span> docker start</a>
<a class="sourceLine" id="cb225-8" title="8"></a></code></pre></div>
<p><a href="http://stackoverflow.com/questions/30719896/docker-dm-task-run-failed-error">http://stackoverflow.com/questions/30719896/docker-dm-task-run-failed-error</a></p>
<h2 id="dockerfile">Dockerfile</h2>
<h3 id="use-bashism-in-dockerfile">use bashism in Dockerfile?</h3>
<div class="sourceCode" id="cb226" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb226-1" title="1"><span class="co"># Define bash as the default shell</span></a>
<a class="sourceLine" id="cb226-2" title="2"><span class="ex">SHELL</span> [<span class="st">&quot;bash&quot;</span>, <span class="st">&quot;-c&quot;</span>]</a>
<a class="sourceLine" id="cb226-3" title="3"><span class="co"># or:</span></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="ex">SHELL</span> [<span class="st">&quot;bash&quot;</span>, <span class="st">&quot;-ueo&quot;</span>,<span class="st">&quot;pipefail&quot;</span>, <span class="st">&quot;-c&quot;</span>]</a></code></pre></div>
<h2 id="docker-compose">Docker Compose</h2>
<h3 id="commands-cheatsheet">commands cheatsheet ?</h3>
<table>
<tbody>
<tr class="odd">
<td>cmd</td>
<td>act on</td>
<td>type</td>
<td>target</td>
<td>service</td>
<td>all</td>
<td>descr</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td>state</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>build</td>
<td>img</td>
<td>build</td>
<td>any</td>
<td>Y</td>
<td>Y</td>
<td>Build or rebuild services</td>
</tr>
<tr class="even">
<td>create</td>
<td>cont</td>
<td>lifecycle</td>
<td>any</td>
<td>Y</td>
<td>Y</td>
<td>Create services</td>
</tr>
<tr class="odd">
<td>start</td>
<td>cont</td>
<td>lifecycle</td>
<td>stopped</td>
<td>Y</td>
<td>Y</td>
<td>Start services</td>
</tr>
<tr class="even">
<td>up</td>
<td>cont</td>
<td>lifecycle</td>
<td>stopped</td>
<td>Y</td>
<td>Y</td>
<td>Create and start containers</td>
</tr>
<tr class="odd">
<td>run</td>
<td>cont</td>
<td>lifecycle</td>
<td></td>
<td>Y</td>
<td>N</td>
<td>Run a one-off command</td>
</tr>
<tr class="even">
<td>exec</td>
<td>cont</td>
<td>lifecycle</td>
<td>running</td>
<td>Y</td>
<td>N</td>
<td>Execute a command in a running container</td>
</tr>
<tr class="odd">
<td>stop</td>
<td>cont</td>
<td>lifecycle</td>
<td>stopped</td>
<td>Y</td>
<td>Y</td>
<td>Stop services</td>
</tr>
<tr class="even">
<td>kill</td>
<td>cont</td>
<td>lifecycle</td>
<td>running</td>
<td>Y</td>
<td>Y</td>
<td>Kill containers</td>
</tr>
<tr class="odd">
<td>down</td>
<td>img/cont</td>
<td>lifecycle</td>
<td>running</td>
<td>N</td>
<td>Y</td>
<td>Stop and remove containers, networks, images, and volumes</td>
</tr>
<tr class="even">
<td>rm</td>
<td>cont</td>
<td>lifecycle</td>
<td>stopped</td>
<td>Y</td>
<td>Y</td>
<td>Remove stopped containers</td>
</tr>
<tr class="odd">
<td>restart</td>
<td>cont</td>
<td>lifecycle</td>
<td>running</td>
<td>Y</td>
<td>Y</td>
<td>Restart services</td>
</tr>
<tr class="even">
<td>unpause</td>
<td>cont</td>
<td>lifecycle</td>
<td>paused</td>
<td>Y</td>
<td>Y</td>
<td>Unpause services</td>
</tr>
<tr class="odd">
<td>pause</td>
<td>cont</td>
<td>lifecycle</td>
<td>running</td>
<td>Y</td>
<td>Y</td>
<td>Pause services</td>
</tr>
<tr class="even">
<td>scale</td>
<td>cont</td>
<td>lifecycle</td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>Set number of containers for a service</td>
</tr>
<tr class="odd">
<td>config</td>
<td>compose</td>
<td></td>
<td></td>
<td>N</td>
<td>Y</td>
<td>Validate and view the compose file</td>
</tr>
<tr class="even">
<td>bundle</td>
<td>img</td>
<td></td>
<td></td>
<td>?</td>
<td>?</td>
<td>Generate a Docker bundle from the Compose file</td>
</tr>
<tr class="odd">
<td>pull</td>
<td>img</td>
<td></td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>Pulls service images</td>
</tr>
<tr class="even">
<td>push</td>
<td>img</td>
<td></td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>Push service images</td>
</tr>
<tr class="odd">
<td>events</td>
<td>cont</td>
<td>infos</td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>Receive real time events from containers</td>
</tr>
<tr class="even">
<td>logs</td>
<td>cont</td>
<td>infos</td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>View output from containers</td>
</tr>
<tr class="odd">
<td>port</td>
<td>cont</td>
<td>infos</td>
<td></td>
<td>Y</td>
<td>N</td>
<td>Print the public port for a port binding</td>
</tr>
<tr class="even">
<td>ps</td>
<td>cont</td>
<td>infos</td>
<td></td>
<td>Y</td>
<td>Y</td>
<td>List containers</td>
</tr>
<tr class="odd">
<td>help</td>
<td>special</td>
<td>infos</td>
<td></td>
<td>N</td>
<td>N</td>
<td>Get help on a command</td>
</tr>
<tr class="even">
<td>version</td>
<td>special</td>
<td>infos</td>
<td></td>
<td>N</td>
<td>N</td>
<td>Show the Docker-Compose version information</td>
</tr>
</tbody>
</table>
<h3 id="pass-env-var-at-build-time">pass env var at build time ?</h3>
<p>from: <a href="https://docs.docker.com/compose/compose-file/#cachefrom">https://docs.docker.com/compose/compose-file/#cachefrom</a>:</p>
<div class="sourceCode" id="cb227" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb227-1" title="1"><span class="ex">build</span>:</a>
<a class="sourceLine" id="cb227-2" title="2">  <span class="ex">context</span>: .</a>
<a class="sourceLine" id="cb227-3" title="3">  <span class="ex">args</span>:</a>
<a class="sourceLine" id="cb227-4" title="4">    <span class="ex">buildno</span>: 1</a>
<a class="sourceLine" id="cb227-5" title="5">    <span class="ex">password</span>: secret</a></code></pre></div>
<h2 id="docker-docs">docker docs</h2>
<table>
<thead>
<tr class="header">
<th>what</th>
<th>url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>docker install</td>
<td><a href="https://docs.docker.com/engine/installation/linux/ubuntu/">ubuntu</a></td>
</tr>
<tr class="even">
<td></td>
<td><a href="https://docs.docker.com/engine/installation/linux/centos/">centos</a></td>
</tr>
<tr class="odd">
<td>compose install</td>
<td><a href="https://github.com/docker/compose/releases">any OS</a></td>
</tr>
<tr class="even">
<td>storage drivers in practice</td>
<td><a href="https://docs.docker.com/engine/userguide/storagedriver/aufs-driver/">aufs in practice</a></td>
</tr>
<tr class="odd">
<td></td>
<td><a href="https://docs.docker.com/engine/userguide/storagedriver/device-mapper-driver/">devicemapper in practice</a></td>
</tr>
<tr class="even">
<td></td>
<td><a href="https://docs.docker.com/engine/userguide/storagedriver/device-mapper-driver/">overlay in practice</a></td>
</tr>
<tr class="odd">
<td></td>
<td><a href="https://docs.docker.com/engine/userguide/storagedriver/btrfs-driver/">btrfs in practice</a></td>
</tr>
<tr class="even">
<td></td>
<td><a href="https://docs.docker.com/engine/userguide/storagedriver/zfs-driver/">zfs in practice</a></td>
</tr>
</tbody>
</table>
<h2 id="network-1">Network</h2>
<h3 id="bind-host-lib-and-bin-to-the-guest-to-run-eg-wget">bind host /lib and /bin to the guest to run (eg) wget?</h3>
<div class="sourceCode" id="cb228" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb228-1" title="1"><span class="co"># on the host</span></a>
<a class="sourceLine" id="cb228-2" title="2"><span class="ex">docker</span> run -v /usr/lib/x86_64-linux-gnu:/usr-lib-host -v /lib/x86_64-linux-gnu/:/lib-host -v /usr/bin/:/bin-host -it ubuntu:16.04 bash</a>
<a class="sourceLine" id="cb228-3" title="3"><span class="co"># on the guest</span></a>
<a class="sourceLine" id="cb228-4" title="4"><span class="bu">export</span> <span class="va">LD_LIBRARY_PATH=</span>/lib-host:/usr-lib-host <span class="kw">&amp;&amp;</span> <span class="bu">export</span> <span class="va">PATH=$PATH</span>:/bin-host</a>
<a class="sourceLine" id="cb228-5" title="5"><span class="fu">wget</span> google.com</a></code></pre></div>
<h2 id="dockerhub">DockerHub</h2>
<h3 id="how-to-list-all-tags-of-a-particular-image">How to list all tags of a particular image?</h3>
<div class="sourceCode" id="cb229" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb229-1" title="1"><span class="va">img=</span>jenkins</a>
<a class="sourceLine" id="cb229-2" title="2"><span class="ex">curl</span> <span class="st">&quot;https://registry.hub.docker.com/v1/repositories/</span><span class="va">${img}</span><span class="st">/tags&quot;</span>  <span class="kw">|</span> <span class="ex">jq</span> -c <span class="st">&#39;.[]&#39;</span></a>
<a class="sourceLine" id="cb229-3" title="3"><span class="co">#&gt; {&quot;layer&quot;:&quot;&quot;,&quot;name&quot;:&quot;2.7.3-alpine&quot;}</span></a>
<a class="sourceLine" id="cb229-4" title="4"><span class="co">#&gt; {&quot;layer&quot;:&quot;&quot;,&quot;name&quot;:&quot;2.7.4&quot;}</span></a>
<a class="sourceLine" id="cb229-5" title="5"><span class="co">#&gt; {&quot;layer&quot;:&quot;&quot;,&quot;name&quot;:&quot;2.7.4-alpine&quot;}</span></a></code></pre></div>
<h2 id="misc-2">Misc</h2>
<h3 id="use-stdin-with-a-container">use stdin with a container?</h3>
<div class="sourceCode" id="cb230" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb230-1" title="1"><span class="fu">seq</span> 100 <span class="kw">|</span> <span class="ex">docker</span> run -i syn synesthesia 1</a></code></pre></div>
<h2 id="cli">Cli</h2>
<h3 id="formatting">Formatting</h3>
<ol class="incremental">
<li><p>docker cli command output in json?</p>
<div class="sourceCode" id="cb231" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb231-1" title="1"><span class="ex">docker</span> history opensuse/portus:2.3.5 --format <span class="st">&#39;{{json . }}&#39;</span></a></code></pre></div></li>
</ol>
<h2 id="dockerdistribs">DockerDistribs</h2>
<h3 id="rancheros">RancherOs</h3>
<ol class="incremental">
<li><p>How to switch the default console to ubuntu?</p>
<p>Source: <a href="https://rancher.com/docs/os/v1.2/en/configuration/switching-consoles/">https://rancher.com/docs/os/v1.2/en/configuration/switching-consoles/</a></p>
<div class="sourceCode" id="cb232" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb232-1" title="1"><span class="co"># List available consoles</span></a>
<a class="sourceLine" id="cb232-2" title="2"><span class="fu">sudo</span> ros console list</a>
<a class="sourceLine" id="cb232-3" title="3"><span class="co"># Switch to another console</span></a>
<a class="sourceLine" id="cb232-4" title="4"><span class="fu">sudo</span> ros console switch ubuntu</a></code></pre></div></li>
</ol>
<h1 id="vim">Vim</h1>
<h2 id="yaml">Yaml</h2>
<h3 id="folding-yaml-in-vim">Folding yaml in vim?</h3>
<p>from: <a href="https://lornajane.net/posts/2018/vim-settings-for-working-with-yaml">https://lornajane.net/posts/2018/vim-settings-for-working-with-yaml</a> Starting point, put in your <code>~/.vimrc</code>:</p>
<div class="sourceCode" id="cb233" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb233-1" title="1"><span class="st">&quot; add yaml stuffs</span></a>
<a class="sourceLine" id="cb233-2" title="2"><span class="st">au! BufNewFile,BufReadPost *.{yaml,yml} set filetype=yaml foldmethod=indent</span></a>
<a class="sourceLine" id="cb233-3" title="3"><span class="st">autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab</span></a></code></pre></div>
<h1 id="emacs">Emacs</h1>
<h2 id="file-type-indicator-header-for-emacs">file type indicator header for emacs?</h2>
<div class="sourceCode" id="cb234" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb234-1" title="1"><span class="ex">-*-</span> mode: outline -*-</a></code></pre></div>
<h2 id="edit-a-file-remotely-over-ssh-with-tramp">edit a file remotely over ssh with tramp?</h2>
<div class="sourceCode" id="cb235" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb235-1" title="1"><span class="ex">C-x</span> C-f</a>
<a class="sourceLine" id="cb235-2" title="2">/<span class="op">&lt;</span><span class="ex">user</span><span class="op">&gt;</span>@<span class="op">&lt;</span>host<span class="op">&gt;</span>:<span class="op">&lt;</span>file<span class="op">&gt;</span></a></code></pre></div>
<h2 id="spacemacs">Spacemacs</h2>
<h3 id="install">Install</h3>
<ol class="incremental">
<li><p>"No public key for 066DAFCB81E42C40" ?</p>
<div class="sourceCode" id="cb236" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb236-1" title="1"><span class="ex">gpg</span> --homedir ~/.emacs.d/elpa/gnupg --receive-keys 066DAFCB81E42C40</a></code></pre></div></li>
</ol>
<h3 id="evil-cheat-sheet">evil cheat sheet?</h3>
<table>
<thead>
<tr class="header">
<th>what</th>
<th></th>
<th>cmds</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>general cmd</td>
<td>pattern 1</td>
<td>&lt;cmd&gt; [n] &lt;object&gt;</td>
<td><code>d 3 3</code> # delete 3 words</td>
</tr>
<tr class="even">
<td>"</td>
<td>pattern 2</td>
<td>[n] &lt;cmd&gt; &lt;object&gt;</td>
<td><code>3 d w</code> # delete 3 words</td>
</tr>
<tr class="odd">
<td>undo / redo</td>
<td></td>
<td>u / ctrl-r</td>
<td></td>
</tr>
<tr class="even">
<td>put (after copy)</td>
<td></td>
<td>p</td>
<td></td>
</tr>
<tr class="odd">
<td>change word</td>
<td></td>
<td>cw</td>
<td></td>
</tr>
<tr class="even">
<td>go to a specific line number</td>
<td></td>
<td>:&lt;lineNb&gt;</td>
<td></td>
</tr>
<tr class="odd">
<td>search and replace</td>
<td>current line</td>
<td>:s/search/repl/[g]</td>
<td></td>
</tr>
<tr class="even">
<td>"</td>
<td>between lines N and M</td>
<td>:N,Ms/search/repl/[g]</td>
<td></td>
</tr>
<tr class="odd">
<td>"</td>
<td>whole buffer</td>
<td>%s/search/repl/[g]</td>
<td></td>
</tr>
<tr class="even">
<td>locate matching parentesis (or curly, …)</td>
<td></td>
<td>%</td>
<td></td>
</tr>
<tr class="odd">
<td>regex modifier to confirm before each replace?</td>
<td></td>
<td>c: s/search/repl/gc</td>
<td></td>
</tr>
<tr class="even">
<td>write current file</td>
<td></td>
<td>:w</td>
<td></td>
</tr>
<tr class="odd">
<td>save as &lt;newName&gt;</td>
<td></td>
<td>:w &lt;newName&gt;</td>
<td></td>
</tr>
<tr class="even">
<td>page up / page down</td>
<td></td>
<td>C-j C-k</td>
<td></td>
</tr>
<tr class="odd">
<td>insert the content of a file in the current buffer</td>
<td></td>
<td>:r &lt;filename&gt;</td>
<td></td>
</tr>
<tr class="even">
<td>insert new line</td>
<td>below</td>
<td>o</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>above</td>
<td>O</td>
<td></td>
</tr>
<tr class="even">
<td>replace (like replace mode - opposite of insert)</td>
<td></td>
<td>R</td>
<td></td>
</tr>
<tr class="odd">
<td>append at the end of the line</td>
<td></td>
<td>A</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="run-a-command-and-get-the-output-in-the-current-buffer">run a command and get the output in the current buffer?</h3>
<ol class="incremental">
<li><p>Emacs</p>
<p><code>C-u M-! &lt;shell-command&gt;</code></p></li>
<li><p>fix error when installing spacemacs: "No such file or directory, evil"?</p>
<p>May be a simply missing gpg elpa key:</p>
<div class="sourceCode" id="cb237" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb237-1" title="1"><span class="ex">gpg</span> --homedir ~/.emacs.d/elpa/gnupg --receive-keys 066DAFCB81E42C40</a></code></pre></div></li>
<li><p>Spacemacs (evil mode)</p>
<p><code>SPC u SPC ! &lt;shell-command&gt;</code></p></li>
</ol>
<h3 id="universal-argument-in-spacemacs-evil-mode">Universal argument in spacemacs (evil mode)?</h3>
<p>instead of the traditional <code>C-u</code> <code>SPC u</code></p>
<h3 id="project">Project</h3>
<ol class="incremental">
<li><p><code>helm-project-do-ag</code> how to filter by file types?</p>
<ul class="incremental">
<li>Example, searching for:
<ul class="incremental">
<li><code>*.clj</code> files</li>
<li>containing <code>defn</code></li>
</ul></li>
</ul>
<p><code>SPC s a p</code> <code>--clojure defn</code></p></li>
<li><p>search and replace in project?</p>
<table>
<tbody>
<tr class="odd">
<td>search string in project</td>
<td><code>helm-project-do-ag</code></td>
<td><code>SPC s a p</code></td>
</tr>
<tr class="even">
<td>edit the search results</td>
<td></td>
<td><code>C-c C-e</code></td>
</tr>
<tr class="odd">
<td>commit the changes</td>
<td></td>
<td><code>C-c C-c</code></td>
</tr>
</tbody>
</table></li>
</ol>
<h3 id="searchandreplace">SearchAndReplace</h3>
<ol class="incremental">
<li><p>How to search and replace starting at the cursor position?</p>
<div class="sourceCode" id="cb238" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb238-1" title="1">:<span class="ex">.</span>,<span class="va">$s</span>/\vBEFORE/AFTER/gc</a></code></pre></div></li>
</ol>
<h3 id="folding">Folding</h3>
<ol class="incremental">
<li><p>a promising mode?</p>
<ul class="incremental">
<li>hint: <code>spacemacs/fold-transient-state/evil-close-fold</code></li>
</ul></li>
</ol>
<h3 id="misc-3">Misc</h3>
<ol class="incremental">
<li><p>Exit emacs mode (holy mode) entered by error?</p>
<p>Exit holy mode:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>in holy mode</th>
<th>in evil mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>spacemacs/toggle-holy-mode</td>
<td><code>M-m t E e</code></td>
<td><code>SPC t E e</code></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ol class="incremental">
<li><p>pipe in table with code block</p>
<ul class="incremental">
<li>create the table in org mode</li>
</ul>
<table>
<thead>
<tr class="header">
<th>x</th>
<th>l</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cmd1</td>
<td>cmd</td>
</tr>
<tr class="even">
<td>cmd2</td>
<td>cmd &lt;pipe&gt; cmdx</td>
</tr>
</tbody>
</table>
<ul class="incremental">
<li><p>copy and pase the table in a code block and add the missing pipes:</p>
#+BEGIN<sub>SRC</sub> sh</li>
</ul>
<table>
<thead>
<tr class="header">
<th>x</th>
<th>l</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cmd1</td>
<td>cmd</td>
</tr>
<tr class="even">
<td>cmd2</td>
<td>cmd</td>
</tr>
</tbody>
</table>
<p>#+END<sub>SRC</sub></p></li>
<li><p>TODO org mode how to use pipes in tables? [0%]</p>
<ol class="incremental">
<li><p>TODO using contants?</p>
<table>
<thead>
<tr class="header">
<th>name</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>c</td>
<td>$c</td>
</tr>
<tr class="even">
<td>pi</td>
<td>$pi</td>
</tr>
<tr class="odd">
<td>eps</td>
<td>$eps</td>
</tr>
</tbody>
</table></li>
<li><p>TODO macros?</p></li>
<li><p>TODO latex?</p></li>
<li><p>TODO html?</p></li>
<li><p>TODO compute cells values ?</p></li>
</ol></li>
</ol></li>
</ol>
<h3 id="twbs-export-html">twbs export html</h3>
<p>Controlling html output?</p>
<div class="sourceCode" id="cb239" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb239-1" title="1"><span class="co">#+OPTIONS: num:5 whn:2 toc:4 H:6</span></a>
<a class="sourceLine" id="cb239-2" title="2"><span class="ex">And</span> to set these via your publish configuration using the org-publish-project-alist, the options would be :section-numbers, :headline-levels and :with-toc.</a>
<a class="sourceLine" id="cb239-3" title="3"></a>
<a class="sourceLine" id="cb239-4" title="4"><span class="ex">The</span> above options are described in the export settings section of the orgmode manual. This component introduces a new setting whn for per document, and :with-headline-numbers for publish config, which controls the display of section numbers. To disable, set to nil, to enable, set to t, and to control depth of display, use a whole number.</a></code></pre></div>
<p>from: <a href="https://github.com/marsmining/ox-twbs">https://github.com/marsmining/ox-twbs</a></p>
<h3 id="easy-templates">easy templates?</h3>
<p>from: <a href="http://orgmode.org/manual/Easy-Templates.html#Easy-Templates">http://orgmode.org/manual/Easy-Templates.html#Easy-Templates</a></p>
<table>
<tbody>
<tr class="odd">
<td>s</td>
<td><code>#+BEGIN_SRC ... #+END_SRC</code></td>
</tr>
<tr class="even">
<td>e</td>
<td><code>#+BEGIN_EXAMPLE ... #+END_EXAMPLE</code></td>
</tr>
<tr class="odd">
<td>q</td>
<td><code>#+BEGIN_QUOTE ... #+END_QUOTE</code></td>
</tr>
<tr class="even">
<td>v</td>
<td><code>#+BEGIN_VERSE ... #+END_VERSE</code></td>
</tr>
<tr class="odd">
<td>c</td>
<td><code>#+BEGIN_CENTER ... #+END_CENTER</code></td>
</tr>
<tr class="even">
<td>l</td>
<td><code>#+BEGIN_LaTeX ... #+END_LaTeX</code></td>
</tr>
<tr class="odd">
<td>L</td>
<td><code>#+LaTeX:</code></td>
</tr>
<tr class="even">
<td>h</td>
<td><code>#+BEGIN_HTML ... #+END_HTML</code></td>
</tr>
<tr class="odd">
<td>H</td>
<td><code>#+HTML:</code></td>
</tr>
<tr class="even">
<td>a</td>
<td><code>#+BEGIN_ASCII ... #+END_ASCII</code></td>
</tr>
<tr class="odd">
<td>A</td>
<td><code>#+ASCII:</code></td>
</tr>
<tr class="even">
<td>i</td>
<td><code>#+INDEX: line</code></td>
</tr>
<tr class="odd">
<td>I</td>
<td><code>#+INCLUDE: line</code></td>
</tr>
</tbody>
</table>
<h3 id="babel">Babel</h3>
<ol class="incremental">
<li><p>"eval is disabled for shell"</p>
<ol class="incremental">
<li><p>add to your init file</p>
<p><strong>use <code>shell</code> and not <code>sh</code></strong></p>
<pre class="elisp"><code>  (org-babel-do-load-languages
  &#39;org-babel-load-languages
  &#39;(
  (js         . t)
  ;; (sh         . t)
  (emacs-lisp . t)
  (shell      . t)
  (clojure    . t)
))
</code></pre></li>
<li><p>in the org mode file</p>
<pre class="example"><code>#+BEGIN_SRC sh
f() { echo &quot;I&#39;m f!&quot; ; }
export -f f
bash -c f
#+END_SRC
</code></pre></li>
<li><p>stop emacs</p></li>
<li><p>remove the folder <code>~/.emacs.d/elpa/org-plus-contrib-*</code></p></li>
<li><p>start emacs</p></li>
<li><p>try to eval with <code>C-c C-c</code></p></li>
</ol></li>
</ol>
<h2 id="install-emacs25-on-ubuntu16.04">install emacs25 on ubuntu16.04?</h2>
<div class="sourceCode" id="cb242" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb242-1" title="1"><span class="bu">cd</span></a>
<a class="sourceLine" id="cb242-2" title="2"><span class="fu">mkdir</span> emacs25.install</a>
<a class="sourceLine" id="cb242-3" title="3"><span class="bu">cd</span> emacs25.install</a>
<a class="sourceLine" id="cb242-4" title="4"><span class="co"># install preReqs</span></a>
<a class="sourceLine" id="cb242-5" title="5"><span class="fu">sudo</span> apt install build-essential checkinstall</a>
<a class="sourceLine" id="cb242-6" title="6"><span class="co"># install build deps (same for emacs24 or 25)</span></a>
<a class="sourceLine" id="cb242-7" title="7"><span class="fu">sudo</span> apt-get build-dep emacs24</a>
<a class="sourceLine" id="cb242-8" title="8"><span class="co"># Download emacs25 src</span></a>
<a class="sourceLine" id="cb242-9" title="9"><span class="fu">wget</span> http://ftp.igh.cnrs.fr/pub/gnu/emacs/emacs-25.1.tar.<span class="dt">{xz,xz.sig}</span></a>
<a class="sourceLine" id="cb242-10" title="10"><span class="va">keyId=</span>7C207910</a>
<a class="sourceLine" id="cb242-11" title="11"><span class="va">keyFingerprint=</span><span class="st">&#39;28D3 BED8 51FD F3AB 57FE F93C 2335 87A4 7C20 7910&#39;</span></a>
<a class="sourceLine" id="cb242-12" title="12"><span class="ex">gpg</span> --keyserver keyserver.ubuntu.com --recv <span class="st">&quot;</span><span class="va">${keyId}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb242-13" title="13"><span class="ex">gpg</span> --list-keys --with-fingerprint <span class="st">&quot;</span><span class="va">${keyId}</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">tr</span> -s <span class="st">&#39; &#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;</span><span class="va">${keyFingerprint}</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb242-14" title="14"><span class="co"># build</span></a>
<a class="sourceLine" id="cb242-15" title="15"><span class="bu">cd</span> emacs-25.1</a>
<a class="sourceLine" id="cb242-16" title="16"><span class="ex">./configure</span></a>
<a class="sourceLine" id="cb242-17" title="17"><span class="fu">make</span></a>
<a class="sourceLine" id="cb242-18" title="18"><span class="co"># install</span></a>
<a class="sourceLine" id="cb242-19" title="19"><span class="fu">sudo</span> checkinstall</a></code></pre></div>
<h1 id="web-1">Web</h1>
<h2 id="browsers">Browsers</h2>
<h3 id="firefox">Firefox</h3>
<ol class="incremental">
<li><p>Disable images loading?</p>
<p>go to <a href="about:config">about:config</a> firefox<sub>profile</sub>.set<sub>preference</sub>('permissions.default.image', 2)</p></li>
</ol>
<h3 id="chrome">Chrome</h3>
<ol class="incremental">
<li><p>How to keep a Chrome background active (eg: for avoiding sessions timeouts)?</p>
<ol class="incremental">
<li><p>Possible option1: Use Chrome build-in <code>ctrl-shift-click</code></p>
<ol class="incremental">
<li><p>STARTED 1) use the buit-in chrome shortcut [0/1]</p>
<p><code>ctrl-click</code> on link open a link in another background. <code>ctrl-shift-click</code> open a link in another tag <strong>and keep it active</strong>.</p>
<ol class="incremental">
<li><p>STARTED to be verified</p>
<p>It seems to work be needs to be used for a few days to be definitvely validated</p></li>
</ol></li>
</ol></li>
<li><p>TODO Possible option2: Use an extension like <code>Tab Reloader</code></p>
<p><a href="https://chrome.google.com/webstore/detail/tab-reloader-page-auto-re/dejobinhdiimklegodgbmbifijpppopn">https://chrome.google.com/webstore/detail/tab-reloader-page-auto-re/dejobinhdiimklegodgbmbifijpppopn</a></p>
<ol class="incremental">
<li><p>TODO to check</p></li>
</ol></li>
</ol></li>
</ol>
<h1 id="programming-1">Programming</h1>
<h2 id="jvm-ecosystem">JVM ecosystem</h2>
<h3 id="groovy">Groovy</h3>
<ol class="incremental">
<li><p>pipeline oriented programming in groovy like Clojure's threading macro?</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb243-1" title="1"><span class="bu">Collection</span>.<span class="fu">metaClass</span>.<span class="fu">or</span> = { Closure c -&gt; delegate.<span class="fu">collect</span> c }</a>
<a class="sourceLine" id="cb243-2" title="2"></a>
<a class="sourceLine" id="cb243-3" title="3"><span class="fu">assert</span>(</a>
<a class="sourceLine" id="cb243-4" title="4">        [<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb243-5" title="5">      | {it + <span class="dv">1</span>}</a>
<a class="sourceLine" id="cb243-6" title="6">      | {it * <span class="dv">2</span>}) == [<span class="dv">4</span>]</a></code></pre></div></li>
<li><p>groovy switch case?</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb244-1" title="1"><span class="kw">switch</span>(val) {</a>
<a class="sourceLine" id="cb244-2" title="2">  <span class="kw">case</span> ~/ab.*/:</a>
<a class="sourceLine" id="cb244-3" title="3">    result=<span class="st">&quot;x&quot;</span></a>
<a class="sourceLine" id="cb244-4" title="4">    <span class="kw">break</span></a>
<a class="sourceLine" id="cb244-5" title="5">  <span class="kw">case</span> ...</a>
<a class="sourceLine" id="cb244-6" title="6">  <span class="kw">default</span>:</a>
<a class="sourceLine" id="cb244-7" title="7">    ...</a>
<a class="sourceLine" id="cb244-8" title="8">    <span class="kw">break</span></a>
<a class="sourceLine" id="cb244-9" title="9">}</a></code></pre></div></li>
<li><p>groovy interval ?</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb245-1" title="1">(<span class="fl">1..10</span>).<span class="fu">each</span>{prinltn it}</a></code></pre></div></li>
<li><p>get cmd line args?</p>
<div class="sourceCode" id="cb246" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb246-1" title="1"><span class="ex">println</span>(args)</a></code></pre></div></li>
<li><p>run a system command in groovy ?</p>
<p>see: <a href="http://docs.groovy-lang.org/latest/html/documentation/working-with-io.html">http://docs.groovy-lang.org/latest/html/documentation/working-with-io.html</a></p>
<div class="sourceCode" id="cb247" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb247-1" title="1"><span class="ex">def</span> process = <span class="st">&quot;ls -l&quot;</span>.execute()</a>
<a class="sourceLine" id="cb247-2" title="2"><span class="ex">println</span> <span class="st">&quot;Found text </span><span class="va">${process</span><span class="er">.text</span><span class="va">}</span><span class="st">&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb248" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb248-1" title="1"><span class="ex">def</span> process = <span class="st">&quot;ls -l&quot;</span>.execute()</a>
<a class="sourceLine" id="cb248-2" title="2"><span class="ex">process.in.eachLine</span> { line -<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb248-3" title="3">    <span class="ex">println</span> line</a>
<a class="sourceLine" id="cb248-4" title="4">}</a></code></pre></div>
<div class="sourceCode" id="cb249" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb249-1" title="1">    <span class="ex">def</span> p = <span class="st">&quot;rm -f foo.tmp&quot;</span>.execute([], tmpDir)</a>
<a class="sourceLine" id="cb249-2" title="2"><span class="ex">p.consumeProcessOutput</span>()</a>
<a class="sourceLine" id="cb249-3" title="3"><span class="ex">p.waitFor</span>()</a></code></pre></div></li>
<li><p>groovy pprint datastructure?</p>
<p>from: <a href="https://gist.github.com/esycat/6410360">https://gist.github.com/esycat/6410360</a></p>
<div class="sourceCode" id="cb250" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb250-1" title="1"><span class="ex">import</span> static groovy.json.JsonOutput.*</a>
<a class="sourceLine" id="cb250-2" title="2"><span class="ex">def</span> config = [<span class="st">&#39;test&#39;</span>: <span class="st">&#39;lalala&#39;</span>]</a>
<a class="sourceLine" id="cb250-3" title="3"><span class="ex">println</span> prettyPrint(toJson(config))</a></code></pre></div></li>
</ol>
<h3 id="java">Java</h3>
<ol class="incremental">
<li><p>Create an object with the same behavior than System.out (for testing output)?</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb251-1" title="1"><span class="bu">ByteArrayOutputStream</span> os = <span class="kw">new</span> <span class="bu">ByteArrayOutputStream</span>();</a>
<a class="sourceLine" id="cb251-2" title="2"><span class="bu">PrintStream</span> ps = <span class="kw">new</span> <span class="bu">PrintStream</span>(os);</a>
<a class="sourceLine" id="cb251-3" title="3">...</a>
<a class="sourceLine" id="cb251-4" title="4"><span class="bu">String</span> output = os.<span class="fu">toString</span>(<span class="st">&quot;UTF8&quot;</span>);</a></code></pre></div>
<p><a href="http://stackoverflow.com/questions/1760654/java-printstream-to-string">http://stackoverflow.com/questions/1760654/java-printstream-to-string</a></p></li>
<li><p>timestamp in java ?</p>
<div class="sourceCode" id="cb252" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb252-1" title="1">     <span class="ex">import</span> java.text.SimpleDateFormat<span class="kw">;</span></a>
<a class="sourceLine" id="cb252-2" title="2">     <span class="ex">SimpleDateFormat</span> sdf sdf = new SimpleDateFormat(<span class="st">&quot;yyyyMMdd-HHmmSS&quot;</span>);</a>
<a class="sourceLine" id="cb252-3" title="3">     <span class="ex">String</span> yyyyMMdd = sdf.format(new java.util.Date());</a>
<a class="sourceLine" id="cb252-4" title="4"></a>
<a class="sourceLine" id="cb252-5" title="5"><span class="ex">Reference</span>:</a>
<a class="sourceLine" id="cb252-6" title="6"><span class="ex">Update</span>: the question by The Elite Gentleman is important. If you start with a String , then you should first parse it to obtain the date object from the above example:</a>
<a class="sourceLine" id="cb252-7" title="7"><span class="ex">Date</span> date = new SimpleDateFormat(<span class="st">&quot;dd MMM yyyy&quot;</span>)<span class="ex">.parse</span>(dateString);</a>
<a class="sourceLine" id="cb252-8" title="8"></a>
<a class="sourceLine" id="cb252-9" title="9"></a></code></pre></div></li>
</ol>
<h3 id="gradle">Gradle</h3>
<ol class="incremental">
<li><p>how to create a new project from scratch?</p>
<div class="sourceCode" id="cb253" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb253-1" title="1"><span class="ex">gradle</span> init --type basic</a></code></pre></div></li>
</ol>
<h3 id="maven">Maven</h3>
<ol class="incremental">
<li><p>simply download a jar with maven?</p>
<ol class="incremental">
<li><p>simple</p>
<div class="sourceCode" id="cb254" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb254-1" title="1"><span class="co"># Note: -U always update remote releases and snapshot repositoryies</span></a>
<a class="sourceLine" id="cb254-2" title="2"><span class="ex">mvn</span> -U dependency:get -Dartifact=org.springframework:spring-instrument:3.2.3.RELEASE</a></code></pre></div>
<p>See: <a href="http://stackoverflow.com/questions/7110114/how-to-simply-download-a-jar-using-maven">http://stackoverflow.com/questions/7110114/how-to-simply-download-a-jar-using-maven</a></p></li>
<li><p>specifying transitivity and repo</p>
<div class="sourceCode" id="cb255" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb255-1" title="1"><span class="ex">mvn</span> dependency:get -DremoteRepositories=https://repo.jenkins-ci.org/releases \</a>
<a class="sourceLine" id="cb255-2" title="2">  -Dartifact=org.jenkins-ci.plugins:swarm-client:3.4                         \</a>
<a class="sourceLine" id="cb255-3" title="3">  -Dtransitive=false</a></code></pre></div></li>
</ol></li>
<li><p>generate a simple maven project?</p>
<div class="sourceCode" id="cb256" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb256-1" title="1"><span class="co"># full list</span></a>
<a class="sourceLine" id="cb256-2" title="2"><span class="ex">mvn</span> archetype:generate</a>
<a class="sourceLine" id="cb256-3" title="3"><span class="co"># only with groupId org.apache.maven.archetypes:</span></a>
<a class="sourceLine" id="cb256-4" title="4"><span class="ex">mvn</span> archetype:generate -Dfilter=org.apache.maven.archetypes:</a>
<a class="sourceLine" id="cb256-5" title="5"><span class="co"># good for quick start:</span></a>
<a class="sourceLine" id="cb256-6" title="6"><span class="ex">mvn</span> archetype:generate -Dfilter=maven-archetype-quickstar</a>
<a class="sourceLine" id="cb256-7" title="7"><span class="co"># or</span></a>
<a class="sourceLine" id="cb256-8" title="8"><span class="ex">mvn</span> archetype:generate -Dfilter=maven-archetype-webapp</a>
<a class="sourceLine" id="cb256-9" title="9"><span class="co"># or</span></a>
<a class="sourceLine" id="cb256-10" title="10"><span class="ex">mvn</span> archetype:generate -Dfilter=maven-archetype-simple</a></code></pre></div></li>
<li><p>generate a simple webapp?</p>
<div class="sourceCode" id="cb257" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb257-1" title="1"><span class="ex">mvn</span> archetype:generate                         \</a>
<a class="sourceLine" id="cb257-2" title="2">  -DgroupId=com.mycompany.app                  \</a>
<a class="sourceLine" id="cb257-3" title="3">  -DartifactId=my-app                          \</a>
<a class="sourceLine" id="cb257-4" title="4">  -DarchetypeArtifactId=maven-archetype-webapp \</a>
<a class="sourceLine" id="cb257-5" title="5">  -DinteractiveMode=false</a></code></pre></div></li>
</ol>
<h3 id="clojure">Clojure</h3>
<ol class="incremental">
<li><p>Dev</p>
<ol class="incremental">
<li><p>Repl</p>
<ol class="incremental">
<li><p>Change the alias of a ns in a ns def (Alias &lt;alias&gt; already exists in namespace &lt;ns&gt;,etc)?</p>
<p>If the ns is: <code>user.ns</code> and the alias is <code>alias</code>:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb258-1" title="1">(<span class="kw">ns-unalias</span> (<span class="kw">find-ns</span> <span class="at">&#39;user.ns</span>) <span class="at">&#39;alias</span>)</a></code></pre></div></li>
<li><p>List all ns?</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb259-1" title="1">(<span class="kw">all-ns</span>)</a></code></pre></div></li>
</ol></li>
<li><p>Strings</p>
<ol class="incremental">
<li><p>ByteArrayInputStream to string?</p>
<p>Use <code>slurp</code>:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb260-1" title="1">  (<span class="kw">let</span> [s <span class="st">&quot;foo&quot;</span></a>
<a class="sourceLine" id="cb260-2" title="2">       sb (java.io.ByteArrayInputStream. (.getBytes s))</a>
<a class="sourceLine" id="cb260-3" title="3">       ]</a>
<a class="sourceLine" id="cb260-4" title="4">   (<span class="kw">slurp</span> sb))</a>
<a class="sourceLine" id="cb260-5" title="5">#&gt; <span class="st">&quot;foo&quot;</span></a></code></pre></div></li>
<li><p>Convert a string to a regex?</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb261-1" title="1">(<span class="kw">re-pattern</span> <span class="st">&quot;a.*b&quot;</span>)</a></code></pre></div></li>
</ol></li>
<li><p>Protocols</p>
<ol class="incremental">
<li><p>Full example of protocole usage for fast &amp; simple polymorphic dispatch on a single type?</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb262-1" title="1"> <span class="co">;; pro ns ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb262-2" title="2"></a>
<a class="sourceLine" id="cb262-3" title="3"> (<span class="kw">ns</span> pro</a>
<a class="sourceLine" id="cb262-4" title="4">   (<span class="at">:require</span> [clj-time.<span class="kw">format</span> <span class="at">:as</span> tf]</a>
<a class="sourceLine" id="cb262-5" title="5">             [clj-time.coerce <span class="at">:as</span> tc])</a>
<a class="sourceLine" id="cb262-6" title="6">   (<span class="at">:import</span> [org.joda.<span class="kw">time</span> DateTime]</a>
<a class="sourceLine" id="cb262-7" title="7">            [java.util Date]))</a>
<a class="sourceLine" id="cb262-8" title="8"></a>
<a class="sourceLine" id="cb262-9" title="9"> <span class="co">;; Define the interface</span></a>
<a class="sourceLine" id="cb262-10" title="10"> (<span class="bu">defprotocol</span><span class="fu"> XmlNode</span></a>
<a class="sourceLine" id="cb262-11" title="11">   (as-xml [this]))</a>
<a class="sourceLine" id="cb262-12" title="12"></a>
<a class="sourceLine" id="cb262-13" title="13"> <span class="co">;; Define implementation that are dispached on existing types</span></a>
<a class="sourceLine" id="cb262-14" title="14"> <span class="co">;; Protocols can be extended to existing types and user defined types</span></a>
<a class="sourceLine" id="cb262-15" title="15"> (<span class="kw">extend-protocol</span> XmlNode</a>
<a class="sourceLine" id="cb262-16" title="16">   Integer  (as-xml [this] (<span class="kw">str</span> this))</a>
<a class="sourceLine" id="cb262-17" title="17">   String   (as-xml [this] (<span class="kw">identity</span> this))</a>
<a class="sourceLine" id="cb262-18" title="18">   Date     (as-xml [this] (.<span class="kw">format</span> (java.text.SimpleDateFormat. <span class="st">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) this))</a>
<a class="sourceLine" id="cb262-19" title="19">   DateTime (as-xml [this] (<span class="kw">-&gt;&gt;</span> this</a>
<a class="sourceLine" id="cb262-20" title="20">                                tc/to-long</a>
<a class="sourceLine" id="cb262-21" title="21">                                (#(<span class="kw">/</span> <span class="va">%</span> <span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb262-22" title="22">                                <span class="kw">long</span>)))</a>
<a class="sourceLine" id="cb262-23" title="23"></a>
<a class="sourceLine" id="cb262-24" title="24"> <span class="co">;; And even on your own custom types</span></a>
<a class="sourceLine" id="cb262-25" title="25"> (<span class="bu">defrecord</span><span class="fu"> User </span>[^Integer id ^String <span class="kw">name</span> ^java.util.Date dob])</a>
<a class="sourceLine" id="cb262-26" title="26"></a>
<a class="sourceLine" id="cb262-27" title="27"> (<span class="kw">extend-protocol</span> XmlNode</a>
<a class="sourceLine" id="cb262-28" title="28">   User</a>
<a class="sourceLine" id="cb262-29" title="29">   (as-xml [this] (<span class="kw">str</span> <span class="st">&quot;&lt;user&gt;&quot;</span></a>
<a class="sourceLine" id="cb262-30" title="30">                       <span class="st">&quot;&lt;id&gt;&quot;</span> (as-xml (<span class="at">:id</span> this)) <span class="st">&quot;&lt;/id&gt;&quot;</span></a>
<a class="sourceLine" id="cb262-31" title="31">                       <span class="st">&quot;&lt;name&gt;&quot;</span> (as-xml (<span class="at">:name</span> this)) <span class="st">&quot;&lt;/name&gt;&quot;</span></a>
<a class="sourceLine" id="cb262-32" title="32">                       <span class="st">&quot;&lt;dob&gt;&quot;</span> (as-xml (<span class="at">:dob</span> this)) <span class="st">&quot;&lt;/dob&gt;&quot;</span></a>
<a class="sourceLine" id="cb262-33" title="33">                       <span class="st">&quot;&lt;/user&gt;&quot;</span>)))</a>
<a class="sourceLine" id="cb262-34" title="34"></a>
<a class="sourceLine" id="cb262-35" title="35"> <span class="co">;; pro-test ns ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb262-36" title="36"></a>
<a class="sourceLine" id="cb262-37" title="37"> (<span class="kw">ns</span> pro-test</a>
<a class="sourceLine" id="cb262-38" title="38">   (<span class="at">:require</span> [pro <span class="at">:refer</span> <span class="at">:all</span>]</a>
<a class="sourceLine" id="cb262-39" title="39">             [clojure.<span class="kw">test</span> <span class="at">:refer</span> <span class="at">:all</span>]</a>
<a class="sourceLine" id="cb262-40" title="40">             [clj-time.core <span class="at">:as</span> t]))</a>
<a class="sourceLine" id="cb262-41" title="41"></a>
<a class="sourceLine" id="cb262-42" title="42"> (<span class="bu">deftest</span><span class="fu"> as-xml-test</span></a>
<a class="sourceLine" id="cb262-43" title="43">  (<span class="kw">testing</span> <span class="st">&quot;int&quot;</span>            (<span class="kw">is</span> (<span class="kw">=</span> <span class="st">&quot;1&quot;</span>                   (as-xml (<span class="kw">int</span>             <span class="dv">1</span>            )))))</a>
<a class="sourceLine" id="cb262-44" title="44">  (<span class="kw">testing</span> <span class="st">&quot;joda-time&quot;</span>      (<span class="kw">is</span> (<span class="kw">=</span> <span class="dv">1577836800</span>            (as-xml (t/date-time     <span class="dv">2020</span>         )))))</a>
<a class="sourceLine" id="cb262-45" title="45">  (<span class="kw">testing</span> <span class="st">&quot;java.util.date&quot;</span> (<span class="kw">is</span> (<span class="kw">=</span> <span class="st">&quot;2001-09-09 01:46:40&quot;</span> (as-xml (java.util.Date. <span class="dv">1000000000000</span>)))))</a>
<a class="sourceLine" id="cb262-46" title="46">  (<span class="kw">testing</span> <span class="st">&quot;User&quot;</span>           (<span class="kw">is</span> (<span class="kw">=</span> <span class="st">&quot;&lt;user&gt;&lt;id&gt;0&lt;/id&gt;&lt;name&gt;john&lt;/name&gt;&lt;dob&gt;473385600&lt;/dob&gt;&lt;/user&gt;&quot;</span></a>
<a class="sourceLine" id="cb262-47" title="47">                                                         (as-xml (-&gt;User <span class="st">&quot;0&quot;</span> <span class="st">&quot;john&quot;</span> (t/date-time <span class="dv">1985</span>)))))))</a>
<a class="sourceLine" id="cb262-48" title="48"></a>
<a class="sourceLine" id="cb262-49" title="49"> # +END_SRC</a>
<a class="sourceLine" id="cb262-50" title="50">***** Modulo/quotient/reminder?</a>
<a class="sourceLine" id="cb262-51" title="51">#+BEGIN_SRC sh</a>
<a class="sourceLine" id="cb262-52" title="52">(<span class="kw">mod</span> <span class="dv">5</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb262-53" title="53">#&gt; <span class="dv">1</span></a>
<a class="sourceLine" id="cb262-54" title="54">(<span class="kw">quot</span> <span class="dv">5</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb262-55" title="55">#&gt; <span class="dv">2</span></a>
<a class="sourceLine" id="cb262-56" title="56">(<span class="kw">rem</span> <span class="dv">5</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb262-57" title="57">#&gt; <span class="dv">1</span></a>
<a class="sourceLine" id="cb262-58" title="58">(<span class="kw">let</span> [a     <span class="dv">5</span></a>
<a class="sourceLine" id="cb262-59" title="59">      b     <span class="dv">2</span></a>
<a class="sourceLine" id="cb262-60" title="60">      q     (<span class="kw">quot</span> a b)</a>
<a class="sourceLine" id="cb262-61" title="61">      r     (<span class="kw">rem</span> r b)</a>
<a class="sourceLine" id="cb262-62" title="62">      q*b+r (<span class="kw">+</span> (<span class="kw">*</span> q b) r)]</a>
<a class="sourceLine" id="cb262-63" title="63"> (<span class="kw">=</span> q*b+r a))</a>
<a class="sourceLine" id="cb262-64" title="64">#&gt; <span class="va">true</span></a></code></pre></div></li>
</ol></li>
<li><p>Lein</p>
<ol class="incremental">
<li><p>Show dependencies tree?</p>
<div class="sourceCode" id="cb263" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb263-1" title="1"><span class="ex">lein</span> pom</a>
<a class="sourceLine" id="cb263-2" title="2"><span class="ex">mvn</span> dependency:tree -Dverbose=true</a></code></pre></div></li>
<li><p>Connect to an existing nrepl process?</p>
<div class="sourceCode" id="cb264" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb264-1" title="1"><span class="ex">lein</span> repl :connect localhost:7888</a></code></pre></div></li>
</ol></li>
<li><p>Bloody java.time dates</p>
<ol class="incremental">
<li><p>java.time formatting and parsing nanosecond precision dates with UTC timezone?</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb265-1" title="1">  (<span class="kw">let</span> [s     <span class="st">&quot;2022-04-01T11:28:54.939753328Z&quot;</span></a>
<a class="sourceLine" id="cb265-2" title="2">        fmt   (java.<span class="kw">time</span>.<span class="kw">format</span>.DateTimeFormatter/ofPattern <span class="st">&quot;yyyy-MM-dd\u0027T\u0027HH:mm:ss.n\u0027Z\u0027&quot;</span>)</a>
<a class="sourceLine" id="cb265-3" title="3">        s&gt;d   (.parse fmt s)</a>
<a class="sourceLine" id="cb265-4" title="4">        s&gt;d&gt;s (.<span class="kw">format</span> fmt s&gt;d)]</a>
<a class="sourceLine" id="cb265-5" title="5">      (pprint {<span class="at">:s</span> s <span class="at">:s</span>&gt;d s&gt;d <span class="at">:s</span>&gt;d&gt;s s&gt;d&gt;s}))</a>
<a class="sourceLine" id="cb265-6" title="6">#&gt;</a>
<a class="sourceLine" id="cb265-7" title="7">&#39;{</a>
<a class="sourceLine" id="cb265-8" title="8">   <span class="at">:s</span>     <span class="st">&quot;2022-04-01T11:28:54.939753328Z&quot;</span>,</a>
<a class="sourceLine" id="cb265-9" title="9">   <span class="at">:s</span>&gt;d   #object[java.<span class="kw">time</span>.<span class="kw">format</span>.Parsed <span class="bn">0x694ea25d</span> <span class="st">&quot;{},ISO resolved to 2022-04-01T11:28:54.939753328&quot;</span>],</a>
<a class="sourceLine" id="cb265-10" title="10">   <span class="at">:s</span>&gt;d&gt;s <span class="st">&quot;2022-04-01T11:28:54.939753328Z&quot;</span></a>
<a class="sourceLine" id="cb265-11" title="11"> }</a></code></pre></div>
<ol class="incremental">
<li><p>conversion from seconds from epoch to DateTime:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb266-1" title="1">(<span class="kw">let</span> [sec     (<span class="kw">long</span> (System/currentTimeMillis))</a>
<a class="sourceLine" id="cb266-2" title="2">      sec-fmt (<span class="kw">format</span> <span class="st">&quot;%1$tFT%1$tT.%1$tNZ&quot;</span> sec)</a>
<a class="sourceLine" id="cb266-3" title="3">      fmt     (java.<span class="kw">time</span>.<span class="kw">format</span>.DateTimeFormatter/ofPattern <span class="st">&quot;yyyy-MM-dd\u0027T\u0027HH:mm:ss.n\u0027Z\u0027&quot;</span>)</a>
<a class="sourceLine" id="cb266-4" title="4">      dt      (.parse fmt sec-fmt)]</a>
<a class="sourceLine" id="cb266-5" title="5"></a>
<a class="sourceLine" id="cb266-6" title="6">(<span class="kw">-&gt;&gt;</span> (with-map sec sec-fmt dt)</a>
<a class="sourceLine" id="cb266-7" title="7">     pprint))</a>
<a class="sourceLine" id="cb266-8" title="8">#=&gt;</a>
<a class="sourceLine" id="cb266-9" title="9">{</a>
<a class="sourceLine" id="cb266-10" title="10">  <span class="at">:sec</span>     <span class="dv">1650058483005</span>,</a>
<a class="sourceLine" id="cb266-11" title="11">  <span class="at">:sec-fmt</span> <span class="st">&quot;2022-04-15T23:34:43.005000000Z&quot;</span>,</a>
<a class="sourceLine" id="cb266-12" title="12">  <span class="at">:dt</span>      #object[java.<span class="kw">time</span>.<span class="kw">format</span>.Parsed <span class="bn">0x3e9829cb</span> <span class="st">&quot;{},ISO resolved to 2022-04-15T23:34:43.005&quot;</span>]</a>
<a class="sourceLine" id="cb266-13" title="13">}</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>Js</p></li>
<li><p>Babasha</p>
<ol class="incremental">
<li><p>Parse a date in babashka?</p>
<div class="sourceCode" id="cb267" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">(</span><span class="ex">java.time.LocalDateTime/parse</span> <span class="st">&quot;2019-12-18T16:01:41.485&quot;</span><span class="kw">)</span></a></code></pre></div>
<p>]</p></li>
</ol></li>
<li><p>Processes</p>
<ol class="incremental">
<li><p>Process output of a cmd lazily?</p>
<ol class="incremental">
<li><p>Pure clojure (works with Clojure JVM + Babashka)</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb268-1" title="1">  <span class="co">;; ========== begin aken from Raynes conch librray 0.8.0 low_level.clj ==========</span></a>
<a class="sourceLine" id="cb268-2" title="2">(<span class="bu">defn</span><span class="fu"> proc</span></a>
<a class="sourceLine" id="cb268-3" title="3">  <span class="st">&quot;Spin off another process. Returns the process&#39;s input stream,</span></a>
<a class="sourceLine" id="cb268-4" title="4"><span class="st">  output stream, and err stream as a map of :in, :out, and :err keys</span></a>
<a class="sourceLine" id="cb268-5" title="5"><span class="st">  If passed the optional :dir and/or :env keyword options, the dir</span></a>
<a class="sourceLine" id="cb268-6" title="6"><span class="st">  and enviroment will be set to what you specify. If you pass</span></a>
<a class="sourceLine" id="cb268-7" title="7"><span class="st">  :verbose and it is true, commands will be printed. If it is set to</span></a>
<a class="sourceLine" id="cb268-8" title="8"><span class="st">  :very, environment variables passed, dir, and the command will be</span></a>
<a class="sourceLine" id="cb268-9" title="9"><span class="st">  printed. If passed the :clear-env keyword option, then the process</span></a>
<a class="sourceLine" id="cb268-10" title="10"><span class="st">  will not inherit its environment from its parent process.&quot;</span></a>
<a class="sourceLine" id="cb268-11" title="11">  [&amp; args]</a>
<a class="sourceLine" id="cb268-12" title="12">  (<span class="kw">let</span> [[cmd args] (<span class="kw">split-with</span> (<span class="kw">complement</span> <span class="kw">keyword?</span>) args)</a>
<a class="sourceLine" id="cb268-13" title="13">        args (<span class="kw">apply</span> <span class="kw">hash-map</span> args)</a>
<a class="sourceLine" id="cb268-14" title="14">        builder (ProcessBuilder. (<span class="kw">into-array</span> String cmd))</a>
<a class="sourceLine" id="cb268-15" title="15">        env (.environment builder)]</a>
<a class="sourceLine" id="cb268-16" title="16">    (<span class="kw">when</span> (<span class="at">:clear-env</span> args)</a>
<a class="sourceLine" id="cb268-17" title="17">      (.clear env))</a>
<a class="sourceLine" id="cb268-18" title="18">    (<span class="kw">doseq</span> [[k v] (<span class="at">:env</span> args)]</a>
<a class="sourceLine" id="cb268-19" title="19">      (.put env k v))</a>
<a class="sourceLine" id="cb268-20" title="20">    (<span class="kw">when-let</span> [dir (<span class="at">:dir</span> args)]</a>
<a class="sourceLine" id="cb268-21" title="21">      (.directory builder (io/file dir)))</a>
<a class="sourceLine" id="cb268-22" title="22">    (<span class="kw">when</span> (<span class="at">:verbose</span> args) (<span class="kw">apply</span> <span class="kw">println</span> cmd))</a>
<a class="sourceLine" id="cb268-23" title="23">    (<span class="kw">when</span> (<span class="kw">=</span> <span class="at">:very</span> (<span class="at">:verbose</span> args))</a>
<a class="sourceLine" id="cb268-24" title="24">      (<span class="kw">when-let</span> [env (<span class="at">:env</span> args)] (<span class="kw">prn</span> env))</a>
<a class="sourceLine" id="cb268-25" title="25">      (<span class="kw">when-let</span> [dir (<span class="at">:dir</span> args)] (<span class="kw">prn</span> dir)))</a>
<a class="sourceLine" id="cb268-26" title="26">    (<span class="kw">when</span> (<span class="at">:redirect-err</span> args)</a>
<a class="sourceLine" id="cb268-27" title="27">      (.redirectErrorStream builder <span class="va">true</span>))</a>
<a class="sourceLine" id="cb268-28" title="28">    (<span class="kw">let</span> [process (.start builder)]</a>
<a class="sourceLine" id="cb268-29" title="29">      {<span class="at">:out</span> (.getInputStream process)</a>
<a class="sourceLine" id="cb268-30" title="30">       <span class="at">:in</span>  (.getOutputStream process)</a>
<a class="sourceLine" id="cb268-31" title="31">       <span class="at">:err</span> (.getErrorStream process)</a>
<a class="sourceLine" id="cb268-32" title="32">       <span class="at">:process</span> process})))</a>
<a class="sourceLine" id="cb268-33" title="33"><span class="co">;; ========== begin aken from Raynes conch libraray ==========</span></a>
<a class="sourceLine" id="cb268-34" title="34"></a>
<a class="sourceLine" id="cb268-35" title="35">(<span class="bu">defn</span><span class="fu"> proc-lazy </span>[&amp; prog] <span class="st">&quot;Return a lazy seq which is the output (potentially infinite) on stdout of the given program.</span></a>
<a class="sourceLine" id="cb268-36" title="36"><span class="st">Add the process to the meta (to dispose it later for example).&quot;</span></a>
<a class="sourceLine" id="cb268-37" title="37">  (<span class="kw">let</span> [proc (<span class="kw">apply</span> proc prog)</a>
<a class="sourceLine" id="cb268-38" title="38">        out  (<span class="at">:out</span> proc)</a>
<a class="sourceLine" id="cb268-39" title="39">        rdr  (clojure.java.io/reader out)</a>
<a class="sourceLine" id="cb268-40" title="40">        <span class="kw">seq</span>  (<span class="kw">with-meta</span>  (<span class="kw">line-seq</span> rdr) {<span class="at">:proc</span> proc})]</a>
<a class="sourceLine" id="cb268-41" title="41">    <span class="kw">seq</span>))</a>
<a class="sourceLine" id="cb268-42" title="42"></a>
<a class="sourceLine" id="cb268-43" title="43">(<span class="kw">println</span> <span class="st">&quot;defining s&quot;</span>)</a>
<a class="sourceLine" id="cb268-44" title="44">(<span class="kw">time</span> (<span class="bu">def</span><span class="fu"> s </span>(proc-lazy <span class="st">&quot;bash&quot;</span> <span class="st">&quot;-c&quot;</span> <span class="st">&quot;seq Infinity | pv -qlL1&quot;</span>)))</a>
<a class="sourceLine" id="cb268-45" title="45"></a>
<a class="sourceLine" id="cb268-46" title="46">(<span class="kw">println</span> <span class="st">&quot;taking 1 from s&quot;</span>)</a>
<a class="sourceLine" id="cb268-47" title="47">(<span class="kw">time</span> (pp/pprint (<span class="kw">take</span> <span class="dv">1</span> s)))</a>
<a class="sourceLine" id="cb268-48" title="48"></a>
<a class="sourceLine" id="cb268-49" title="49">(<span class="kw">println</span> <span class="st">&quot;taking 10 from s&quot;</span>)</a>
<a class="sourceLine" id="cb268-50" title="50">(<span class="kw">time</span> (pp/pprint (<span class="kw">take</span> <span class="dv">10</span> s)))</a>
<a class="sourceLine" id="cb268-51" title="51"></a>
<a class="sourceLine" id="cb268-52" title="52"></a></code></pre></div></li>
<li><p>Using babashka process lib</p>
<div class="sourceCode" id="cb269" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb269-1" title="1"><span class="bu">:</span> <span class="st">&#39; -*- clojure -*- &#39;</span> \</a>
<a class="sourceLine" id="cb269-2" title="2"><span class="kw">&amp;&amp;</span> <span class="ex">bb</span> -o <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb269-3" title="3"><span class="st">   (require (quote [babashka.process :as process]))</span></a>
<a class="sourceLine" id="cb269-4" title="4"><span class="st">   (-&gt;&gt; (process/process [&quot;bash&quot; &quot;-c&quot; &quot;seq Infinity | pv -qlL1&quot;] )</span></a>
<a class="sourceLine" id="cb269-5" title="5"><span class="st">     :out</span></a>
<a class="sourceLine" id="cb269-6" title="6"><span class="st">     (io/reader)</span></a>
<a class="sourceLine" id="cb269-7" title="7"><span class="st">     line-seq )</span></a>
<a class="sourceLine" id="cb269-8" title="8"><span class="st">       &#39;</span></a></code></pre></div></li>
</ol></li>
<li><p>Macros</p>
<ol class="incremental">
<li><p>Threading</p>
<ol class="incremental">
<li><p>how to use threading macros with functions with different argument position?</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb270-1" title="1"><span class="co">;; using -&gt; and -&gt;&gt;</span></a>
<a class="sourceLine" id="cb270-2" title="2">(<span class="kw">-&gt;</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb270-3" title="3">  <span class="kw">range</span></a>
<a class="sourceLine" id="cb270-4" title="4">  (<span class="kw">-&gt;&gt;</span> (<span class="kw">partition</span> <span class="dv">2</span>                ))</a>
<a class="sourceLine" id="cb270-5" title="5">  (<span class="kw">-&gt;&gt;</span> (<span class="kw">map</span>       (<span class="kw">partial</span> <span class="kw">into</span> [])))</a>
<a class="sourceLine" id="cb270-6" title="6">  (<span class="kw">-&gt;&gt;</span> (<span class="kw">into</span>      {}               ))</a>
<a class="sourceLine" id="cb270-7" title="7">  (<span class="kw">get-in</span> [<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb270-8" title="8">)</a>
<a class="sourceLine" id="cb270-9" title="9">#&gt; <span class="st">&quot;3&quot;</span></a>
<a class="sourceLine" id="cb270-10" title="10"><span class="co">;; using as-&gt;</span></a>
<a class="sourceLine" id="cb270-11" title="11">(<span class="kw">as-&gt;</span> <span class="dv">4</span> x</a>
<a class="sourceLine" id="cb270-12" title="12">  (<span class="kw">range</span>                       x)</a>
<a class="sourceLine" id="cb270-13" title="13">  (<span class="kw">partition</span> <span class="dv">2</span>                 x)</a>
<a class="sourceLine" id="cb270-14" title="14">  (<span class="kw">map</span>       (<span class="kw">partial</span> <span class="kw">into</span> []) x)</a>
<a class="sourceLine" id="cb270-15" title="15">  (<span class="kw">into</span>      {}                x)</a>
<a class="sourceLine" id="cb270-16" title="16">  (<span class="kw">get-in</span> x [<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb270-17" title="17">)</a>
<a class="sourceLine" id="cb270-18" title="18">#&gt; <span class="st">&quot;3&quot;</span></a></code></pre></div></li>
<li><p>how to use -&gt;&gt; with fns args mixed at the beginning and and?</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb271-1" title="1">(<span class="kw">let</span> [s {}]</a>
<a class="sourceLine" id="cb271-2" title="2">  (<span class="kw">map</span>  <span class="kw">str</span></a>
<a class="sourceLine" id="cb271-3" title="3">    (<span class="kw">assoc</span> s <span class="at">:k</span> <span class="at">:v</span>)))</a>
<a class="sourceLine" id="cb271-4" title="4">#&gt; (<span class="st">&quot;[:k :v]&quot;</span>)</a>
<a class="sourceLine" id="cb271-5" title="5">(<span class="kw">-&gt;&gt;</span> {}</a>
<a class="sourceLine" id="cb271-6" title="6">  (#(<span class="kw">assoc</span> <span class="va">%</span> <span class="at">:k</span> <span class="at">:v</span>))</a>
<a class="sourceLine" id="cb271-7" title="7">  (<span class="kw">map</span> <span class="kw">str</span>))</a>
<a class="sourceLine" id="cb271-8" title="8">#&gt; (<span class="st">&quot;[:k :v]&quot;</span>)</a></code></pre></div></li>
</ol></li>
<li><p>Functions</p>
<ol class="incremental">
<li><p>Args</p>
<ol class="incremental">
<li><p>optional args with default values using keys?</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb272-1" title="1">(<span class="bu">defn</span><span class="fu"> hello </span>[&amp; {<span class="at">:keys</span> [salutation <span class="kw">name</span>]</a>
<a class="sourceLine" id="cb272-2" title="2">                <span class="at">:or</span>   {salutation <span class="st">&quot;Hello&quot;</span> <span class="kw">name</span> <span class="st">&quot;World&quot;</span>}}]</a>
<a class="sourceLine" id="cb272-3" title="3">  (<span class="kw">str</span> salutation <span class="st">&quot; &quot;</span> <span class="kw">name</span>))</a>
<a class="sourceLine" id="cb272-4" title="4"><span class="co">;; =&gt; &quot;#&#39;fapi.jenkins.log-parse/hello&quot;</span></a>
<a class="sourceLine" id="cb272-5" title="5"><span class="co">;;</span></a>
<a class="sourceLine" id="cb272-6" title="6">(hello)</a>
<a class="sourceLine" id="cb272-7" title="7"><span class="co">;; =&gt; &quot;Hello World&quot;</span></a>
<a class="sourceLine" id="cb272-8" title="8">(hello <span class="at">:name</span> <span class="st">&quot;John&quot;</span>)</a>
<a class="sourceLine" id="cb272-9" title="9"><span class="co">;; =&gt; &quot;Hello John&quot;</span></a>
<a class="sourceLine" id="cb272-10" title="10">(hello <span class="at">:name</span> <span class="st">&quot;John&quot;</span> <span class="at">:salutation</span> <span class="st">&quot;Hi&quot;</span>)</a>
<a class="sourceLine" id="cb272-11" title="11"><span class="co">;; =&gt; &quot;Hi John&quot;</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Ns</p>
<ol class="incremental">
<li><p>Alias</p>
<ol class="incremental">
<li><p>How to remove an alias to a ns?</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb273-1" title="1">        (<span class="kw">let</span> [ns-sym <span class="at">&#39;fapi.jira.sql.hicosql.explore</span></a>
<a class="sourceLine" id="cb273-2" title="2">            alias-sym <span class="at">&#39;jsqlh</span></a>
<a class="sourceLine" id="cb273-3" title="3">](<span class="kw">-&gt;</span> ns-sym</a>
<a class="sourceLine" id="cb273-4" title="4">           <span class="kw">find-ns</span></a>
<a class="sourceLine" id="cb273-5" title="5">           (<span class="kw">ns-unalias</span>  alias-sym)</a>
<a class="sourceLine" id="cb273-6" title="6">           ))</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Var</p>
<ol class="incremental">
<li><p>symbol-&gt;var-&gt;value?</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb274-1" title="1">(<span class="bu">def</span><span class="fu"> x </span><span class="at">:foo</span>)</a>
<a class="sourceLine" id="cb274-2" title="2"><span class="co">;; #&gt; #&#39;user/x</span></a>
<a class="sourceLine" id="cb274-3" title="3">(<span class="kw">resolve</span> <span class="at">&#39;x</span>)</a>
<a class="sourceLine" id="cb274-4" title="4"><span class="co">;; #&gt; #&#39;user/x</span></a>
<a class="sourceLine" id="cb274-5" title="5">(<span class="kw">var-get</span> (<span class="kw">resolve</span> <span class="at">&#39;x</span>))</a>
<a class="sourceLine" id="cb274-6" title="6"><span class="co">;; #&gt; :foo</span></a>
<a class="sourceLine" id="cb274-7" title="7">         (<span class="bu">def</span><span class="fu"> x </span><span class="at">:foo</span>)</a>
<a class="sourceLine" id="cb274-8" title="8">         <span class="co">;; #&gt; #&#39;user/x</span></a>
<a class="sourceLine" id="cb274-9" title="9">         (<span class="kw">resolve</span> <span class="at">&#39;x</span>)</a>
<a class="sourceLine" id="cb274-10" title="10">         <span class="co">;; #&gt; #&#39;user/x</span></a>
<a class="sourceLine" id="cb274-11" title="11">         (<span class="kw">var-get</span> (<span class="kw">resolve</span> <span class="at">&#39;x</span>))</a>
<a class="sourceLine" id="cb274-12" title="12">         <span class="co">;; #&gt; :foo</span></a></code></pre></div>
<ol class="incremental">
<li><p>alternative:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb275-1" title="1">(<span class="bu">def</span><span class="fu"> s </span><span class="va">#&#39;mysym</span>)</a>
<a class="sourceLine" id="cb275-2" title="2">(<span class="kw">-&gt;&gt;</span> s</a>
<a class="sourceLine" id="cb275-3" title="3">     <span class="kw">symbol</span></a>
<a class="sourceLine" id="cb275-4" title="4">    <span class="kw">name</span>)</a>
<a class="sourceLine" id="cb275-5" title="5">#&gt; <span class="st">&quot;f&quot;</span></a></code></pre></div></li>
<li><p>in one go:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb276-1" title="1">(<span class="kw">-&gt;&gt;</span> <span class="at">&#39;x</span></a>
<a class="sourceLine" id="cb276-2" title="2">     <span class="kw">resolve</span></a>
<a class="sourceLine" id="cb276-3" title="3">     <span class="kw">var-get</span></a>
<a class="sourceLine" id="cb276-4" title="4">)</a></code></pre></div></li>
<li><p>or for conditional evaluation</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb277-1" title="1">(<span class="kw">if-let</span> [v (<span class="kw">resolve</span> <span class="at">&#39;*dev-mode*</span>)]</a>
<a class="sourceLine" id="cb277-2" title="2">  (<span class="kw">if</span> (<span class="kw">var-get</span> v)</a>
<a class="sourceLine" id="cb277-3" title="3">    <span class="at">:dostuff</span>))</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Destructuring</p>
<ol class="incremental">
<li><p>Nested destructuring with map and seq ?</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb278-1" title="1">(<span class="bu">def</span><span class="fu"> </span>[s {<span class="at">:todo</span> [<span class="at">:a</span> <span class="at">:b</span>]}])</a>
<a class="sourceLine" id="cb278-2" title="2"><span class="co">;; #&gt;</span></a>
<a class="sourceLine" id="cb278-3" title="3">(<span class="kw">let</span> [{[head &amp; tail] <span class="at">:todo</span>} s]</a>
<a class="sourceLine" id="cb278-4" title="4">  [head tail])</a>
<a class="sourceLine" id="cb278-5" title="5"><span class="co">;; #&gt; [:a :b]</span></a></code></pre></div></li>
</ol></li>
<li><p>Files</p>
<ol class="incremental">
<li><p>Read a file line by line?</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb279-1" title="1">(<span class="kw">with-open</span> [rdr (clojure.java.io/reader <span class="st">&quot;/etc/passwd&quot;</span>)]</a>
<a class="sourceLine" id="cb279-2" title="2">  (<span class="kw">count</span> (<span class="kw">line-seq</span> rdr)))</a></code></pre></div></li>
</ol></li>
<li><p>Strings</p>
<ol class="incremental">
<li><p>Regexes</p>
<ol class="incremental">
<li><p>named groups search and replace in Clojure?</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode clj"><code class="sourceCode clojure"><a class="sourceLine" id="cb280-1" title="1">(str/replace <span class="st">&quot;a b c &quot;</span> <span class="ss">#&quot;^(?&lt;w1&gt;\w+) (?&lt;w2&gt;\w+) (?&lt;w3&gt;\w+) *$&quot;</span> <span class="st">&quot;${w2}&quot;</span>)</a></code></pre></div></li>
<li><p>string to regex?</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb281-1" title="1"> (str/replace <span class="st">&quot;foo&quot;</span> (<span class="kw">re-pattern</span> <span class="st">&quot;o&quot;</span>) <span class="st">&quot;z&quot;</span>)</a>
<a class="sourceLine" id="cb281-2" title="2">#&gt; <span class="st">&quot;fzz&quot;</span></a>
<a class="sourceLine" id="cb281-3" title="3"></a></code></pre></div></li>
<li><p>repeat expression between n and m?</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb282-1" title="1">(clojure.string/replace <span class="st">&quot;chute&quot;</span> <span class="ss">#&quot;^c{0,3}ute$&quot;</span> <span class="st">&quot;chute&quot;</span>)</a>
<a class="sourceLine" id="cb282-2" title="2">#&gt; <span class="st">&quot;chute&quot;</span></a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Classpath</p>
<ol class="incremental">
<li><p>slurp a resource in the classpath?</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb283-1" title="1">(<span class="kw">require</span> &#39;[clojure.java.io <span class="at">:as</span> io])</a>
<a class="sourceLine" id="cb283-2" title="2">(<span class="kw">slurp</span> (io/resource <span class="st">&quot;some_project_name/foo.txt&quot;</span>))</a></code></pre></div></li>
</ol></li>
<li><p>Java interop</p>
<ol class="incremental">
<li><p>Get all parents classes of an instance ?</p></li>
</ol></li>
<li><p>Generate uuid</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb284-1" title="1">(<span class="kw">str</span> (java.util.UUID/randomUUID))</a></code></pre></div></li>
<li><p>Exceptions</p>
<ol class="incremental">
<li><p>try/catch/finally?</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode clojure"><code class="sourceCode clojure"><a class="sourceLine" id="cb285-1" title="1">(<span class="kw">try</span> (<span class="kw">/</span> <span class="dv">1</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb285-2" title="2">  (<span class="kw">catch</span> Throwable <span class="kw">e</span> (.printStackTrace <span class="kw">e</span>))</a>
<a class="sourceLine" id="cb285-3" title="3">  (<span class="kw">finally</span> (<span class="kw">prn</span> <span class="at">:always-run</span>)))</a></code></pre></div></li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<h3 id="web-servers">Web Servers</h3>
<ol class="incremental">
<li><p>Tomcat</p>
<ol class="incremental">
<li><p>how to configure tomcat so that it can be managed programatically ?</p>
<div class="sourceCode" id="cb286" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb286-1" title="1"><span class="co"># add to TOMCAT_HOME/conf/tomcat-users.xml:</span></a>
<a class="sourceLine" id="cb286-2" title="2"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;manager-gui&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;manager-script&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-4" title="4"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;manager-jmx&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-5" title="5"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;manager-status&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-6" title="6"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;admin-gui&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-7" title="7"><span class="op">&lt;</span><span class="ex">role</span> rolename=<span class="st">&quot;admin-script&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-8" title="8"><span class="op">&lt;</span><span class="ex">user</span> username=<span class="st">&quot;tomcat&quot;</span> password=<span class="st">&quot;tomcat&quot;</span> roles=<span class="st">&quot;manager-gui,manager-script,manager-jmx,manager-status,admin-gui,admin-script&quot;</span>/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb286-9" title="9"><span class="co"># then:</span></a>
<a class="sourceLine" id="cb286-10" title="10"><span class="ex">curl</span> -v -u tomcat:tomcat http://127.0.0.1:8080/manager/text/list</a></code></pre></div></li>
<li><p>tomcat rest api doc ?</p>
<p><a href="http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#List_Currently_Deployed_Applications">http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#List_Currently_Deployed_Applications</a></p></li>
</ol></li>
</ol>
<h2 id="databases">Databases</h2>
<h3 id="sql">Sql</h3>
<ol class="incremental">
<li><p>DateTime</p>
<ol class="incremental">
<li><p>Sql: how to select rows where a field date is greater than…?</p>
<p>Cast a string to a date type. Ex in Postgresqldb:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb287-1" title="1"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> <span class="kw">table</span></a>
<a class="sourceLine" id="cb287-2" title="2"><span class="kw">where</span></a>
<a class="sourceLine" id="cb287-3" title="3">  <span class="kw">true</span></a>
<a class="sourceLine" id="cb287-4" title="4">  <span class="kw">and</span> created <span class="op">&gt;</span>  (<span class="st">&#39;2019-01-02 09:00:00&#39;</span>:<span class="ch">:timestamp</span>)</a></code></pre></div></li>
<li><p>Sql: how to select rows where a field date is in [&lt;date&gt; ; &lt;date&gt; + 1 day]?</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb288-1" title="1"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> <span class="kw">table</span></a>
<a class="sourceLine" id="cb288-2" title="2"><span class="kw">where</span></a>
<a class="sourceLine" id="cb288-3" title="3">  <span class="kw">true</span></a>
<a class="sourceLine" id="cb288-4" title="4">  <span class="kw">and</span> created <span class="op">&gt;</span>   (<span class="st">&#39;2019-01-02 09:00:00&#39;</span>:<span class="ch">:timestamp</span>)</a>
<a class="sourceLine" id="cb288-5" title="5">  <span class="kw">and</span> created <span class="op">&lt;=</span>  (<span class="st">&#39;2019-01-02 09:00:00&#39;</span>:<span class="ch">:timestamp</span> <span class="op">+</span> <span class="st">&#39;1 day&#39;</span>:<span class="ch">:interval</span>)</a></code></pre></div></li>
</ol></li>
<li><p>GroupBy</p>
<ol class="incremental">
<li><p>group by concatenate string?</p>
<ul class="incremental">
<li>postgresql &gt; 9:</li>
</ul>
<div class="sourceCode" id="cb289"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb289-1" title="1">  #<span class="op">+</span>BEGIN_SRC sql</a>
<a class="sourceLine" id="cb289-2" title="2">  <span class="kw">select</span> t.<span class="kw">id</span>, string_agg(t.c, <span class="st">&#39;, &#39;</span>)</a>
<a class="sourceLine" id="cb289-3" title="3">  <span class="kw">from</span> (</a>
<a class="sourceLine" id="cb289-4" title="4">    <span class="kw">VALUES</span></a>
<a class="sourceLine" id="cb289-5" title="5">      (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>)</a>
<a class="sourceLine" id="cb289-6" title="6">    , (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)</a>
<a class="sourceLine" id="cb289-7" title="7">    , (<span class="dv">1</span>, <span class="st">&#39;b&#39;</span>)</a>
<a class="sourceLine" id="cb289-8" title="8">    , (<span class="dv">2</span>, <span class="st">&#39;30&#39;</span>)</a>
<a class="sourceLine" id="cb289-9" title="9">  ) t(<span class="kw">id</span>, c)</a>
<a class="sourceLine" id="cb289-10" title="10">  <span class="kw">group</span> <span class="kw">by</span> t.<span class="kw">id</span></a>
<a class="sourceLine" id="cb289-11" title="11">;;<span class="op">&gt;</span> | <span class="ch">:id</span> | <span class="ch">:string_agg</span> |</a>
<a class="sourceLine" id="cb289-12" title="12">;;<span class="op">&gt;</span> |<span class="co">-----+-------------|</span></a>
<a class="sourceLine" id="cb289-13" title="13">;;<span class="op">&gt;</span> |   <span class="dv">1</span> |     c, a, b |</a>
<a class="sourceLine" id="cb289-14" title="14">;;<span class="op">&gt;</span> |   <span class="dv">2</span> |          <span class="dv">30</span> |</a></code></pre></div>
<ul class="incremental">
<li>also possible to order the order:</li>
</ul>
<div class="sourceCode" id="cb290"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb290-1" title="1"><span class="kw">select</span> t.<span class="kw">id</span>, string_agg(t.c, <span class="st">&#39;, &#39;</span> <span class="kw">order</span> <span class="kw">by</span> t.c)</a>
<a class="sourceLine" id="cb290-2" title="2"><span class="kw">from</span> (</a>
<a class="sourceLine" id="cb290-3" title="3">  <span class="kw">VALUES</span></a>
<a class="sourceLine" id="cb290-4" title="4">    (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>)</a>
<a class="sourceLine" id="cb290-5" title="5">  , (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)</a>
<a class="sourceLine" id="cb290-6" title="6">  , (<span class="dv">1</span>, <span class="st">&#39;b&#39;</span>)</a>
<a class="sourceLine" id="cb290-7" title="7">  , (<span class="dv">2</span>, <span class="st">&#39;30&#39;</span>)</a>
<a class="sourceLine" id="cb290-8" title="8">) t(<span class="kw">id</span>, c)</a>
<a class="sourceLine" id="cb290-9" title="9"><span class="kw">group</span> <span class="kw">by</span> t.<span class="kw">id</span></a>
<a class="sourceLine" id="cb290-10" title="10">;;<span class="op">&gt;</span> | <span class="ch">:id</span> | <span class="ch">:string_agg</span> |</a>
<a class="sourceLine" id="cb290-11" title="11">;;<span class="op">&gt;</span> |<span class="co">-----+-------------|</span></a>
<a class="sourceLine" id="cb290-12" title="12">;;<span class="op">&gt;</span> |   <span class="dv">1</span> |     a, b, c |</a>
<a class="sourceLine" id="cb290-13" title="13">;;<span class="op">&gt;</span> |   <span class="dv">2</span> |          <span class="dv">30</span> |</a></code></pre></div></li>
</ol></li>
<li><p>Other</p>
<ol class="incremental">
<li><p>Pseudo table in sql?</p>
<p>their called value tables postgresql and others:</p>
<table>
<thead>
<tr class="header">
<th>a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb291"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">select</span> <span class="op">*</span></a>
<a class="sourceLine" id="cb291-2" title="2"><span class="kw">from</span> (</a>
<a class="sourceLine" id="cb291-3" title="3">  <span class="kw">VALUES</span></a>
<a class="sourceLine" id="cb291-4" title="4">    (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb291-5" title="5">  , (<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb291-6" title="6">) t(a)</a>
<a class="sourceLine" id="cb291-7" title="7">;;<span class="op">&gt;</span> | a |</a>
<a class="sourceLine" id="cb291-8" title="8">;;<span class="op">&gt;</span> |<span class="co">---|</span></a>
<a class="sourceLine" id="cb291-9" title="9">;;<span class="op">&gt;</span> | <span class="dv">1</span> |</a>
<a class="sourceLine" id="cb291-10" title="10">;;<span class="op">&gt;</span> | <span class="dv">2</span> |</a></code></pre></div></li>
<li><p>Concatenate two tables?</p>
<ul class="incremental">
<li>with union (with duplicate rows elimination):</li>
</ul>
<div class="sourceCode" id="cb292"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb292-1" title="1"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (<span class="kw">VALUES</span> (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>), (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)) t(b,a)</a>
<a class="sourceLine" id="cb292-2" title="2"><span class="kw">union</span></a>
<a class="sourceLine" id="cb292-3" title="3"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (<span class="kw">VALUES</span> (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>), (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)) t(b,a)</a>
<a class="sourceLine" id="cb292-4" title="4">;;<span class="op">&gt;</span> | <span class="ch">:b</span> | <span class="ch">:a</span> |</a>
<a class="sourceLine" id="cb292-5" title="5">;;<span class="op">&gt;</span> |<span class="co">----+----|</span></a>
<a class="sourceLine" id="cb292-6" title="6">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  a |</a>
<a class="sourceLine" id="cb292-7" title="7">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  c |</a></code></pre></div>
<ul class="incremental">
<li>with UNION ALL (no dup check):</li>
</ul>
<div class="sourceCode" id="cb293"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb293-1" title="1"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (<span class="kw">VALUES</span> (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>), (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)) t(b,a)</a>
<a class="sourceLine" id="cb293-2" title="2"><span class="kw">union</span> <span class="kw">all</span></a>
<a class="sourceLine" id="cb293-3" title="3"><span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> (<span class="kw">VALUES</span> (<span class="dv">1</span>, <span class="st">&#39;c&#39;</span>), (<span class="dv">1</span>, <span class="st">&#39;a&#39;</span>)) t(b,a)</a>
<a class="sourceLine" id="cb293-4" title="4">;;<span class="op">&gt;</span> | <span class="ch">:b</span> | <span class="ch">:a</span> |</a>
<a class="sourceLine" id="cb293-5" title="5">;;<span class="op">&gt;</span> |<span class="co">----+----|</span></a>
<a class="sourceLine" id="cb293-6" title="6">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  c |</a>
<a class="sourceLine" id="cb293-7" title="7">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  a |</a>
<a class="sourceLine" id="cb293-8" title="8">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  c |</a>
<a class="sourceLine" id="cb293-9" title="9">;;<span class="op">&gt;</span> |  <span class="dv">1</span> |  a |</a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="postgresql">PostgreSQL</h3>
<ol class="incremental">
<li><p>Posgresql cheatsheet?</p>
<table>
<thead>
<tr class="header">
<th>descr</th>
<th>sql</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>get postgresql version</td>
<td><code>SHOW server_version;</code></td>
</tr>
</tbody>
</table></li>
</ol>
<h2 id="node">Node</h2>
<h3 id="npm">Npm</h3>
<ol class="incremental">
<li><p>Cli usage</p>
<ol class="incremental">
<li><p>how to install global packages without sudo?</p>
<div class="sourceCode" id="cb294" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb294-1" title="1"><span class="co">#Make a directory for global installations:</span></a>
<a class="sourceLine" id="cb294-2" title="2"><span class="fu">mkdir</span> ~/.npm-global</a>
<a class="sourceLine" id="cb294-3" title="3"><span class="co">#Configure npm to use the new directory path:</span></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="ex">npm</span> config set prefix <span class="st">&#39;~/.npm-global&#39;</span></a>
<a class="sourceLine" id="cb294-5" title="5"><span class="co">#Open or create a ~/.profile file and add this line:</span></a>
<a class="sourceLine" id="cb294-6" title="6"><span class="bu">export</span> <span class="va">PATH=</span>~/.npm-global/bin:<span class="va">$PATH</span> <span class="op">&gt;&gt;</span> <span class="ex">~/.bashrc</span></a>
<a class="sourceLine" id="cb294-7" title="7"><span class="co">#Back on the command line, update your system variables:</span></a>
<a class="sourceLine" id="cb294-8" title="8"><span class="bu">source</span> ~/.profile</a></code></pre></div>
<p><a href="https://docs.npmjs.com/getting-started/fixing-npm-permissions">https://docs.npmjs.com/getting-started/fixing-npm-permissions</a></p></li>
<li><p>upgrade npm to latest?</p>
<div class="sourceCode" id="cb295" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb295-1" title="1"><span class="ex">npm</span> install npm@latest -g</a></code></pre></div></li>
<li><p>color config in npm?</p>
<p>Starting point:</p>
<div class="sourceCode" id="cb296" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb296-1" title="1"><span class="ex">npm</span> config set color always</a></code></pre></div></li>
<li><p>npm list all config keys?</p>
<div class="sourceCode" id="cb297" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb297-1" title="1"><span class="ex">npm</span> config ls -l</a></code></pre></div>
<p><a href="http://nipstr.com/">http://nipstr.com/</a></p></li>
<li><p>npm install a module from a git url ?</p>
<p>notes, the repo:</p>
<ul class="incremental">
<li>must contains a package.json at it's root dir</li>
</ul>
<div class="sourceCode" id="cb298" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb298-1" title="1"><span class="ex">npm</span> install <span class="st">&#39;git+ssh://git@github.com:denlab/denlab-examples.git#repo/npm/npmLib&#39;</span> --save</a></code></pre></div></li>
</ol></li>
<li><p>Searching</p>
<ol class="incremental">
<li><p>how to search npm packages (and filter by populariy, …)?</p>
<p><a href="http://nipstr.com">http://nipstr.com</a></p></li>
</ol></li>
</ol>
<h3 id="how-to-read-all-lines-from-stdin-in-one-go">how to read all lines from stdin in one go?</h3>
<pre><code># install  module get-stdin
npm i get-stdin
# example
cat &gt; highlight.js &lt;&lt;EOF&#39;&#39;
const getStdin = require(&#39;get-stdin&#39;);

getStdin().then(str =&gt; {
console.log(str);
});
EOF
# run
echo foo | node hightlight.js
#&gt; foo
</code></pre>
<h2 id="regex">Regex</h2>
<h3 id="general-1">General</h3>
<ol class="incremental">
<li><p>regex cheatsheet?</p>
<p>from: <a href="https://www.regular-expressions.info/refadv.html">https://www.regular-expressions.info/refadv.html</a></p>
<table>
<tbody>
<tr class="odd">
<td>negative lookahead</td>
<td><code>(?!&lt;regex&gt;)</code></td>
</tr>
<tr class="even">
<td>lookahead</td>
<td><code>(?=&lt;regex&gt;)</code></td>
</tr>
<tr class="odd">
<td>lookbehind</td>
<td><code>(?&lt;=&lt;regex&gt;)</code></td>
</tr>
<tr class="even">
<td>negative lookbehind</td>
<td><code>(?&lt;!&lt;regex&gt;)</code></td>
</tr>
</tbody>
</table></li>
</ol>
<h3 id="sed">Sed</h3>
<ol class="incremental">
<li><p>use a backreference without grouping?</p>
<div class="sourceCode" id="cb300" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb300-1" title="1"><span class="bu">echo</span> bar <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s/.*/=&gt; &amp; &lt;=/&#39;</span></a>
<a class="sourceLine" id="cb300-2" title="2"><span class="co"># =&gt; bar &lt;=</span></a></code></pre></div></li>
<li><p>remove backslash EOL with sed?</p>
<div class="sourceCode" id="cb301" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb301-1" title="1"><span class="bu">echo</span> <span class="st">&#39;a</span></a>
<a class="sourceLine" id="cb301-2" title="2"><span class="st">b \</span></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="st">c&#39;</span> <span class="kw">|</span> <span class="fu">sed</span>  <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb301-4" title="4"><span class="st">: again</span></a>
<a class="sourceLine" id="cb301-5" title="5"><span class="st">/\\$/ {</span></a>
<a class="sourceLine" id="cb301-6" title="6"><span class="st">    N</span></a>
<a class="sourceLine" id="cb301-7" title="7"><span class="st">    s/\\\n//</span></a>
<a class="sourceLine" id="cb301-8" title="8"><span class="st">    t again</span></a>
<a class="sourceLine" id="cb301-9" title="9"><span class="st">}&#39;</span></a>
<a class="sourceLine" id="cb301-10" title="10"><span class="co"># a</span></a>
<a class="sourceLine" id="cb301-11" title="11"><span class="co"># b c</span></a></code></pre></div></li>
<li><p>join lines of a files two by two?</p>
<div class="sourceCode" id="cb302" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb302-1" title="1"><span class="fu">seq</span> 10  <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;N;s/\n/ /&#39;</span></a>
<a class="sourceLine" id="cb302-2" title="2"><span class="ex">1</span> 2</a>
<a class="sourceLine" id="cb302-3" title="3"><span class="ex">3</span> 4</a>
<a class="sourceLine" id="cb302-4" title="4"><span class="ex">5</span> 6</a>
<a class="sourceLine" id="cb302-5" title="5"><span class="ex">7</span> 8</a>
<a class="sourceLine" id="cb302-6" title="6"><span class="ex">9</span> 10</a></code></pre></div></li>
<li><p>add a line before the first line of a file?</p>
<p>from: <a href="https://unix.stackexchange.com/questions/99350/how-to-insert-text-before-the-first-line-of-a-file">https://unix.stackexchange.com/questions/99350/how-to-insert-text-before-the-first-line-of-a-file</a></p>
<div class="sourceCode" id="cb303" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb303-1" title="1">     <span class="fu">seq</span> 3 <span class="op">&gt;</span> y</a>
<a class="sourceLine" id="cb303-2" title="2">     <span class="fu">cat</span> y</a>
<a class="sourceLine" id="cb303-3" title="3">     <span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb303-4" title="4">     <span class="co">#&gt; 2</span></a>
<a class="sourceLine" id="cb303-5" title="5">     <span class="co">#&gt; 3</span></a>
<a class="sourceLine" id="cb303-6" title="6">     <span class="fu">sed</span>  -i <span class="st">&#39;1i text&#39;</span> y</a>
<a class="sourceLine" id="cb303-7" title="7">      <span class="co">#&gt; text</span></a>
<a class="sourceLine" id="cb303-8" title="8">     <span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb303-9" title="9">     <span class="co">#&gt; 2</span></a>
<a class="sourceLine" id="cb303-10" title="10">     <span class="co">#&gt; 3</span></a>
<a class="sourceLine" id="cb303-11" title="11">     <span class="fu">cat</span> y</a>
<a class="sourceLine" id="cb303-12" title="12"><span class="bu">history</span> <span class="kw">|</span> <span class="fu">tail</span> -3</a>
<a class="sourceLine" id="cb303-13" title="13"><span class="bu">history</span> <span class="kw">|</span> <span class="fu">tail</span> -4</a>
<a class="sourceLine" id="cb303-14" title="14"><span class="bu">history</span> <span class="kw">|</span> <span class="fu">tail</span> -10</a>
<a class="sourceLine" id="cb303-15" title="15"></a>
<a class="sourceLine" id="cb303-16" title="16"></a></code></pre></div></li>
<li><p>output lines from regex to N line after it?</p>
<div class="sourceCode" id="cb304" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb304-1" title="1"><span class="fu">seq</span> 1 100 \</a>
<a class="sourceLine" id="cb304-2" title="2"><span class="kw">|</span> <span class="fu">sed</span> -rn <span class="st">&#39;/40/,+3 p&#39;</span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="co">#&gt; 40</span></a>
<a class="sourceLine" id="cb304-4" title="4"><span class="co">#&gt; 41</span></a>
<a class="sourceLine" id="cb304-5" title="5"><span class="co">#&gt; 42</span></a>
<a class="sourceLine" id="cb304-6" title="6"><span class="co">#&gt; 43</span></a></code></pre></div></li>
</ol>
<h3 id="perl">Perl</h3>
<ol class="incremental">
<li><p>Multiline search and replace?</p>
<div class="sourceCode" id="cb305" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb305-1" title="1"><span class="fu">perl</span> -pe <span class="st">&#39;s/&lt;search&gt;/&lt;replace&gt;/&#39;</span>  <span class="op">&lt;</span> in.file <span class="op">&gt;</span> out.file</a></code></pre></div></li>
</ol>
<h2 id="python">Python</h2>
<h3 id="pip">Pip</h3>
<ol class="incremental">
<li><p>How to install pip for python 3 ?</p>
<ul class="incremental">
<li><p>install: on ubuntu/debian:</p>
<div class="sourceCode" id="cb306" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb306-1" title="1"><span class="ex">aptitude</span> install python3-pip</a></code></pre></div></li>
<li><p>invoke:</p>
<div class="sourceCode" id="cb307" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb307-1" title="1"><span class="ex">pip3</span> <span class="op">&lt;</span>cmd<span class="op">&gt;</span></a></code></pre></div></li>
</ul></li>
<li><p>How to install pip for python 2 ?</p>
<div class="sourceCode" id="cb308" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb308-1" title="1"><span class="fu">sudo</span> apt update</a>
<a class="sourceLine" id="cb308-2" title="2"><span class="ex">curl</span> https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py</a>
<a class="sourceLine" id="cb308-3" title="3"><span class="fu">sudo</span> python2 get-pip.py</a></code></pre></div></li>
<li><p>pip completion on the command line?</p>
<div class="sourceCode" id="cb309" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb309-1" title="1"><span class="ex">pip</span> completion --bash <span class="op">&gt;&gt;</span> ~/.profile</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb310" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb310-1" title="1"><span class="bu">eval</span> <span class="st">&quot;</span><span class="kw">`</span><span class="ex">pip</span> completion --zsh<span class="kw">`</span><span class="st">&quot;</span></a></code></pre></div>
<p>from: <a href="https://pip.pypa.io/en/stable/user_guide/?highlight=completion%20#command-completion">https://pip.pypa.io/en/stable/user_guide/?highlight=completion%20#command-completion</a></p></li>
<li><p>avoid pip warning when pip list in a script?</p>
<div class="sourceCode" id="cb311" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb311-1" title="1">     <span class="fu">cat</span> <span class="op">&gt;&gt;</span> ~/.pip/pip.conf <span class="op">&lt;&lt;EOF</span></a>
<a class="sourceLine" id="cb311-2" title="2">[list]</a>
<a class="sourceLine" id="cb311-3" title="3">format=columns</a>
<a class="sourceLine" id="cb311-4" title="4"><span class="op">EOF</span></a></code></pre></div></li>
</ol>
<h3 id="json">Json</h3>
<ol class="incremental">
<li><p>Parse a json string?</p>
<div class="sourceCode" id="cb312" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb312-1" title="1">    <span class="ex">python</span> <span class="op">&lt;&lt;- EOF</span></a>
<a class="sourceLine" id="cb312-2" title="2">import json</a>
<a class="sourceLine" id="cb312-3" title="3">j = json.loads(&#39;{&quot;one&quot; : &quot;1&quot;, &quot;two&quot; : &quot;2&quot;, &quot;three&quot; : &quot;3&quot;}&#39;)</a>
<a class="sourceLine" id="cb312-4" title="4"></a>
<a class="sourceLine" id="cb312-5" title="5">#print j[&#39;two&#39;]</a>
<a class="sourceLine" id="cb312-6" title="6"><span class="op">EOF</span></a></code></pre></div></li>
</ol>
<h3 id="read-from-stdin">read from stdin?</h3>
<div class="sourceCode" id="cb313"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb313-1" title="1">   <span class="co">#!/usr/bin/env python</span></a>
<a class="sourceLine" id="cb313-2" title="2"><span class="im">import</span> fileinput</a>
<a class="sourceLine" id="cb313-3" title="3"></a>
<a class="sourceLine" id="cb313-4" title="4"><span class="cf">for</span> line <span class="kw">in</span> fileinput.<span class="bu">input</span>():</a>
<a class="sourceLine" id="cb313-5" title="5">  <span class="bu">print</span> line, <span class="co"># comma to avoid double printing newline</span></a></code></pre></div>
<h2 id="gnumake">GnuMake</h2>
<h3 id="build-in-a-diferent-directory-than-the-makefile">build in a diferent directory than the Makefile?</h3>
<p>from: <a href="https://stackoverflow.com/questions/37467969/how-to-change-current-directory-in-make">https://stackoverflow.com/questions/37467969/how-to-change-current-directory-in-make</a> <code>Makefile</code>:</p>
<div class="sourceCode" id="cb314" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb314-1" title="1"><span class="ex">srcs</span> := main.c foo.c</a>
<a class="sourceLine" id="cb314-2" title="2"><span class="ex">blddir</span> := bld</a>
<a class="sourceLine" id="cb314-3" title="3"><span class="ex">objs</span> := <span class="va">$(</span><span class="ex">addprefix</span> <span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span>/,<span class="va">$(</span><span class="ex">srcs</span>:.c=.o<span class="va">))</span></a>
<a class="sourceLine" id="cb314-4" title="4"><span class="ex">exe</span> := <span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span>/prog</a>
<a class="sourceLine" id="cb314-5" title="5"></a>
<a class="sourceLine" id="cb314-6" title="6"><span class="ex">.PHONY</span>: all clean</a>
<a class="sourceLine" id="cb314-7" title="7"></a>
<a class="sourceLine" id="cb314-8" title="8"><span class="ex">all</span>: <span class="va">$(</span><span class="ex">exe</span><span class="va">)</span></a>
<a class="sourceLine" id="cb314-9" title="9"></a>
<a class="sourceLine" id="cb314-10" title="10"><span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span><span class="bu">:</span></a>
<a class="sourceLine" id="cb314-11" title="11">    <span class="fu">mkdir</span> -p <span class="va">$@</span></a>
<a class="sourceLine" id="cb314-12" title="12"></a>
<a class="sourceLine" id="cb314-13" title="13"><span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span>/%.o: <span class="ex">%.c</span> <span class="kw">|</span> <span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span></a>
<a class="sourceLine" id="cb314-14" title="14">    <span class="va">$(</span><span class="ex">CC</span><span class="va">)</span> <span class="va">$(</span><span class="ex">CFLAGS</span><span class="va">)</span> <span class="va">$(</span><span class="ex">CPPFLAGS</span><span class="va">)</span> <span class="ex">-c</span> -o <span class="va">$@</span> $<span class="op">&lt;</span></a>
<a class="sourceLine" id="cb314-15" title="15"></a>
<a class="sourceLine" id="cb314-16" title="16"><span class="va">$(</span><span class="ex">exe</span><span class="va">)</span> <span class="bu">:</span> <span class="va">$(</span><span class="ex">objs</span><span class="va">)</span></a>
<a class="sourceLine" id="cb314-17" title="17">    <span class="va">$(</span><span class="ex">CC</span><span class="va">)</span> <span class="ex">-o</span> <span class="va">$@</span> $^ <span class="va">$(</span><span class="ex">LDFLAGS</span><span class="va">)</span> <span class="va">$(</span><span class="ex">LDLIBS</span><span class="va">)</span></a>
<a class="sourceLine" id="cb314-18" title="18"></a>
<a class="sourceLine" id="cb314-19" title="19"><span class="ex">clean</span>:</a>
<a class="sourceLine" id="cb314-20" title="20">    <span class="fu">rm</span> -fr <span class="va">$(</span><span class="ex">blddir</span><span class="va">)</span></a></code></pre></div>
<h3 id="gnumake-language">GnuMake language</h3>
<ol class="incremental">
<li><p>print newline?</p>
<p><code>Makefile</code>:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode Makefile"><code class="sourceCode makefile"><a class="sourceLine" id="cb315-1" title="1">    <span class="kw">define</span> \n</a>
<a class="sourceLine" id="cb315-2" title="2"></a>
<a class="sourceLine" id="cb315-3" title="3"></a>
<a class="sourceLine" id="cb315-4" title="4"><span class="kw">endef</span></a>
<a class="sourceLine" id="cb315-5" title="5"></a>
<a class="sourceLine" id="cb315-6" title="6"><span class="dv">$(info - newline:</span><span class="dt"> </span><span class="ch">${</span><span class="dt">\n</span><span class="ch">}</span><span class="dt"> has been inserted)</span></a></code></pre></div></li>
<li><p>print all variables?</p>
<p><code>Makefile</code>:</p>
<div class="sourceCode" id="cb316" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb316-1" title="1"><span class="ex">info</span>:</a>
<a class="sourceLine" id="cb316-2" title="2">   <span class="ex">@echo</span> <span class="st">&quot;V=</span><span class="va">$(</span><span class="ex">foreach</span> v, <span class="va">$(</span><span class="ex">.VARIABLES</span><span class="va">)</span>, <span class="va">$(</span><span class="ex">v</span><span class="va">)</span>:<span class="va">$($(</span><span class="ex">v</span><span class="va">)))</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39; &#39;</span> <span class="st">&#39;\n&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -R <span class="st">&#39;.&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -Ss <span class="st">&#39;[ .[] | select(length &gt; 0)  | [splits(&quot;:&quot;)]  | {key: .[0], value: .[1]}] | .[] | .key + &quot;:&quot; + .value&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> -r <span class="st">&#39;.&#39;</span> <span class="kw">|</span> <span class="ex">column</span></a></code></pre></div></li>
</ol>
<h3 id="print-all-targets">print all targets?</h3>
<div class="sourceCode" id="cb317" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb317-1" title="1"><span class="fu">make</span> -Rrnp  <span class="kw">|</span> <span class="fu">egrep</span> -v <span class="st">&#39;^#|:= | = &#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;:&#39;</span></a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb318" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb318-1" title="1"><span class="ex">@grep</span> <span class="st">&#39;^[^#[:space:]].*:&#39;</span> Makefile</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb319" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb319-1" title="1"><span class="fu">make</span> -prRn <span class="kw">|</span> <span class="fu">egrep</span> -v <span class="st">$&#39;(^(#|</span><span class="dt">\t</span><span class="st">)|=)&#39;</span> <span class="kw">|</span> <span class="fu">egrep</span> <span class="st">&#39;:&#39;</span> <span class="op">2&gt;</span> /dev/null <span class="kw">|</span> <span class="fu">cut</span> -d: -f1 <span class="kw">|</span> <span class="fu">sort</span></a></code></pre></div>
<h3 id="how-do-i-fail-the-build-if-an-env-var-is-not-defined-for-a-particular-target">how do I fail the build if an env var is not defined for a particular target?</h3>
<div class="sourceCode" id="cb320" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb320-1" title="1"><span class="ex">check-env</span>:</a>
<a class="sourceLine" id="cb320-2" title="2"><span class="ex">ifndef</span> cmd</a>
<a class="sourceLine" id="cb320-3" title="3">  <span class="va">$(</span><span class="ex">error</span> cmd is undefined<span class="va">)</span></a>
<a class="sourceLine" id="cb320-4" title="4"><span class="ex">endif</span></a></code></pre></div>
<h3 id="how-to-use-a-multiline-make-var-in-a-shell-recipe">how to use a multiline make var in a shell recipe?</h3>
<p>Export the make var, and use it in the recipe:</p>
<div class="sourceCode" id="cb321" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb321-1" title="1"><span class="fu">make</span> - <span class="op">&lt;&lt;&lt;</span> <span class="st">&#39;define multiline</span></a>
<a class="sourceLine" id="cb321-2" title="2"><span class="st">- line1</span></a>
<a class="sourceLine" id="cb321-3" title="3"><span class="st">- line2</span></a>
<a class="sourceLine" id="cb321-4" title="4"><span class="st">- line3</span></a>
<a class="sourceLine" id="cb321-5" title="5"><span class="st">endef</span></a>
<a class="sourceLine" id="cb321-6" title="6"><span class="st">export multiline</span></a>
<a class="sourceLine" id="cb321-7" title="7"></a>
<a class="sourceLine" id="cb321-8" title="8"><span class="st">run:</span></a>
<a class="sourceLine" id="cb321-9" title="9"><span class="st">  @echo</span></a>
<a class="sourceLine" id="cb321-10" title="10"><span class="st">  @echo &quot;demoMultiLine: &quot;</span></a>
<a class="sourceLine" id="cb321-11" title="11"><span class="st">  @echo &quot;$$multiline&quot;</span></a>
<a class="sourceLine" id="cb321-12" title="12"><span class="st">  @echo</span></a>
<a class="sourceLine" id="cb321-13" title="13"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb321-14" title="14"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb321-15" title="15"><span class="co">#&gt; demoMultiLine:</span></a>
<a class="sourceLine" id="cb321-16" title="16"><span class="co">#&gt; - line1</span></a>
<a class="sourceLine" id="cb321-17" title="17"><span class="co">#&gt; - line2</span></a>
<a class="sourceLine" id="cb321-18" title="18"><span class="co">#&gt; - line3</span></a>
<a class="sourceLine" id="cb321-19" title="19"><span class="co">#&gt;</span></a></code></pre></div>
<h3 id="selfdoc">selfDoc</h3>
<ol class="incremental">
<li><p>how to extract all targets from a Makefile without a make command ?</p>
<p><del>BEGIN<sub>SRC</sub> sh egrep '^[^. :]</del>:' &lt; proxy | sed -r -e 's/.*/ - &amp;/' -e 's/://g'] +END<sub>SRC</sub></p></li>
</ol>
<h2 id="lorem-ipsum">Lorem ipsum</h2>
<table>
<tbody>
<tr class="odd">
<td>json</td>
<td>online</td>
<td><code>curl https://registry.npmjs.com/lobar</code></td>
</tr>
</tbody>
</table>
<h2 id="git">Git</h2>
<h3 id="submodules">Submodules</h3>
<ol class="incremental">
<li><p>submodule lifecycle mgmt</p>
<table>
<thead>
<tr class="header">
<th>action</th>
<th>normal git managed file</th>
<th>for submodule</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>revert file to repo's version</td>
<td><code>git checkout --</code></td>
<td><code>git submodule update</code></td>
</tr>
</tbody>
</table></li>
<li><p>submodule: track latest?</p>
<div class="sourceCode" id="cb322" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb322-1" title="1">     <span class="co"># add submodule to track master branch</span></a>
<a class="sourceLine" id="cb322-2" title="2"><span class="fu">git</span> submodule add -b master [URL to Git repo]<span class="kw">;</span></a>
<a class="sourceLine" id="cb322-3" title="3"></a>
<a class="sourceLine" id="cb322-4" title="4"><span class="co"># update your submodule</span></a>
<a class="sourceLine" id="cb322-5" title="5"><span class="fu">git</span> submodule update --remote</a></code></pre></div></li>
<li><p>how to deregister a submodule?</p>
<p>Something that has worked for me:</p>
<div class="sourceCode" id="cb323" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb323-1" title="1"><span class="va">moduleToRemove=</span>modules/toRm</a>
<a class="sourceLine" id="cb323-2" title="2"><span class="fu">git</span> rm -f <span class="va">$moduleToRemove</span></a>
<a class="sourceLine" id="cb323-3" title="3"><span class="fu">rm</span> -rf .git/modules/<span class="va">$moduleToRemove</span></a>
<a class="sourceLine" id="cb323-4" title="4"><span class="fu">git</span> clean -fd</a>
<a class="sourceLine" id="cb323-5" title="5"><span class="fu">git</span> reset --hard</a></code></pre></div></li>
</ol>
<h3 id="tags-branches-lifecycle-mgmt">Tags / branches lifecycle mgmt</h3>
<table>
<thead>
<tr class="header">
<th>what</th>
<th>action</th>
<th>where</th>
<th>git command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tag</td>
<td>create</td>
<td>local</td>
<td><code>git tag &lt;tagName&gt; &lt;commit&gt;</code></td>
</tr>
<tr class="even">
<td>tag</td>
<td>fetch</td>
<td></td>
<td><code>git pull --tags</code></td>
</tr>
<tr class="odd">
<td>tag</td>
<td>push</td>
<td></td>
<td><code>git push origin &lt;tag_name&gt;</code></td>
</tr>
<tr class="even">
<td>tag</td>
<td>delete</td>
<td>local</td>
<td><code>git tag -d &lt;tagName&gt;</code></td>
</tr>
<tr class="odd">
<td>tag</td>
<td>delete</td>
<td>remote</td>
<td><code>git push --delete origin &lt;tagName&gt;</code></td>
</tr>
<tr class="even">
<td>branch</td>
<td>delete</td>
<td>local</td>
<td><code>git branch -d feature/example</code></td>
</tr>
<tr class="odd">
<td>branch</td>
<td>delete</td>
<td>remote</td>
<td><code>git push origin --delete feature/example</code></td>
</tr>
<tr class="even">
<td>branch</td>
<td>push &amp;&amp; set upstream</td>
<td></td>
<td><code>git push origin --set-upstream new-branch</code></td>
</tr>
<tr class="odd">
<td>branch</td>
<td>rename</td>
<td>local/remote</td>
<td><code>git branch -m $oldName $newName &amp;&amp; git push origin :$oldName &amp;&amp; git push --set-upstream origin $newName</code></td>
</tr>
</tbody>
</table>
<h3 id="rm-a-big-file-from-history">rm a big file from history?</h3>
<div class="sourceCode" id="cb324" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb324-1" title="1"><span class="co"># given :</span></a>
<a class="sourceLine" id="cb324-2" title="2"><span class="co"># $ git lola --name-status</span></a>
<a class="sourceLine" id="cb324-3" title="3"><span class="co"># * f772d66 (HEAD, master) Login page</span></a>
<a class="sourceLine" id="cb324-4" title="4"><span class="kw">|</span> <span class="ex">A</span>     login.html</a>
<a class="sourceLine" id="cb324-5" title="5"><span class="co"># * cb14e Remove DVD-rip</span></a>
<a class="sourceLine" id="cb324-6" title="6"><span class="co"># | D     oops.iso</span></a>
<a class="sourceLine" id="cb324-7" title="7"><span class="co"># * ce36c98 Careless</span></a>
<a class="sourceLine" id="cb324-8" title="8"><span class="co"># | A     oops.iso</span></a>
<a class="sourceLine" id="cb324-9" title="9"><span class="co"># | A     other.html</span></a>
<a class="sourceLine" id="cb324-10" title="10"><span class="co"># * 5af4522 Admin page</span></a>
<a class="sourceLine" id="cb324-11" title="11"><span class="co"># | A     admin.html</span></a>
<a class="sourceLine" id="cb324-12" title="12"><span class="co"># * e738b63 Index</span></a>
<a class="sourceLine" id="cb324-13" title="13"><span class="co">#   A     index.html</span></a>
<a class="sourceLine" id="cb324-14" title="14"></a>
<a class="sourceLine" id="cb324-15" title="15"><span class="fu">git</span> rebase -i 5af4522</a>
<a class="sourceLine" id="cb324-16" title="16"></a>
<a class="sourceLine" id="cb324-17" title="17"><span class="co"># pick ce36c98 Careless</span></a>
<a class="sourceLine" id="cb324-18" title="18"><span class="co"># pick cb14e Remove DVD-rip</span></a>
<a class="sourceLine" id="cb324-19" title="19"><span class="co"># pick f772d66 Login page</span></a>
<a class="sourceLine" id="cb324-20" title="20"></a>
<a class="sourceLine" id="cb324-21" title="21"><span class="co"># e ce36c98 Careless</span></a>
<a class="sourceLine" id="cb324-22" title="22"><span class="co"># # pick cb14e Remove DVD-rip</span></a>
<a class="sourceLine" id="cb324-23" title="23"><span class="co"># pick f772d66 Login page</span></a>
<a class="sourceLine" id="cb324-24" title="24"></a>
<a class="sourceLine" id="cb324-25" title="25">$ <span class="fu">git</span> rm --cached oops.iso</a>
<a class="sourceLine" id="cb324-26" title="26">$ <span class="fu">git</span> commit --amend -C HEAD</a>
<a class="sourceLine" id="cb324-27" title="27">$ <span class="fu">git</span> rebase --continue</a>
<a class="sourceLine" id="cb324-28" title="28"></a>
<a class="sourceLine" id="cb324-29" title="29"></a></code></pre></div>
<h3 id="list-branch-sorted-by-last-commit-date">list branch sorted by last commit date?</h3>
<div class="sourceCode" id="cb325" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb325-1" title="1"><span class="fu">git</span> for-each-ref --sort=-committerdate refs/heads/</a></code></pre></div>
<h3 id="grep-history">grep history?</h3>
<div class="sourceCode" id="cb326" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb326-1" title="1"><span class="kw">set</span> <span class="ex">--</span> <span class="st">&#39;&lt;regex&gt;&#39;</span></a>
<a class="sourceLine" id="cb326-2" title="2"><span class="fu">git</span> grep <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span> <span class="va">$(</span><span class="fu">git</span> rev-list --all<span class="va">)</span></a></code></pre></div>
<h3 id="essential-git-config">essential git config?</h3>
<div class="sourceCode" id="cb327" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb327-1" title="1">   <span class="fu">git</span> config --global color.ui true                \</a>
<a class="sourceLine" id="cb327-2" title="2"><span class="kw">&amp;&amp;</span> <span class="fu">git</span> config --global user.email <span class="st">&quot;you@example.com&quot;</span> \</a>
<a class="sourceLine" id="cb327-3" title="3"><span class="kw">&amp;&amp;</span> <span class="fu">git</span> config --global user.name <span class="st">&quot;Your Name&quot;</span></a></code></pre></div>
<h3 id="config-for-colors">config for colors?</h3>
<div class="sourceCode" id="cb328" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb328-1" title="1"><span class="fu">git</span> config --global color.ui true</a></code></pre></div>
<h3 id="git-lfs-essentials">Git Lfs essentials?</h3>
<div class="center">
<p>wget <a href="https://github.com/git-lfs/git-lfs/releases/download/v2.1.1/git-lfs-linux-amd64-2.1.1.tar.gz">https://github.com/git-lfs/git-lfs/releases/download/v2.1.1/git-lfs-linux-amd64-2.1.1.tar.gz</a> tar xavf git-lfs-linux-amd64-2.1.1.tar.gz cd xavf git-lfs-linux-amd64-2.1.1</p>
<p>./install.sh git lfs install</p>
<p>git lfs track "*.psd"</p>
<p>#Make sure .gitattributes is tracked</p>
<p>git add .gitattributes</p>
<p>#There is no step three. Just commit and push to GitHub as you normally would.</p>
<p>git add file.psd git commit -m "Add design file" git push origin master</p>
</div>
<p>from: <a href="https://git-lfs.github.com/">https://git-lfs.github.com/</a></p>
<h3 id="git-ssh">git &amp; ssh</h3>
<ol class="incremental">
<li><p>view ssh details?</p>
<ol class="incremental">
<li><p>git v2.3.0 or higher:</p>
<div class="sourceCode" id="cb329" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb329-1" title="1"><span class="va">GIT_SSH_COMMAND=</span><span class="st">&quot;ssh -vvv&quot;</span> <span class="fu">git</span> clone example</a></code></pre></div></li>
</ol></li>
<li><p>how to specify the ssh key used by git?</p>
<p>from: <a href="https://stackoverflow.com/questions/4565700/specify-private-ssh-key-to-use-when-executing-shell-command-with-or-without-ruby">https://stackoverflow.com/questions/4565700/specify-private-ssh-key-to-use-when-executing-shell-command-with-or-without-ruby</a></p>
<div class="sourceCode" id="cb330" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb330-1" title="1"><span class="fu">ssh-agent</span> bash -c <span class="st">&#39;ssh-add /somewhere/yourkey; git clone git@github.com:user/project.git&#39;</span></a></code></pre></div></li>
</ol>
<h3 id="diffing">Diffing</h3>
<ol class="incremental">
<li><p>show only the filnames that changed</p>
<div class="sourceCode" id="cb331" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb331-1" title="1"><span class="fu">git</span> diff --stat --names-only HEAD^^..HEAD^</a></code></pre></div></li>
</ol>
<h3 id="syntax-1">Syntax</h3>
<ol class="incremental">
<li><p>Reference Nthieme commit from HEAD?</p>
<div class="sourceCode" id="cb332" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb332-1" title="1"><span class="fu">git</span> checkout HEAD@<span class="dt">{30}</span></a></code></pre></div></li>
</ol>
<h3 id="colors-1">Colors</h3>
<ol class="incremental">
<li><p>git colors=always?</p>
<div class="sourceCode" id="cb333" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb333-1" title="1"><span class="fu">git</span> -c color.status=always status</a></code></pre></div></li>
</ol>
<h3 id="hacks">hacks</h3>
<ol class="incremental">
<li><p>how to git diff even if the repo do not have an empty init commit?</p>
<p>Use the magic sha1: 4b825dc642cb6eb9a060e54bf8d69288fbee4904 Event if only one commit in a repo (without a base empty commmit),</p>
<div class="sourceCode" id="cb334" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb334-1" title="1"><span class="fu">git</span> diff 4b825d..HEAD</a>
<a class="sourceLine" id="cb334-2" title="2"><span class="co">#&gt; will return the correct diff</span></a></code></pre></div></li>
</ol>
<h2 id="jq">Jq</h2>
<h3 id="finding">Finding</h3>
<ol class="incremental">
<li><p>recursively find a value by key?</p>
<div class="sourceCode" id="cb335" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb335-1" title="1"><span class="bu">echo</span> <span class="st">&#39;[{&quot;a&quot;: 1}, {&quot;b&quot;: 2}]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.. | .a? // empty&#39;</span></a>
<a class="sourceLine" id="cb335-2" title="2"><span class="co">#=&gt; 1</span></a></code></pre></div></li>
<li><p>recursively find all values of a given key?</p>
<div class="sourceCode" id="cb336" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb336-1" title="1">$ <span class="bu">echo</span> <span class="st">&#39;{</span></a>
<a class="sourceLine" id="cb336-2" title="2"><span class="st">  &quot;a&quot;: {</span></a>
<a class="sourceLine" id="cb336-3" title="3"><span class="st">    &quot;b&quot;: 1,</span></a>
<a class="sourceLine" id="cb336-4" title="4"><span class="st">    &quot;c&quot;: {</span></a>
<a class="sourceLine" id="cb336-5" title="5"><span class="st">      &quot;d&quot;: {</span></a>
<a class="sourceLine" id="cb336-6" title="6"><span class="st">        &quot;key&quot;: 42</span></a>
<a class="sourceLine" id="cb336-7" title="7"><span class="st">      },</span></a>
<a class="sourceLine" id="cb336-8" title="8"><span class="st">      &quot;e&quot;: 666</span></a>
<a class="sourceLine" id="cb336-9" title="9"><span class="st">    }</span></a>
<a class="sourceLine" id="cb336-10" title="10"><span class="st">  }</span></a>
<a class="sourceLine" id="cb336-11" title="11"><span class="st">}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;..| .key?//empty&#39;</span></a>
<a class="sourceLine" id="cb336-12" title="12"><span class="co">#=&gt; [</span></a>
<a class="sourceLine" id="cb336-13" title="13"><span class="co">#=&gt;   42</span></a>
<a class="sourceLine" id="cb336-14" title="14"><span class="co">#=&gt; ]</span></a></code></pre></div></li>
<li><p>recursively find all path leading to a given key</p>
<div class="sourceCode" id="cb337" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb337-1" title="1"><span class="bu">echo</span> <span class="st">&#39;{</span></a>
<a class="sourceLine" id="cb337-2" title="2"><span class="st">  &quot;a&quot;: {</span></a>
<a class="sourceLine" id="cb337-3" title="3"><span class="st">    &quot;b&quot;: 1,</span></a>
<a class="sourceLine" id="cb337-4" title="4"><span class="st">    &quot;c&quot;: {</span></a>
<a class="sourceLine" id="cb337-5" title="5"><span class="st">      &quot;d&quot;: {</span></a>
<a class="sourceLine" id="cb337-6" title="6"><span class="st">        &quot;key&quot;: 42</span></a>
<a class="sourceLine" id="cb337-7" title="7"><span class="st">      },</span></a>
<a class="sourceLine" id="cb337-8" title="8"><span class="st">      &quot;e&quot;: 666</span></a>
<a class="sourceLine" id="cb337-9" title="9"><span class="st">    }</span></a>
<a class="sourceLine" id="cb337-10" title="10"><span class="st">  }</span></a>
<a class="sourceLine" id="cb337-11" title="11"><span class="st">}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;path (..| .key?//empty)&#39;</span></a>
<a class="sourceLine" id="cb337-12" title="12"><span class="co">#=&gt; [</span></a>
<a class="sourceLine" id="cb337-13" title="13"><span class="co">#=&gt;   &quot;a&quot;,</span></a>
<a class="sourceLine" id="cb337-14" title="14"><span class="co">#=&gt;   &quot;c&quot;,</span></a>
<a class="sourceLine" id="cb337-15" title="15"><span class="co">#=&gt;   &quot;d&quot;,</span></a>
<a class="sourceLine" id="cb337-16" title="16"><span class="co">#=&gt;   &quot;key&quot;</span></a>
<a class="sourceLine" id="cb337-17" title="17"><span class="co">#=&gt; ]</span></a></code></pre></div></li>
<li><p>recursively find all path leading to a certain value?</p>
<div class="sourceCode" id="cb338" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb338-1" title="1"></a>
<a class="sourceLine" id="cb338-2" title="2"><span class="bu">echo</span> <span class="st">&#39;{</span></a>
<a class="sourceLine" id="cb338-3" title="3"><span class="st">    &quot;a&quot;: {</span></a>
<a class="sourceLine" id="cb338-4" title="4"><span class="st">      &quot;b&quot;: 1,</span></a>
<a class="sourceLine" id="cb338-5" title="5"><span class="st">      &quot;c&quot;: {</span></a>
<a class="sourceLine" id="cb338-6" title="6"><span class="st">        &quot;d&quot;: {</span></a>
<a class="sourceLine" id="cb338-7" title="7"><span class="st">          &quot;key&quot;: 42</span></a>
<a class="sourceLine" id="cb338-8" title="8"><span class="st">        },</span></a>
<a class="sourceLine" id="cb338-9" title="9"><span class="st">        &quot;e&quot;: 666</span></a>
<a class="sourceLine" id="cb338-10" title="10"><span class="st">      }</span></a>
<a class="sourceLine" id="cb338-11" title="11"><span class="st">    }</span></a>
<a class="sourceLine" id="cb338-12" title="12"><span class="st">  }&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;path(.. | select(. == 42))&#39;</span></a>
<a class="sourceLine" id="cb338-13" title="13"><span class="co">#&gt; [</span></a>
<a class="sourceLine" id="cb338-14" title="14"><span class="co">#&gt;   &quot;a&quot;,</span></a>
<a class="sourceLine" id="cb338-15" title="15"><span class="co">#&gt;   &quot;c&quot;,</span></a>
<a class="sourceLine" id="cb338-16" title="16"><span class="co">#&gt;   &quot;d&quot;,</span></a>
<a class="sourceLine" id="cb338-17" title="17"><span class="co">#&gt;   &quot;key&quot;</span></a>
<a class="sourceLine" id="cb338-18" title="18"><span class="co">#&gt; ]</span></a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td>jq 'path (..</td>
<td>.key?//empty)'</td>
</tr>
</tbody>
</table>
<p>#=&gt; [ #=&gt; "a", #=&gt; "c", #=&gt; "d", #=&gt; "key" #=&gt; ]</p>
<p>#+end<sub>src</sub></p></li>
<li><p>get all the values of an object?</p>
<div class="sourceCode" id="cb339" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb339-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;{&quot;a&quot;: 1} | .[]&#39;</span></a>
<a class="sourceLine" id="cb339-2" title="2"><span class="co">#=&gt; 1</span></a></code></pre></div></li>
<li><p>does this array contains this element?</p>
<div class="sourceCode" id="cb340" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb340-1" title="1"><span class="co"># - With contains:</span></a>
<a class="sourceLine" id="cb340-2" title="2"><span class="ex">jq</span> -n <span class="st">&#39;[4,3,2,1] | contains([0])&#39;</span> <span class="co">#&gt; false</span></a>
<a class="sourceLine" id="cb340-3" title="3"><span class="ex">jq</span> -n <span class="st">&#39;[4,3,2,1] | contains([2])&#39;</span> <span class="co">#&gt; true</span></a>
<a class="sourceLine" id="cb340-4" title="4"><span class="co"># - With inside:</span></a>
<a class="sourceLine" id="cb340-5" title="5"><span class="ex">jq</span> -n <span class="st">&#39;[0] | inside([1,2])&#39;</span>       <span class="co">#&gt; false</span></a></code></pre></div></li>
</ol>
<h3 id="modifying">Modifying</h3>
<ol class="incremental">
<li><p>delete the key of an object?</p>
<div class="sourceCode" id="cb341" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb341-1" title="1"><span class="bu">echo</span> <span class="st">&#39;{&quot;k&quot;: 1}&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;del(.k)&#39;</span></a></code></pre></div></li>
<li><p>jq update ?</p>
<div class="sourceCode" id="cb342" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb342-1" title="1">   <span class="ex">jq</span> -n <span class="st">&#39;{foo:1, bar:10} | .foo |= . + 1 &#39;</span></a>
<a class="sourceLine" id="cb342-2" title="2"><span class="co">#=&gt; {</span></a>
<a class="sourceLine" id="cb342-3" title="3"><span class="co">#=&gt;   &quot;foo&quot;: 2,</span></a>
<a class="sourceLine" id="cb342-4" title="4"><span class="co">#=&gt;   &quot;bar&quot;: 10</span></a>
<a class="sourceLine" id="cb342-5" title="5"><span class="co">#=&gt; }</span></a></code></pre></div></li>
<li><p>delete in nested datastructure?</p>
<div class="sourceCode" id="cb343" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb343-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;{a:1, b:2, c:3} | del(.. | .a?//empty)&#39;</span></a></code></pre></div></li>
<li><p>recursively delete all keys leading to pair numbers?</p>
<p>Note: Probably could be written more concisely:</p>
<div class="sourceCode" id="cb344" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb344-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;{a:1, b:2, c:3} \</span></a>
<a class="sourceLine" id="cb344-2" title="2"><span class="st">  | del(.. | numbers | (if (. % 2) == 0 then . else empty end))&#39;</span></a></code></pre></div></li>
<li><p>deep merge two nested datastructure?</p>
<p>Use the <code>*</code> operator:</p>
<div class="sourceCode" id="cb345" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb345-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;{a: 1, b: {ba: 10, bb: {bba: 42, bbb: 43} }} * {b: {bb: {bba: 49}}}&#39;</span></a>
<a class="sourceLine" id="cb345-2" title="2"><span class="co">#=&gt; {</span></a>
<a class="sourceLine" id="cb345-3" title="3"><span class="co">#=&gt;   &quot;a&quot;: 1,</span></a>
<a class="sourceLine" id="cb345-4" title="4"><span class="co">#=&gt;   &quot;b&quot;: {</span></a>
<a class="sourceLine" id="cb345-5" title="5"><span class="co">#=&gt;     &quot;ba&quot;: 10,</span></a>
<a class="sourceLine" id="cb345-6" title="6"><span class="co">#=&gt;     &quot;bb&quot;: {</span></a>
<a class="sourceLine" id="cb345-7" title="7"><span class="co">#=&gt;       &quot;bba&quot;: 49,</span></a>
<a class="sourceLine" id="cb345-8" title="8"><span class="co">#=&gt;       &quot;bbb&quot;: 43</span></a>
<a class="sourceLine" id="cb345-9" title="9"><span class="co">#=&gt;     }</span></a>
<a class="sourceLine" id="cb345-10" title="10"><span class="co">#=&gt;   }</span></a>
<a class="sourceLine" id="cb345-11" title="11"><span class="co">#=&gt; }</span></a></code></pre></div></li>
</ol>
<h3 id="strings-regex">Strings / Regex</h3>
<ol class="incremental">
<li><p>jq regexes cheet sheat ?</p>
<ol class="incremental">
<li><p>jq regex flags</p>
<p>flag usage example:</p>
<div class="sourceCode" id="cb346" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb346-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;&quot;FOO&quot; | test(&quot;foo&quot;; &quot;i&quot;)&#39;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th>flags</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>g</code></td>
<td>Global match, find all not just the first</td>
</tr>
<tr class="even">
<td><code>i</code></td>
<td>case Insensitive</td>
</tr>
<tr class="odd">
<td><code>m</code></td>
<td>Multi line match '.' will match newlines</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td>ignore empty matches</td>
</tr>
<tr class="odd">
<td><code>p</code></td>
<td>both s and m mode enabled</td>
</tr>
<tr class="even">
<td><code>s</code></td>
<td>Single line mode <code>('^' -&gt; '\\A','$'-&gt;\\Z')</code></td>
</tr>
<tr class="odd">
<td><code>l</code></td>
<td>find Longest possible matches</td>
</tr>
<tr class="even">
<td><code>x</code></td>
<td>eXtended regex format (ignore whitespace and comments)</td>
</tr>
</tbody>
</table></li>
<li><p>jq regex functions</p>
<table>
<thead>
<tr class="header">
<th>fn</th>
<th>args1</th>
<th>args2</th>
<th>result if match</th>
<th>else</th>
<th>jq program example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>test</code></td>
<td><code>val</code></td>
<td><code>regex</code></td>
<td><code>true</code></td>
<td><code>false</code></td>
<td><code>test("foo")</code></td>
</tr>
<tr class="even">
<td><code>test</code></td>
<td><code>”</code></td>
<td><code>regex; flags</code></td>
<td><code>true</code></td>
<td><code>false</code></td>
<td><code>test("foo")</code></td>
</tr>
<tr class="odd">
<td><code>match</code></td>
<td><code>”</code></td>
<td><code>”</code></td>
<td><code>{offset,length,string,captures}</code></td>
<td><code>empty</code></td>
<td><code>match("(abc)+"; "g")</code></td>
</tr>
<tr class="even">
<td><code>capture</code></td>
<td><code>”</code></td>
<td><code>”</code></td>
<td><code>map of matches</code></td>
<td><code>empty</code></td>
<td><code>capture("(?&lt;a&gt;[a-z]+)-(?&lt;n&gt;[0-9]+)")</code></td>
</tr>
<tr class="odd">
<td><code>scan</code></td>
<td><code>”</code></td>
<td><code>”</code></td>
<td><code>stream of non overlapping matches</code></td>
<td><code>empty</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>split</code></td>
<td><code>”</code></td>
<td><code>”</code></td>
<td><code>&lt;obsolete&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>splits</code></td>
<td><code>”</code></td>
<td><code>”</code></td>
<td><code>stream matches</code></td>
<td><code>?</code></td>
<td><code>splits("\\s+")</code></td>
</tr>
</tbody>
</table></li>
</ol></li>
<li><p>recursively find containers having a value that match a given regex?</p>
<div class="sourceCode" id="cb347" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb347-1" title="1">   <span class="ex">jq.help</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.. | select(.[]? | strings | test(&quot;transpose&quot;))&#39;</span></a>
<a class="sourceLine" id="cb347-2" title="2"><span class="co">#=&gt; {</span></a>
<a class="sourceLine" id="cb347-3" title="3"><span class="co">#=&gt;   &quot;body&quot;: &quot;\nTranspose a possibly jagged matrix (an array of arrays).\nRows are padded with nulls so the result is always rectangular.\n&quot;,</span></a>
<a class="sourceLine" id="cb347-4" title="4"><span class="co">#=&gt;   &quot;examples&quot;: [</span></a>
<a class="sourceLine" id="cb347-5" title="5"><span class="co">#=&gt;     {</span></a>
<a class="sourceLine" id="cb347-6" title="6"><span class="co">#=&gt;       &quot;input&quot;: &quot;[[1], [2,3]]&quot;,</span></a>
<a class="sourceLine" id="cb347-7" title="7"><span class="co">#=&gt;       &quot;program&quot;: &quot;transpose&quot;,</span></a>
<a class="sourceLine" id="cb347-8" title="8"><span class="co">#=&gt;       &quot;output&quot;: [</span></a>
<a class="sourceLine" id="cb347-9" title="9"><span class="co">#=&gt;         &quot;[[1,2],[null,3]]&quot;</span></a>
<a class="sourceLine" id="cb347-10" title="10"><span class="co">#=&gt;       ]</span></a>
<a class="sourceLine" id="cb347-11" title="11"><span class="co">#=&gt;     }</span></a>
<a class="sourceLine" id="cb347-12" title="12"><span class="co">#=&gt;   ],</span></a>
<a class="sourceLine" id="cb347-13" title="13"><span class="co">#=&gt;   &quot;title&quot;: &quot;`transpose`&quot;</span></a>
<a class="sourceLine" id="cb347-14" title="14"><span class="co">#=&gt; }</span></a>
<a class="sourceLine" id="cb347-15" title="15"><span class="co">#=&gt; (...)</span></a></code></pre></div></li>
<li><p>convert string to upper case?</p>
<div class="sourceCode" id="cb348" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb348-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;&quot;abCD&quot; | ascii_upcase&#39;</span></a>
<a class="sourceLine" id="cb348-2" title="2"><span class="co">#=&gt; &quot;ABCD&quot;</span></a></code></pre></div></li>
<li><p>jq regex replace?</p>
<div class="sourceCode" id="cb349" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb349-1" title="1"><span class="ex">sub</span>(regex<span class="kw">;</span> <span class="ex">string</span>)</a>
<a class="sourceLine" id="cb349-2" title="2"><span class="ex">jq</span> -n <span class="st">&#39;&quot;foo bar&quot; | sub(&quot; &quot;; &quot;x&quot;)&#39;</span></a></code></pre></div></li>
<li><p>jq regex search and replace with backreferences</p>
<div class="sourceCode" id="cb350" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb350-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39; .</span></a>
<a class="sourceLine" id="cb350-2" title="2"><span class="st">| &quot;foo&quot;</span></a>
<a class="sourceLine" id="cb350-3" title="3"><span class="st">| gsub(</span></a>
<a class="sourceLine" id="cb350-4" title="4"><span class="st">    &quot;^(?&lt;pre&gt;.*)(?&lt;n&gt;o)(?&lt;post&gt;.*)$&quot;</span></a>
<a class="sourceLine" id="cb350-5" title="5"><span class="st">  ;</span></a>
<a class="sourceLine" id="cb350-6" title="6"><span class="st">     &quot;\(.pre) - \(.n) - \(.post)&quot;</span></a>
<a class="sourceLine" id="cb350-7" title="7"><span class="st">  )</span></a>
<a class="sourceLine" id="cb350-8" title="8"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb350-9" title="9"><span class="co">#&gt; &quot;fo - o - &quot;</span></a></code></pre></div></li>
<li><p>substring?</p>
<div class="sourceCode" id="cb351" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb351-1" title="1">     <span class="bu">echo</span> foo <span class="kw">|</span> <span class="ex">jq</span> -R <span class="st">&#39;.[0:1]&#39;</span></a>
<a class="sourceLine" id="cb351-2" title="2"><span class="st">&quot;f&quot;</span></a></code></pre></div></li>
</ol>
<h3 id="quoting">Quoting</h3>
<ol class="incremental">
<li><p>given a known char I want to encode it in a json string for consumption by jq</p>
<div class="sourceCode" id="cb352" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb352-1" title="1"><span class="va">char=</span><span class="st">&quot;&#39;&quot;</span></a>
<a class="sourceLine" id="cb352-2" title="2"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb352-3" title="3"><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${char}</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">jq</span> -R explode</a>
<a class="sourceLine" id="cb352-4" title="4"><span class="co">#&gt; [39]</span></a>
<a class="sourceLine" id="cb352-5" title="5"><span class="co"># Convert the decimal to hex</span></a>
<a class="sourceLine" id="cb352-6" title="6"><span class="bu">echo</span> <span class="st">&quot;obase=16; 39&quot;</span> <span class="kw">|</span> <span class="fu">bc</span></a>
<a class="sourceLine" id="cb352-7" title="7"><span class="co">#&gt; 27</span></a>
<a class="sourceLine" id="cb352-8" title="8"><span class="co"># Encode the char in the string</span></a>
<a class="sourceLine" id="cb352-9" title="9"><span class="bu">echo</span> <span class="st">&#39;&quot;\\u0027&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> .</a>
<a class="sourceLine" id="cb352-10" title="10"><span class="co">#&gt; &quot;&#39;&quot;</span></a></code></pre></div></li>
<li><p>Single Quote</p>
<ol class="incremental">
<li><p>single quote as a integer (to escape it in bash)?</p>
<div class="sourceCode" id="cb353" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb353-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;([39] | implode) as $quote | $quote&#39;</span></a>
<a class="sourceLine" id="cb353-2" title="2"><span class="co">#&gt; &quot;&#39;&quot;</span></a></code></pre></div></li>
<li><p>encode a single quote in a string for jq to decode?</p>
<div class="sourceCode" id="cb354" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb354-1" title="1"><span class="co"># Encode the char in the string</span></a>
<a class="sourceLine" id="cb354-2" title="2"><span class="bu">echo</span> <span class="st">&#39;&quot;\\u0027&quot;&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> .</a>
<a class="sourceLine" id="cb354-3" title="3"><span class="co">#&gt; &quot;&#39;&quot;</span></a></code></pre></div></li>
</ol></li>
</ol>
<h3 id="interop">Interop</h3>
<ol class="incremental">
<li><p>output a array for bash?</p>
<div class="sourceCode" id="cb355" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb355-1" title="1"><span class="bu">echo</span> <span class="st">&#39;[1,2,3]&#39;</span> <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;.|@tsv&#39;</span></a></code></pre></div></li>
</ol>
<h3 id="functional">Functional</h3>
<ol class="incremental">
<li><p>reduce ?</p>
<div class="sourceCode" id="cb356" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb356-1" title="1"><span class="bu">echo</span> <span class="st">&#39;[1,2,3]&#39;</span> \</a>
<a class="sourceLine" id="cb356-2" title="2"><span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;reduce .[] as $item (0; . + $item)&#39;</span></a></code></pre></div></li>
<li><p>zip two arrays into a map?</p>
<div class="sourceCode" id="cb357" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb357-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb357-2" title="2"><span class="st">  [&quot;a&quot;,&quot;b&quot;] as $a | [1,2] as $b</span></a>
<a class="sourceLine" id="cb357-3" title="3"><span class="st">| [$a,$b]</span></a>
<a class="sourceLine" id="cb357-4" title="4"><span class="st">| transpose | map({(.[0]): .[1]})</span></a>
<a class="sourceLine" id="cb357-5" title="5"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb357-6" title="6"><span class="co">#&gt; [</span></a>
<a class="sourceLine" id="cb357-7" title="7"><span class="co">#&gt;  {</span></a>
<a class="sourceLine" id="cb357-8" title="8"><span class="co">#&gt;    &quot;a&quot;: 1</span></a>
<a class="sourceLine" id="cb357-9" title="9"><span class="co">#&gt;  },</span></a>
<a class="sourceLine" id="cb357-10" title="10"><span class="co">#&gt;  {</span></a>
<a class="sourceLine" id="cb357-11" title="11"><span class="co">#&gt;    &quot;b&quot;: 2</span></a>
<a class="sourceLine" id="cb357-12" title="12"><span class="co">#&gt;  }</span></a>
<a class="sourceLine" id="cb357-13" title="13"><span class="co">#&gt;</span></a></code></pre></div></li>
<li><p>Comma in function args</p>
<ol class="incremental">
<li><p>given a list of strings and a list of regexes, for each string check wether it matches all the given regexes or not</p>
<div class="sourceCode" id="cb358" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb358-1" title="1"><span class="ex">jq</span> -R <span class="op">&lt;&lt;&lt;</span> <span class="st">&#39;ac</span></a>
<a class="sourceLine" id="cb358-2" title="2"><span class="st">ab</span></a>
<a class="sourceLine" id="cb358-3" title="3"><span class="st">cb&#39;</span>  \</a>
<a class="sourceLine" id="cb358-4" title="4"><span class="st">&#39;.</span></a>
<a class="sourceLine" id="cb358-5" title="5"><span class="st">| [test(&quot;a&quot;,&quot;b&quot;)]</span></a>
<a class="sourceLine" id="cb358-6" title="6"><span class="st">| all</span></a>
<a class="sourceLine" id="cb358-7" title="7"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb358-8" title="8"><span class="co">#&gt; false</span></a>
<a class="sourceLine" id="cb358-9" title="9"><span class="co">#&gt; true</span></a>
<a class="sourceLine" id="cb358-10" title="10"><span class="co">#&gt; false</span></a></code></pre></div></li>
</ol></li>
<li><p>clojure's reductions equivalent in jq?</p>
<div class="sourceCode" id="cb359" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb359-1" title="1">     <span class="co"># ex: infinite fibonacci sequence from an infinite seq of integers:</span></a>
<a class="sourceLine" id="cb359-2" title="2"><span class="fu">seq</span> 0 Infinity                                                                        \</a>
<a class="sourceLine" id="cb359-3" title="3"><span class="kw">|</span> <span class="ex">jql</span> -cn <span class="st">&#39;foreach ( inputs , null) as $l ( [1,1] ; [$l, .[0] + $l]?//empty ; .[1])&#39;</span>  \</a>
<a class="sourceLine" id="cb359-4" title="4"><span class="kw">|</span> <span class="fu">head</span> <span class="kw">|</span> <span class="fu">xargs</span></a></code></pre></div></li>
</ol>
<h3 id="convert">Convert</h3>
<ol class="incremental">
<li><p>TODO element to array?</p></li>
<li><p>convert an array to a map?</p>
<div class="sourceCode" id="cb360" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb360-1" title="1">     <span class="bu">echo</span> <span class="st">&#39;[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]       &#39;</span> \</a>
<a class="sourceLine" id="cb360-2" title="2">     <span class="kw">|</span> <span class="ex">jq</span> <span class="st">&#39;[{(.[]): null}] | add &#39;</span></a>
<a class="sourceLine" id="cb360-3" title="3"><span class="co">#=&gt;  {</span></a>
<a class="sourceLine" id="cb360-4" title="4"><span class="co">#=&gt;   &quot;a&quot;: null,</span></a>
<a class="sourceLine" id="cb360-5" title="5"><span class="co">#=&gt;   &quot;b&quot;: null,</span></a>
<a class="sourceLine" id="cb360-6" title="6"><span class="co">#=&gt;   &quot;c&quot;: null</span></a>
<a class="sourceLine" id="cb360-7" title="7"><span class="co">#=&gt;  }</span></a></code></pre></div></li>
</ol>
<h3 id="dates-and-time">Dates and time</h3>
<ol class="incremental">
<li><p>Get a human readable date of current time?</p>
<div class="sourceCode" id="cb361" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb361-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;now | todate&#39;</span></a>
<a class="sourceLine" id="cb361-2" title="2"><span class="co">#&gt; &quot;2017-09-12T18:35:01Z&quot;</span></a></code></pre></div></li>
<li><p>Convert Unix epoch time in second to human readable?</p>
<div class="sourceCode" id="cb362" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb362-1" title="1"><span class="co"># There may be more direct way..</span></a>
<a class="sourceLine" id="cb362-2" title="2"><span class="ex">jql</span> -n <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb362-3" title="3"><span class="st">  .</span></a>
<a class="sourceLine" id="cb362-4" title="4"><span class="st">  | 1565108215</span></a>
<a class="sourceLine" id="cb362-5" title="5"><span class="st">  | gmtime</span></a>
<a class="sourceLine" id="cb362-6" title="6"><span class="st">  | strftime(&quot;%Y-%m-%dT%H:%M:%SZ&quot;)</span></a>
<a class="sourceLine" id="cb362-7" title="7"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb362-8" title="8"><span class="co">#&gt; &quot;2019-08-06T16:16:55Z&quot;</span></a></code></pre></div></li>
<li><p>parse and format date with jq?</p>
<div class="sourceCode" id="cb363" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb363-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;.</span></a>
<a class="sourceLine" id="cb363-2" title="2"><span class="st">| .ms        = now</span></a>
<a class="sourceLine" id="cb363-3" title="3"><span class="st">| .fmt       = (.ms  | todate  )</span></a>
<a class="sourceLine" id="cb363-4" title="4"><span class="st">| .fmtParsed = (.fmt | fromdate)</span></a>
<a class="sourceLine" id="cb363-5" title="5"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb363-6" title="6"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb363-7" title="7"><span class="co">#&gt;   &quot;ms&quot;        : 1578648180.671493      ,</span></a>
<a class="sourceLine" id="cb363-8" title="8"><span class="co">#&gt;   &quot;fmt&quot;       : &quot;2020-01-10T09:23:00Z&quot; ,</span></a>
<a class="sourceLine" id="cb363-9" title="9"><span class="co">#&gt;   &quot;fmtParsed&quot; : 1578648180</span></a>
<a class="sourceLine" id="cb363-10" title="10"><span class="co">#&gt; }</span></a></code></pre></div></li>
</ol>
<h3 id="other-1">Other</h3>
<ol class="incremental">
<li><p>Undocumented debug options?</p>
<div class="sourceCode" id="cb364" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb364-1" title="1"> <span class="ex">jq</span> -n --debug-trace <span class="st">&#39;1&#39;</span></a>
<a class="sourceLine" id="cb364-2" title="2"> <span class="co">#&gt; 0000 TOP</span></a>
<a class="sourceLine" id="cb364-3" title="3"> <span class="co">#&gt; 0001 LOADK 1    null</span></a>
<a class="sourceLine" id="cb364-4" title="4"> <span class="co">#&gt; 0003 RET        1</span></a>
<a class="sourceLine" id="cb364-5" title="5"> <span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb364-6" title="6"> <span class="co">#&gt; 0003 RET                &lt;backtracking&gt;</span></a>
<a class="sourceLine" id="cb364-7" title="7"> <span class="ex">jq</span> -n --debug-dump-disasm <span class="st">&#39;1&#39;</span></a>
<a class="sourceLine" id="cb364-8" title="8"> <span class="co">#&gt; 0000 TOP</span></a>
<a class="sourceLine" id="cb364-9" title="9"> <span class="co">#&gt; 0001 LOADK 1</span></a>
<a class="sourceLine" id="cb364-10" title="10"> <span class="co">#&gt; 0003 RET</span></a>
<a class="sourceLine" id="cb364-11" title="11"><span class="co">#&gt;</span></a>
<a class="sourceLine" id="cb364-12" title="12"><span class="co">#&gt; 1</span></a></code></pre></div></li>
<li><p>Syntax</p>
<ol class="incremental">
<li><p>Liberal Object notation?</p>
<div class="sourceCode" id="cb365" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb365-1" title="1">      <span class="co"># can leave comma after last object:</span></a>
<a class="sourceLine" id="cb365-2" title="2">      <span class="ex">jq</span> -n <span class="st">&#39;.</span></a>
<a class="sourceLine" id="cb365-3" title="3"><span class="st">| {</span></a>
<a class="sourceLine" id="cb365-4" title="4"><span class="st">    a: 1,</span></a>
<a class="sourceLine" id="cb365-5" title="5"><span class="st">    b: 2,</span></a>
<a class="sourceLine" id="cb365-6" title="6"><span class="st">  }</span></a>
<a class="sourceLine" id="cb365-7" title="7"><span class="st">&#39;</span></a>
<a class="sourceLine" id="cb365-8" title="8"><span class="co">#&gt; {&quot;a&quot;:1,&quot;b&quot;:2}</span></a>
<a class="sourceLine" id="cb365-9" title="9">      <span class="co"># Note: do not seems to works wtih arrays ...</span></a></code></pre></div></li>
</ol></li>
</ol>
<h2 id="lua">Lua</h2>
<h3 id="call-external-command-and-get-stdout">Call external command and get stdout?</h3>
<div class="sourceCode" id="cb366" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb366-1" title="1"> <span class="ex">lua</span> <span class="op">&lt;&lt;&lt;</span> <span class="st">&#39;</span></a>
<a class="sourceLine" id="cb366-2" title="2"><span class="st">cmd=&quot;seq 3&quot;</span></a>
<a class="sourceLine" id="cb366-3" title="3"><span class="st">f=assert(io.popen(cmd))</span></a>
<a class="sourceLine" id="cb366-4" title="4"><span class="st">for line in f:lines() do</span></a>
<a class="sourceLine" id="cb366-5" title="5"><span class="st">  print(line)</span></a>
<a class="sourceLine" id="cb366-6" title="6"><span class="st">end&#39;</span></a>
<a class="sourceLine" id="cb366-7" title="7"><span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb366-8" title="8"><span class="co">#&gt; 2</span></a>
<a class="sourceLine" id="cb366-9" title="9"><span class="co">#&gt; 3</span></a></code></pre></div>
<h3 id="call-external-command-and-get-stdout-and-return-code">Call external command and get stdout and return code?</h3>
<p>it seems not straighforward to do. Seem to have to implement this by adding some way to get the rc from the command :-(</p>
<h2 id="luaunicode">LuaUnicode</h2>
<h3 id="handy-emoticon">Handy emoticon ?</h3>
<table>
<tbody>
<tr class="odd">
<td>thumbs up</td>
<td>👍</td>
</tr>
<tr class="even">
<td></td>
<td>👏y</td>
</tr>
<tr class="odd">
<td>speaker</td>
<td>🔇</td>
</tr>
<tr class="even">
<td></td>
<td>2🔈</td>
</tr>
<tr class="odd">
<td></td>
<td>🔉</td>
</tr>
<tr class="even">
<td></td>
<td>🔊</td>
</tr>
<tr class="odd">
<td>warn</td>
<td>⚠</td>
</tr>
<tr class="even">
<td>full block</td>
<td>█</td>
</tr>
<tr class="odd">
<td>cross</td>
<td>✘</td>
</tr>
<tr class="even">
<td>arrow</td>
<td>↘</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="arrows">arrows</h3>
<div class="sourceCode" id="cb367" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb367-1" title="1">        <span class="ex">0</span>   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F</a>
<a class="sourceLine" id="cb367-2" title="2"><span class="ex">U+219x</span>  ←   ↑   →   ↓   ↔   ↕   ↖   ↗   ↘   ↙   ↚   ↛   ↜   ↝   ↞   ↟</a>
<a class="sourceLine" id="cb367-3" title="3"><span class="ex">U+21Ax</span>  ↠   ↡   ↢   ↣   ↤   ↥   ↦   ↧   ↨   ↩   ↪   ↫   ↬   ↭   ↮   ↯</a>
<a class="sourceLine" id="cb367-4" title="4"><span class="ex">U+21Bx</span>  ↰   ↱   ↲   ↳   ↴   ↵   ↶   ↷   ↸   ↹   ↺   ↻   ↼   ↽   ↾   ↿</a>
<a class="sourceLine" id="cb367-5" title="5"><span class="ex">U+21Cx</span>  ⇀   ⇁   ⇂   ⇃   ⇄   ⇅   ⇆   ⇇   ⇈   ⇉   ⇊   ⇋   ⇌   ⇍   ⇎   ⇏</a>
<a class="sourceLine" id="cb367-6" title="6"><span class="ex">U+21Dx</span>  ⇐   ⇑   ⇒   ⇓   ⇔   ⇕   ⇖   ⇗   ⇘   ⇙   ⇚   ⇛   ⇜   ⇝   ⇞   ⇟</a>
<a class="sourceLine" id="cb367-7" title="7"><span class="ex">U+21Ex</span>  ⇠   ⇡   ⇢   ⇣   ⇤   ⇥   ⇦   ⇧   ⇨   ⇩   ⇪   ⇫   ⇬   ⇭   ⇮   ⇯</a>
<a class="sourceLine" id="cb367-8" title="8"><span class="ex">U+21Fx</span>  ⇰   ⇱   ⇲   ⇳   ⇴   ⇵   ⇶   ⇷   ⇸   ⇹   ⇺   ⇻   ⇼   ⇽   ⇾   ⇿</a></code></pre></div>
<h3 id="draft">draft</h3>
<p>see: <a href="https://en.wikipedia.org/wiki/List_of_U│nicode_characters#Box_Drawing">https://en.wikipedia.org/wiki/List_of_U│nicode_characters#Box_Drawing</a></p>
<pre><code>   ┌┐
   └┘
   ┌┐┌┐
   └┘└┘
   ─┐
   ─┘
   ┌─┐
   └─┘
   ┌──┐
   │  │
   └──┘
   ╭─╮
   ╰─╯




   ┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌┐┌
   └┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘└┘
─
─
═ ║ ╒ ╓ ╔ ╕ ╖ ╗ ╘ ╙ ╚ ╛ ╜ ╝ ╞ ╟ ╠ ╡ ╢ ╣ ╤ ╥ ╦ ╧ ╨ ╩ ╪ ╫ ╬
p
╔════════╗
║        ║
║        ║
║        ║
╚════════╝
</code></pre>
<ol class="incremental">
<li><p>boxes</p>
<table>
<tbody>
<tr class="odd">
<td>┌──────┐</td>
<td>╭──────╮</td>
<td>╭┈┈┈┈┈┈╮</td>
</tr>
<tr class="even">
<td>│ │</td>
<td>│ │</td>
<td>┊ ┊</td>
</tr>
<tr class="odd">
<td>│ │</td>
<td>│ │</td>
<td>┊ ┊</td>
</tr>
<tr class="even">
<td>└──────┘</td>
<td>╰──────╯</td>
<td>╰┈┈┈┈┈┈╯</td>
</tr>
<tr class="odd">
<td>╭╍╍╍╍╍╍╮</td>
<td>▛▀▀▀▀▀▀▜</td>
<td>░░░░░░░░</td>
</tr>
<tr class="even">
<td>┇ ┇</td>
<td>▌ ▐</td>
<td>░ ░</td>
</tr>
<tr class="odd">
<td>┇ ┇</td>
<td>▌ ▐</td>
<td>░ ░</td>
</tr>
<tr class="even">
<td>╰╍╍╍╍╍╍╯</td>
<td>▙▄▄▄▄▄▄▟</td>
<td>░░░░░░░░</td>
</tr>
<tr class="odd">
<td>▒▒▒▒▒▒▒▒</td>
<td>▓▓▓▓▓▓▓▓</td>
<td>████████</td>
</tr>
<tr class="even">
<td>▒ ▒</td>
<td>▓ ▓</td>
<td>█ █</td>
</tr>
<tr class="odd">
<td>▒ ▒</td>
<td>▓ ▓</td>
<td>█ █</td>
</tr>
<tr class="even">
<td>▒▒▒▒▒▒▒▒</td>
<td>▓▓▓▓▓▓▓▓</td>
<td>████████</td>
</tr>
</tbody>
</table></li>
</ol>
<h3 id="use-char-by-its-code">use char by its code ?</h3>
<h3 id="unicode-number-in-circle">unicode number in circle</h3>
<table>
<tbody>
<tr class="odd">
<td>1</td>
<td>①</td>
<td>❶</td>
<td>⬤</td>
</tr>
<tr class="even">
<td>2</td>
<td>②</td>
<td>❷</td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td>③</td>
<td>❸</td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>④</td>
<td>❹</td>
<td></td>
</tr>
<tr class="odd">
<td>5</td>
<td>⑤</td>
<td>❺</td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td>⑥</td>
<td>❻</td>
<td></td>
</tr>
<tr class="odd">
<td>7</td>
<td>⑦</td>
<td>❼</td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td>⑧</td>
<td>❽</td>
<td></td>
</tr>
<tr class="odd">
<td>9</td>
<td>⑨</td>
<td>❾</td>
<td></td>
</tr>
<tr class="even">
<td>10</td>
<td>⑩</td>
<td>❿</td>
<td></td>
</tr>
<tr class="odd">
<td>11</td>
<td>⑪</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>12</td>
<td>⑫</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>13</td>
<td>⑬</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>14</td>
<td>⑭</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>15</td>
<td>⑮</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>16</td>
<td>⑯</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>17</td>
<td>⑰</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>18</td>
<td>⑱</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>19</td>
<td>⑲</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>20</td>
<td>⑳</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="lambda">lambda</h3>
<div class="sourceCode" id="cb369" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb369-1" title="1">λ</a></code></pre></div>
<h3 id="elipsis">elipsis?</h3>
<div class="sourceCode" id="cb370" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb370-1" title="1">…</a></code></pre></div>
<h3 id="checkmarks">Checkmarks</h3>
<ol class="incremental">
<li><p>check / uncheck marks?</p>
<div class="sourceCode" id="cb371" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb371-1" title="1">🗹 <span class="ex">DONE</span> stuff done</a>
<a class="sourceLine" id="cb371-2" title="2">☐ <span class="ex">TODO</span> stuff todo</a></code></pre></div>
<ul class="incremental">
<li><p>alternative:</p>
<div class="sourceCode" id="cb372" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb372-1" title="1">☑</a>
<a class="sourceLine" id="cb372-2" title="2"></a></code></pre></div></li>
</ul></li>
<li><p>more check marks?</p>
<p>from: <a href="https://en.wikipedia.org/wiki/X_mark">https://en.wikipedia.org/wiki/X_mark</a></p>
<table>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Unicode Code point (hex)</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>☐</td>
<td>U+2610</td>
<td>BALLOT BOX (checkbox)</td>
</tr>
<tr class="even">
<td>☒</td>
<td>U+2612</td>
<td>BALLOT BOX WITH X (square with cross)</td>
</tr>
<tr class="odd">
<td>✗</td>
<td>U+2717</td>
<td>BALLOT X (cross)</td>
</tr>
<tr class="even">
<td>✘</td>
<td>U+2718</td>
<td>HEAVY BALLOT X (bold cross)</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb373" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb373-1" title="1"><span class="kw">|</span> <span class="ex">Symbol</span> <span class="kw">|</span> <span class="ex">Unicode</span> Code point (hex) <span class="kw">|</span> <span class="ex">Name</span>                                               <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-2" title="2"><span class="kw">|</span><span class="ex">--------+--------------------------+----------------------------------------------------</span><span class="kw">|</span></a>
<a class="sourceLine" id="cb373-3" title="3"><span class="kw">|</span> ×      <span class="kw">|</span> <span class="ex">U+00D7</span>                   <span class="kw">|</span> <span class="ex">MULTIPLICATION</span> SIGN (z notation Cartesian product) <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-4" title="4"><span class="kw">|</span> ╳      <span class="kw">|</span> <span class="ex">U+2573</span>                   <span class="kw">|</span> <span class="ex">BOX</span> DRAWINGS LIGHT DIAGONAL CROSS                  <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-5" title="5"><span class="kw">|</span> ☓      <span class="kw">|</span> <span class="ex">U+2613</span>                   <span class="kw">|</span> <span class="ex">SALTIRE</span> (St Andrew<span class="st">&#39;s Cross)                        |</span></a>
<a class="sourceLine" id="cb373-6" title="6"><span class="st">| ✕      | U+2715                   | MULTIPLICATION X                                   |</span></a>
<a class="sourceLine" id="cb373-7" title="7"><span class="st">| ✖      | U+2716                   | HEAVY MULTIPLICATION X                             |</span></a>
<a class="sourceLine" id="cb373-8" title="8"><span class="st">| ❌     | U+274C                   | CROSS MARK                                         |</span></a>
<a class="sourceLine" id="cb373-9" title="9"><span class="st">| ❎     | U+274E                   | NEGATIVE SQUARED CROSS MARK                        |</span></a>
<a class="sourceLine" id="cb373-10" title="10"><span class="st">| ⨉      | U+2A09                   | N-ARY TIMES OPERATOR                               |</span></a>
<a class="sourceLine" id="cb373-11" title="11"><span class="st">| ⨯      | U+2A2F                   | VECTOR OR CROSS PRODUCT                            |</span></a>
<a class="sourceLine" id="cb373-12" title="12"><span class="st">| 🗙      | U+1F5D9                  | CANCELLATION X                                     |</span></a>
<a class="sourceLine" id="cb373-13" title="13"><span class="st">| 🗴      | U+1F5F4                  | BALLOT SCRIPT X                                    |</span></a>
<a class="sourceLine" id="cb373-14" title="14"><span class="st">| 🞩      | U+1F7A9                  | LIGHT SALTIRE                                      |</span></a>
<a class="sourceLine" id="cb373-15" title="15"><span class="st">| ×      | U+00D7                   | MULTIPLICATION SIGN (z notation Cartesian product) |</span></a>
<a class="sourceLine" id="cb373-16" title="16"><span class="st">| ╳      | U+2573                   | BOX DRAWINGS LIGHT DIAGONAL CROSS                  |</span></a>
<a class="sourceLine" id="cb373-17" title="17"><span class="st">| ☓      | U+2613                   | SALTIRE (St Andrew&#39;</span>s Cross)                        <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-18" title="18"><span class="kw">|</span> ✕      <span class="kw">|</span> <span class="ex">U+2715</span>                   <span class="kw">|</span> <span class="ex">MULTIPLICATION</span> X                                   <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-19" title="19"><span class="kw">|</span> ✖      <span class="kw">|</span> <span class="ex">U+2716</span>                   <span class="kw">|</span> <span class="ex">HEAVY</span> MULTIPLICATION X                             <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-20" title="20"><span class="kw">|</span> ❌     <span class="kw">|</span> <span class="ex">U+274C</span>                   <span class="kw">|</span> <span class="ex">CROSS</span> MARK                                         <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-21" title="21"><span class="kw">|</span> ❎     <span class="kw">|</span> <span class="ex">U+274E</span>                   <span class="kw">|</span> <span class="ex">NEGATIVE</span> SQUARED CROSS MARK                        <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-22" title="22"><span class="kw">|</span> ⨉      <span class="kw">|</span> <span class="ex">U+2A09</span>                   <span class="kw">|</span> <span class="ex">N-ARY</span> TIMES OPERATOR                               <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-23" title="23"><span class="kw">|</span> ⨯      <span class="kw">|</span> <span class="ex">U+2A2F</span>                   <span class="kw">|</span> <span class="ex">VECTOR</span> OR CROSS PRODUCT                            <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-24" title="24"><span class="kw">|</span> 🗙      <span class="kw">|</span> <span class="ex">U+1F5D9</span>                  <span class="kw">|</span>   <span class="ex">CANCELLATION</span> X                                   <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-25" title="25"><span class="kw">|</span> 🗴      <span class="kw">|</span> <span class="ex">U+1F5F4</span>                  <span class="kw">|</span>   <span class="ex">BALLOT</span> SCRIPT X                                  <span class="kw">|</span></a>
<a class="sourceLine" id="cb373-26" title="26"><span class="kw">|</span> 🞩      <span class="kw">|</span> <span class="ex">U+1F7A9</span>                  <span class="kw">|</span>  <span class="ex">LIGHT</span> SALTIRE                                     <span class="kw">|</span></a></code></pre></div></li>
</ol>
<h3 id="colored-utf8-chars">colored utf8 chars</h3>
<ol class="incremental">
<li><p>all</p>
<table>
<tbody>
<tr class="odd">
<td></td>
<td>01234567891111111111233333333344444444445555555556</td>
</tr>
<tr class="even">
<td></td>
<td>……….0123456789012345678901234567891234567890</td>
</tr>
<tr class="odd">
<td>9700-9750:</td>
<td>◤◥◦◧◨◩◪◫◬◭◮◯◰◱◲◳◴◵◶◷◸◹◺◻◼◽◾◿☀☁☂☃☄★☆☇☈☉☊☋☌☍☎☏☐☑☒☓☔☕</td>
</tr>
<tr class="even">
<td>9750-9800:</td>
<td>☖☗☘☙☚☛☜☝☞☟☠☡☢☣☤☥☦☧☨☩☪☫☬☭☮☯☰☱☲☳☴☵☶☷☸☹☺☻☼☽☾☿♀♁♂♃♄♅♆♇</td>
</tr>
<tr class="odd">
<td>9800-9850:</td>
<td>♈♉♊♋♌♍♎♏♐♑♒♓♔♕♖♗♘♙♚♛♜♝♞♟♠♡♢♣♤♥♦♧♨♩♪♫♬♭♮♯♰♱♲♳♴♵♶♷♸♹</td>
</tr>
<tr class="even">
<td>9850-9900:</td>
<td>♺♻♼♽♾♿⚀⚁⚂⚃⚄⚅⚆⚇⚈⚉⚊⚋⚌⚍⚎⚏⚐⚑⚒⚓⚔⚕⚖⚗⚘⚙⚚⚛⚜⚝⚞⚟⚠⚡⚢⚣⚤⚥⚦⚧⚨⚩⚪⚫</td>
</tr>
<tr class="odd">
<td>9900-9950:</td>
<td>⚬⚭⚮⚯⚰⚱⚲⚳⚴⚵⚶⚷⚸⚹⚺⚻⚼⚽⚾⚿⛀⛁⛂⛃⛄⛅⛆⛇⛈⛉⛊⛋⛌⛍⛎⛏⛐⛑⛒⛓⛔⛕⛖⛗⛘⛙⛚⛛⛜⛝</td>
</tr>
<tr class="even">
<td>9950-10000:</td>
<td>⛞⛟⛠⛡⛢⛣⛤⛥⛦⛧⛨⛩⛪⛫⛬⛭⛮⛯⛰⛱⛲⛳⛴⛵⛶⛷⛸⛹⛺⛻⛼⛽⛾⛿✀✁✂✃✄✅✆✇✈✉✊✋✌✍✎✏</td>
</tr>
<tr class="odd">
<td>10000-10050:</td>
<td>✐✑✒✓✔✕✖✗✘✙✚✛✜✝✞✟✠✡✢✣✤✥✦✧✨✩✪✫✬✭✮✯✰✱✲✳✴✵✶✷✸✹✺✻✼✽✾✿❀❁</td>
</tr>
<tr class="even">
<td>10050-10100:</td>
<td>❂❃❄❅❆❇❈❉❊❋❌❍❎❏❐❑❒❓❔❕❖❗❘❙❚❛❜❝❞❟❠❡❢❣❤❥❦❧❨❩❪❫❬❭❮❯❰❱❲❳</td>
</tr>
<tr class="odd">
<td>10100-10150:</td>
<td>❴❵❶❷❸❹❺❻❼❽❾❿➀➁➂➃➄➅➆➇➈➉➊➋➌➍➎➏➐➑➒➓➔➕➖➗➘➙➚➛➜➝➞➟➠➡➢➣➤➥</td>
</tr>
<tr class="even">
<td>10150-10200:</td>
<td>➦➧➨➩➪➫➬➭➮➯➰➱➲➳➴➵➶➷➸➹➺➻➼➽➾➿⟀⟁⟂⟃⟄⟅⟆⟇⟈⟉⟊⟋⟌⟍⟎⟏⟐⟑⟒⟓⟔⟕⟖⟗</td>
</tr>
</tbody>
</table></li>
<li><p>zodiac</p>
<p>♈♉♊♋♌♍♎♏⛎♐♑♒♓</p></li>
<li><p>zodiac unambiguous</p>
<p>♈♉♌♎⛎♐♑♒♓</p></li>
<li><p>zodiac even more unambiguous</p>
<p>♈♉♌♎⛎♐♒</p></li>
</ol>
<h2 id="jira">Jira</h2>
<h3 id="jira-webapp-keyboard-shortcut-cheat-sheet">Jira webapp keyboard shortcut cheat sheet</h3>
<table>
<thead>
<tr class="header">
<th>action</th>
<th>shortcut</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>send card to top of the board</td>
<td><code>s + t</code></td>
</tr>
<tr class="even">
<td>send card to bottom of the board</td>
<td><code>s + b</code></td>
</tr>
</tbody>
</table>
<h3 id="command-line-online-help">command line online help?</h3>
<div class="sourceCode" id="cb374" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb374-1" title="1"><span class="co"># repl:</span></a>
<a class="sourceLine" id="cb374-2" title="2"><span class="ex">python</span></a>
<a class="sourceLine" id="cb374-3" title="3"><span class="co"># import the wanted module (eg: yaml)</span></a>
<a class="sourceLine" id="cb374-4" title="4"><span class="ex">import</span> yaml</a>
<a class="sourceLine" id="cb374-5" title="5"><span class="co"># help:</span></a>
<a class="sourceLine" id="cb374-6" title="6"><span class="bu">help</span>(yaml.load)</a>
<a class="sourceLine" id="cb374-7" title="7"><span class="co">#&gt; Help on function load in module yaml:</span></a>
<a class="sourceLine" id="cb374-8" title="8"><span class="co">#&gt; ...</span></a></code></pre></div>
<ul class="incremental">
<li>open the repl: <code>python</code></li>
<li>import the wanted module;</li>
</ul>
<h2 id="cheatsheets">CheatSheets</h2>
<h3 id="clojure-1">Clojure</h3>
<table>
<tbody>
<tr class="odd">
<td>emacs</td>
<td>cider</td>
<td><a href="https://github.com/clojure-emacs/cider/blob/master/doc/using_the_repl.md">https://github.com/clojure-emacs/cider/blob/master/doc/using_the_repl.md</a></td>
</tr>
<tr class="even">
<td></td>
<td>online help</td>
<td><code>C-h f RET cider-repl-mode</code></td>
</tr>
</tbody>
</table>
<h2 id="doc">Doc</h2>
<h3 id="markdown">Markdown</h3>
<ol class="incremental">
<li><p>Cheatsheet?</p>
<ol class="incremental">
<li><p>Links?</p>
<p>From: <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#links">https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#links</a></p>
<div class="sourceCode" id="cb375" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb375-1" title="1">[<span class="ex">I</span><span class="st">&#39;m an inline-style link](https://www.google.com)</span></a>
<a class="sourceLine" id="cb375-2" title="2"></a>
<a class="sourceLine" id="cb375-3" title="3"><span class="st">[I&#39;</span>m an inline-style link with title](https://www.google.com <span class="st">&quot;Google&#39;s Homepage&quot;</span>)</a>
<a class="sourceLine" id="cb375-4" title="4"></a>
<a class="sourceLine" id="cb375-5" title="5">[<span class="ex">I</span><span class="st">&#39;m a reference-style link][Arbitrary case-insensitive reference text]</span></a>
<a class="sourceLine" id="cb375-6" title="6"></a>
<a class="sourceLine" id="cb375-7" title="7"><span class="st">[I&#39;</span>m a relative reference to a repository file](../blob/master/LICENSE)</a>
<a class="sourceLine" id="cb375-8" title="8"></a>
<a class="sourceLine" id="cb375-9" title="9">[<span class="ex">You</span> can use numbers for reference-style link definitions][1]</a>
<a class="sourceLine" id="cb375-10" title="10"></a>
<a class="sourceLine" id="cb375-11" title="11"><span class="ex">Or</span> leave it empty and use the [link text itself].</a>
<a class="sourceLine" id="cb375-12" title="12"></a>
<a class="sourceLine" id="cb375-13" title="13"><span class="ex">URLs</span> and URLs in angle brackets will automatically get turned into links.</a>
<a class="sourceLine" id="cb375-14" title="14"><span class="ex">http</span>://www.example.com or <span class="op">&lt;</span>http://www.example.com<span class="op">&gt;</span> and sometimes</a>
<a class="sourceLine" id="cb375-15" title="15"><span class="ex">example.com</span> (but not on Github, for example)<span class="ex">.</span></a>
<a class="sourceLine" id="cb375-16" title="16"></a>
<a class="sourceLine" id="cb375-17" title="17"><span class="ex">Some</span> text to show that the reference links can follow later.</a>
<a class="sourceLine" id="cb375-18" title="18"></a>
<a class="sourceLine" id="cb375-19" title="19">[<span class="ex">arbitrary</span> case-insensitive reference text]: https://www.mozilla.org</a>
<a class="sourceLine" id="cb375-20" title="20">[<span class="ex">1</span>]: http://slashdot.org</a>
<a class="sourceLine" id="cb375-21" title="21">[<span class="ex">link</span> text itself]: http://www.reddit.com</a></code></pre></div></li>
</ol></li>
<li><p>get values by their path (eg: ["a",1,"b"])?</p>
<div class="sourceCode" id="cb376" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb376-1" title="1"><span class="ex">jq</span> -n <span class="st">&#39;{a: {b: 1}} | getpath([&quot;a&quot;,&quot;b&quot;])&#39;</span></a>
<a class="sourceLine" id="cb376-2" title="2"><span class="co">#&gt; 1</span></a></code></pre></div></li>
</ol>
<h2 id="ci">CI</h2>
<h3 id="jenkins">Jenkins</h3>
<ol class="incremental">
<li><p>RestApi</p>
<ol class="incremental">
<li><p>Jenkins Rest Api Essentials?</p>
<div class="sourceCode" id="cb377" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb377-1" title="1"><span class="ex">curl</span> <span class="st">&quot;</span><span class="va">$JENKINS_HOST</span><span class="st">/api/json?depth=1&amp;tree=jobs[name,lastBuild[building]]{1,10000}&quot;</span></a>
<a class="sourceLine" id="cb377-2" title="2"><span class="co"># for all jenkins jobs: get the name and the last build status (building or not)&quot;</span></a></code></pre></div></li>
<li><p>JSON</p>
<ol class="incremental">
<li><p>Get all build result with time of particulatar job?</p>
<div class="sourceCode" id="cb378" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb378-1" title="1"><span class="ex">j.jsonapi</span> <span class="st">&#39;/job/DevOps/job/maintenance/job/nexus/job/nexus-auto-restart/api/json?tree=builds[*]{1}&#39;</span></a></code></pre></div></li>
</ol></li>
<li><p>XML</p></li>
</ol></li>
<li><p>parallel map in groovy?</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb379-1" title="1"><span class="at">@Grab</span>(&#39;org.<span class="fu">codehaus</span>.<span class="fu">gpars</span>:gpars:<span class="fl">1.2.</span><span class="dv">1</span>&#39;)</a>
<a class="sourceLine" id="cb379-2" title="2"><span class="kw">import static</span> groovyx.gpars.GParsPool.withPool</a>
<a class="sourceLine" id="cb379-3" title="3">withPool{</a>
<a class="sourceLine" id="cb379-4" title="4">    <span class="fu">println</span>((<span class="fl">1..3</span>).<span class="fu">collectParallel</span> {it * <span class="dv">2</span>})</a>
<a class="sourceLine" id="cb379-5" title="5">}</a></code></pre></div></li>
<li><p>dump nested object as json/xml ?</p>
<ol class="incremental">
<li><p>native but do not handle cycles</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb380-1" title="1"><span class="co">// stackoverflow if cycle</span></a>
<a class="sourceLine" id="cb380-2" title="2">groovy.<span class="fu">json</span>.<span class="fu">JsonOutput</span>.<span class="fu">toJson</span>(<span class="kw">this</span>)</a>
<a class="sourceLine" id="cb380-3" title="3"><span class="co">// cycle handled</span></a>
<a class="sourceLine" id="cb380-4" title="4"><span class="at">@Grab</span>(group=&#39;com.<span class="fu">thoughtworks</span>.<span class="fu">xstream</span>&#39;, module=&#39;xstream&#39;, version=&#39;<span class="fl">1.4.11.</span><span class="dv">1</span>&#39;)</a>
<a class="sourceLine" id="cb380-5" title="5"><span class="kw">import</span> com.thoughtworks.xstream.XStream</a>
<a class="sourceLine" id="cb380-6" title="6">(<span class="kw">new</span> <span class="fu">XStream</span>()).<span class="fu">toXML</span>(<span class="kw">this</span>)</a></code></pre></div></li>
<li><p>with xstream (handle cycles)</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb381-1" title="1"><span class="at">@Grab</span>(group=&#39;com.<span class="fu">thoughtworks</span>.<span class="fu">xstream</span>&#39;, module=&#39;xstream&#39;, version=&#39;<span class="fl">1.4.11.</span><span class="dv">1</span>&#39;)</a>
<a class="sourceLine" id="cb381-2" title="2"><span class="kw">import</span> com.thoughtworks.xstream.XStream</a>
<a class="sourceLine" id="cb381-3" title="3">(<span class="kw">new</span> <span class="fu">XStream</span>()).<span class="fu">toXML</span>(<span class="kw">this</span>)</a></code></pre></div>
<ol class="incremental">
<li><p>Demo with cycles</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb382-1" title="1"><span class="kw">class</span> <span class="bu">Node</span> {</a>
<a class="sourceLine" id="cb382-2" title="2">    def    value</a>
<a class="sourceLine" id="cb382-3" title="3">    <span class="bu">Node</span>[] children</a>
<a class="sourceLine" id="cb382-4" title="4">    <span class="bu">Node</span>(value, children) {</a>
<a class="sourceLine" id="cb382-5" title="5">        <span class="kw">this</span>.<span class="fu">value</span> = value</a>
<a class="sourceLine" id="cb382-6" title="6">        <span class="kw">this</span>.<span class="fu">children</span> = children</a>
<a class="sourceLine" id="cb382-7" title="7">    }</a>
<a class="sourceLine" id="cb382-8" title="8">}</a>
<a class="sourceLine" id="cb382-9" title="9"><span class="at">@Grab</span>(group=&#39;com.<span class="fu">thoughtworks</span>.<span class="fu">xstream</span>&#39;, module=&#39;xstream&#39;, version=&#39;<span class="fl">1.4.11.</span><span class="dv">1</span>&#39;)</a>
<a class="sourceLine" id="cb382-10" title="10"><span class="kw">import</span> com.thoughtworks.xstream.XStream</a>
<a class="sourceLine" id="cb382-11" title="11">def n=<span class="kw">new</span> <span class="bu">Node</span>(<span class="st">&quot;n&quot;</span>,<span class="kw">null</span>)</a>
<a class="sourceLine" id="cb382-12" title="12">def m=<span class="kw">new</span> <span class="bu">Node</span>(<span class="st">&quot;n&quot;</span>, n)</a>
<a class="sourceLine" id="cb382-13" title="13">n.<span class="fu">children</span> = n</a>
<a class="sourceLine" id="cb382-14" title="14"><span class="fu">println</span>(<span class="kw">new</span> <span class="fu">XStream</span>().<span class="fu">toXML</span>([n,m]))</a></code></pre></div></li>
</ol></li>
<li><p>with xstream: json</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb383-1" title="1"><span class="at">@Grab</span>(group=&#39;com.<span class="fu">thoughtworks</span>.<span class="fu">xstream</span>&#39;, module=&#39;xstream&#39;, version=&#39;<span class="fl">1.4.11.</span><span class="dv">1</span>&#39;)</a>
<a class="sourceLine" id="cb383-2" title="2"><span class="kw">import</span> com.thoughtworks.xstream.XStream</a>
<a class="sourceLine" id="cb383-3" title="3"><span class="kw">import</span> com.thoughtworks.xstream.io.json.*</a>
<a class="sourceLine" id="cb383-4" title="4"><span class="fu">println</span>(<span class="kw">new</span> <span class="fu">XStream</span>(<span class="kw">new</span> com.<span class="fu">thoughtworks</span>.<span class="fu">xstream</span>.<span class="fu">io</span>.<span class="fu">json</span>.<span class="fu">JsonHierarchicalStreamDriver</span>()).<span class="fu">toXML</span>(<span class="kw">this</span>))</a></code></pre></div>
<p>#+END<sub>SRC</sub></p></li>
</ol></li>
<li><p>legacy jobs</p>
<ol class="incremental">
<li><p>job-dsl plugin</p>
<ol class="incremental">
<li><p>Example job-dsl for matrix project?</p>
<div class="sourceCode" id="cb384" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb384-1" title="1"><span class="ex">matrixJob</span>(<span class="st">&#39;a&#39;</span>) <span class="kw">{</span></a>
<a class="sourceLine" id="cb384-2" title="2">    <span class="ex">axes</span>  {text (<span class="st">&quot;x&quot;</span>, <span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>) <span class="kw">}</span></a>
<a class="sourceLine" id="cb384-3" title="3">    <span class="ex">steps</span> {shell(<span class="st">&#39;echo x: $x&#39;</span>) }</a>
<a class="sourceLine" id="cb384-4" title="4">}</a></code></pre></div></li>
</ol></li>
</ol></li>
<li><p>Stop an unstoppable build?</p>
<div class="sourceCode" id="cb385" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb385-1" title="1">     <span class="co"># with jenkins cli (groovysh or groovy):</span></a>
<a class="sourceLine" id="cb385-2" title="2"><span class="va">jobName=</span><span class="st">&#39;jobName&#39;</span></a>
<a class="sourceLine" id="cb385-3" title="3"><span class="va">jobNum=</span>111</a>
<a class="sourceLine" id="cb385-4" title="4"><span class="ex">jenkins.model.Jenkins.instance.getItemByFullName</span>(jobName)<span class="ex">.getBuildByNumber</span>(jobNum)<span class="ex">.finish</span>(hudson.model.Result.ABORTED,new java.io.IOException(<span class="st">&quot;Aborting build&quot;</span>)</a></code></pre></div></li>
</ol>
<h2 id="visualization">Visualization</h2>
<h3 id="online-visualization-of-wikipedias-graph">Online visualization of Wikipedia's graph?</h3>
<ul class="incremental">
<li><a href="http://tools.medialab.sciences-po.fr/seealsology/">http://tools.medialab.sciences-po.fr/seealsology/</a></li>
<li><a href="http://seealso.org/">http://seealso.org/</a></li>
</ul>
<h2 id="video-editing">Video editing</h2>
<h3 id="how-to-copy-part-of-a-video">how to copy part of a video?</h3>
<div class="sourceCode" id="cb386" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb386-1" title="1"><span class="va">start=</span>00:30:00</a>
<a class="sourceLine" id="cb386-2" title="2"><span class="va">duration=</span>00:00:55</a>
<a class="sourceLine" id="cb386-3" title="3"><span class="va">in=</span>originalfile</a>
<a class="sourceLine" id="cb386-4" title="4"><span class="va">out=</span>newfile</a>
<a class="sourceLine" id="cb386-5" title="5"><span class="ex">avconv</span> -ss <span class="va">$start</span> -t <span class="va">$duration</span> -i <span class="va">$in</span> -codec copy <span class="va">$out</span></a></code></pre></div>
<h2 id="repositories">Repositories</h2>
<h3 id="nexus">Nexus</h3>
<ol class="incremental">
<li><p>V2</p>
<ol class="incremental">
<li><p>self hosted api doc for nexus v2?</p>
<p>$NEXUS<sub>URL</sub>/nexus-restlet1x-plugin/default/docs/index.html</p></li>
</ol></li>
</ol>
<h3 id="monitoring">Monitoring</h3>
<ol class="incremental">
<li><p>how to connect jconsole to a jvm running in a remote docker container?</p>
<ul class="incremental">
<li>In the container: Change the start of your java app to include those properties:</li>
</ul>
<div class="sourceCode" id="cb387" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb387-1" title="1"><span class="ex">-Dcom.sun.management.jmxremote</span>  \</a>
<a class="sourceLine" id="cb387-2" title="2">-Dcom.sun.management.jmxremote.port=8888 \</a>
<a class="sourceLine" id="cb387-3" title="3">-Dcom.sun.management.jmxremote.rmi.port=8888 \</a>
<a class="sourceLine" id="cb387-4" title="4">-Djava.rmi.server.hostname=<span class="va">$(</span><span class="ex">DOCKER_HOST</span>:?<span class="va">)</span>     \</a>
<a class="sourceLine" id="cb387-5" title="5">-Dcom.sun.management.jmxremote.ssl=false  \</a>
<a class="sourceLine" id="cb387-6" title="6">-Dcom.sun.management.jmxremote.authenticate=false  \</a></code></pre></div>
<ul class="incremental">
<li>on the machine where jconsole is running, start a new connection on <code>$DOCKER_SERVER:8888</code></li>
</ul></li>
</ol>
<h1 id="db">Db</h1>
<h2 id="timeserie-db">timeserie db</h2>
<h3 id="influxdb">influxdb</h3>
<ol class="incremental">
<li><p>flux</p>
<ol class="incremental">
<li><p>flux query example?</p>
<div class="sourceCode" id="cb388" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb388-1" title="1"><span class="ex">from</span>(bucket: <span class="st">&quot;telegraf&quot;</span>)</a>
<a class="sourceLine" id="cb388-2" title="2">  <span class="kw">|</span><span class="op">&gt;</span> <span class="ex">range</span>(start: -12h)</a>
<a class="sourceLine" id="cb388-3" title="3">  <span class="kw">|</span><span class="op">&gt;</span> <span class="ex">filter</span>(fn: (r) =<span class="op">&gt;</span> <span class="ex">r._measurement</span> == <span class="st">&quot;system&quot;</span> and r._field  =~ /load(1<span class="kw">|</span><span class="ex">5</span><span class="kw">|</span><span class="ex">15</span>)$<span class="ex">/</span> )</a>
<a class="sourceLine" id="cb388-4" title="4">  <span class="kw">|</span><span class="op">&gt;</span> <span class="ex">aggregateWindow</span>(every: 10s, fn: mean)</a>
<a class="sourceLine" id="cb388-5" title="5">  <span class="kw">|</span><span class="op">&gt;</span> <span class="ex">group</span>(columns: [<span class="st">&quot;_field&quot;</span>], mode: <span class="st">&quot;by&quot;</span>)</a></code></pre></div></li>
</ol></li>
</ol>
